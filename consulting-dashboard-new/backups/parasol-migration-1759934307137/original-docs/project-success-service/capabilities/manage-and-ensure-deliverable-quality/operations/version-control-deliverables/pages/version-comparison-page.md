# ページ定義: バージョン比較画面

## 画面の目的
成果物の異なるバージョン間の変更内容を詳細に比較・分析し、変更の妥当性と影響を把握する

## 利用者
- **コンサルタント**: 自身の成果物の変更内容確認と改善点把握
- **PM**: 変更履歴の管理と品質影響の評価
- **レビュアー**: レビュー前の変更内容事前確認
- **クライアント**: 変更内容の理解と承認判断

## 画面構成

### ヘッダー部
- 比較対象バージョンの情報
- 比較範囲設定（全体・セクション別・期間指定）
- 比較表示モード（サイドバイサイド・統合・差分のみ）
- エクスポート・印刷機能

### バージョン選択部
- **比較元バージョン**:
  - バージョン番号・作成日・作成者
  - バージョンの概要と主要変更点
  - 選択可能バージョン一覧
- **比較先バージョン**:
  - 同様の情報表示
  - デフォルトは最新バージョン

### 比較結果表示部
- **サマリー情報**:
  - 総変更数（追加・修正・削除）
  - 変更セクション数と変更率
  - 重要度別変更分布
- **詳細比較表示**:
  - テキスト差分のハイライト表示
  - 図表・画像の変更比較
  - メタデータ（タグ・カテゴリ）の変更
- **変更ナビゲーション**:
  - 変更箇所への直接ジャンプ
  - 前後の変更箇所への移動
  - 変更タイプ別フィルタリング

### 分析・評価部
- **変更影響度分析**:
  - 影響を受ける関連成果物
  - クライアントへの影響評価
  - プロジェクト全体への影響
- **品質評価比較**:
  - バージョン間の品質スコア比較
  - 改善・悪化した品質項目
  - 品質基準適合性の変化

## データ表示

### 表示データ一覧
| データ項目 | 表示形式 | 必須 | 説明 |
|-----------|---------|------|------|
| 変更統計 | 統計グラフ | ○ | 追加・修正・削除の件数 |
| 差分内容 | ハイライト表示 | ○ | 具体的な変更内容 |
| 変更理由 | テキスト表示 | ○ | 各変更の背景・理由 |
| 影響度評価 | レベル表示 | ○ | 変更による影響の大きさ |
| 関連バージョン | リンク表示 | × | 参考となる他バージョン |
| 承認状況 | ステータス表示 | × | 各バージョンの承認状況 |

### データの更新頻度
- **差分情報**: バージョン選択時に即時計算
- **影響度分析**: バックグラウンドで定期更新
- **関連情報**: 関連成果物更新時に自動更新

## 入力項目

### 比較設定
| 入力項目 | 入力形式 | 必須 | バリデーション | 説明 |
|---------|---------|------|---------------|------|
| 比較元バージョン | 単一選択 | ○ | 既存バージョン | 比較のベースとなるバージョン |
| 比較先バージョン | 単一選択 | ○ | 既存バージョン | 比較対象のバージョン |
| 比較範囲 | 複数選択 | × | セクション選択 | 比較する部分の指定 |
| 表示詳細度 | 3段階選択 | ○ | 概要・詳細・全て | 比較結果の表示レベル |

### フィルタ・検索
| 入力項目 | 入力形式 | 必須 | バリデーション | 説明 |
|---------|---------|------|---------------|------|
| 変更タイプ | 複数選択 | × | 定義済みタイプ | 表示する変更の種類 |
| 検索キーワード | テキスト入力 | × | 最大100文字 | 特定内容の検索 |
| 影響度レベル | 複数選択 | × | 3段階選択 | 表示する影響度の範囲 |
| 作成者 | 複数選択 | × | ユーザーリスト | 特定作成者の変更のみ |

## アクション・操作

### 主要アクション
- **バージョン切り替え**: 比較対象の変更
- **比較レポート生成**: 比較結果の詳細レポート作成
- **変更承認**: 変更内容の承認・非承認
- **差分エクスポート**: 比較結果のファイル出力

### 副次アクション
- **変更箇所ブックマーク**: 重要な変更の保存
- **コメント追加**: 変更に対する意見・質問記録
- **類似変更検索**: 過去の類似変更事例確認
- **マージ提案**: 複数バージョンの統合提案

## 画面の振る舞い

### ユーザー操作への反応
- **バージョン選択時**: 即座に差分計算と表示更新
- **変更箇所クリック時**: 該当箇所の詳細差分を拡大表示
- **フィルタ適用時**: リアルタイムで表示内容を絞り込み
- **比較モード変更時**: 表示レイアウトの動的切り替え

### 条件による表示変更
- **大量変更の場合**: 段階的読み込みとプログレス表示
- **重要変更検出時**: 警告表示と詳細分析の提案
- **競合変更の場合**: 競合箇所のハイライトと解決提案

## 画面遷移

### 遷移元画面
- バージョン一覧画面: 特定バージョンの比較開始時
- 成果物詳細画面: バージョン履歴からの比較時
- レビュー画面: レビュー前の変更確認時

### 遷移先画面
- バージョン詳細画面: 特定バージョンの詳細確認時
- 成果物編集画面: 比較結果を踏まえた修正実施時
- 承認画面: 変更内容の正式承認時

## エラーハンドリング
- **比較処理エラー**: 大容量ファイル比較時のタイムアウト対応
- **バージョン削除エラー**: 比較中にバージョンが削除された場合の対応
- **権限不足エラー**: 閲覧権限のないバージョン選択時の処理

## アクセシビリティ要件
- キーボードナビゲーション対応（矢印キーでの変更箇所移動）
- スクリーンリーダー対応（変更内容の音声案内）
- 高コントラストモード対応（差分表示の明確な色分け）

## レスポンシブ対応
- **デスクトップ**: 左右分割表示での詳細比較
- **タブレット**: 上下分割またはタブ切り替え表示
- **モバイル**: スワイプによる比較バージョン切り替え