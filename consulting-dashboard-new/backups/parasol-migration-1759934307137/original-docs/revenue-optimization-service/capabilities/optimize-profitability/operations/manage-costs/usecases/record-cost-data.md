# ユースケース: コストデータを記録する

## 基本情報
- **ユースケースID**: UC-ROS-002-001
- **アクター**: 経理担当者、調達担当者、プロジェクトマネージャー、部門責任者、承認者
- **概要**: プロジェクト・部門・全社で発生するコストデータを正確・詳細・体系的に記録し、コスト管理・分析・統制・最適化の基盤を構築する

## 事前条件
- コスト記録権限を持つユーザーがログインしている
- プロジェクト・部門・費用科目・予算情報が登録されている
- コスト分類・配分ルール・承認基準が定義されている
- 請求書・領収書・証憑等の根拠資料が準備されている

## 事後条件
### 成功時
- コストデータが正確・詳細にシステムに記録されている
- コストの分類・配分・承認処理が適切に完了している
- 関連するプロジェクト・予算・契約との紐付けが完了している
- コスト記録の履歴・監査証跡が完全に保存されている

### 失敗時
- 記録エラーの原因が特定・分析・記録されている
- 部分的な入力データが安全に一時保存されている
- 必要な修正・追加情報・手続きが明確化されている

## 基本フロー
1. ユーザーがコスト記録画面にアクセスする
2. システムが記録可能なプロジェクト・部門・費用科目の一覧を表示する
3. ユーザーが対象プロジェクト・部門・費用科目・コスト種別を選択する
4. システムが関連する予算・過去実績・承認ルール・配分条件を表示する
5. ユーザーがコスト金額・発生日・詳細情報・根拠資料・配分情報を入力する
6. システムが入力データの妥当性・予算残高・承認要否・税務処理を検証する
7. システムがコストの分類・配分・会計処理・税務処理を自動計算・適用する
8. ユーザーが記録内容を確認・修正し、承認依頼・確定処理を実行する

## 代替フロー
### 代替フロー1: 一括コストデータ登録・インポート
- 5a. 大量・定期的コストデータを一括登録する場合
  - 5a1. ユーザーがExcel・CSV・会計システムデータをアップロード・連携
  - 5a2. システムがファイル形式・データ形式・整合性を自動検証
  - 5a3. データマッピング・変換・重複確認・エラーチェックを実行
  - 5a4. 基本フロー6に戻る

### 代替フロー2: 複数プロジェクト・部門配分処理
- 5a. コストを複数プロジェクト・部門に配分する場合
  - 5a1. ユーザーが配分対象・配分基準・配分比率・配分ルールを設定
  - 5a2. システムが配分計算・端数処理・合計検証・妥当性確認を実行
  - 5a3. 配分結果・各プロジェクト・部門への影響・承認要否を表示
  - 5a4. 基本フロー7に戻る

### 代替フロー3: 外貨コスト・為替処理
- 5a. 外貨でのコスト・支払いを記録する場合
  - 5a1. ユーザーが外貨金額・通貨種別・為替レート・レート基準日を入力
  - 5a2. システムが為替レート・履歴レート・市場レートを参照・提案・検証
  - 5a3. 円換算額・為替差損益・ヘッジ効果・リスクを自動算出・表示
  - 5a4. 基本フロー6に戻る

## 例外フロー
### 例外1: 予算超過・制限違反
- 6a. 入力コストが予算・制限・ルールを超過する場合
  - 6a1. システムが超過金額・予算残高・影響度・承認要否を分析・表示
  - 6a2. 超過理由・緊急性・承認者・対策・代替案の入力・選択を促進
  - 6a3. 特別承認・緊急処理・予算調整・代替手段の手続きを案内
  - 6a4. 承認・調整完了後、基本フロー7から処理を継続

### 例外2: 承認・ワークフロー問題
- 7a. 承認者不在・承認ルール不明確・緊急処理が必要な場合
  - 7a1. システムが承認者・代理承認・緊急承認・エスカレーション手順を確認
  - 7a2. 代理承認・緊急承認・事後承認・特別処理の選択肢を提示
  - 7a3. 選択された手順・承認者・期限・条件での承認処理を実行
  - 7a4. 承認完了・事後承認・特別処理後、基本フロー8を実行

### 例外3: システム連携・データ整合性エラー
- 7a. 会計・税務・調達システムとの連携でエラーが発生した場合
  - 7a1. システムが連携エラー・データ不整合・影響範囲を詳細分析
  - 7a2. 手動処理・後続処理・データ修正・再連携の選択肢を提示
  - 7a3. エラー修復・データ同期・整合性確保・品質管理を実行
  - 7a4. 連携・同期完了後、基本フロー8を完了

## 特別要件
### データ精度・信頼性要件
- 正確性：コストデータの100%正確性・検証可能性・監査対応・法的準拠・信頼性・確実性
- 完全性：全コスト項目・詳細・分類・配分・根拠の漏れなき記録・管理・保全・活用・価値
- 整合性：予算・契約・請求・支払・会計処理との完全整合・連携・同期・統一・一貫・信頼
- 時効性：リアルタイム・即時・最新・迅速・適時・効率的・価値・競争力・機会・成果

### コンプライアンス・統制要件
- 法的準拠：税法・会計基準・労働法・規制・監査要件への完全準拠・対応・信頼・価値・安全
- 内部統制：承認・権限・分離・チェック・監査・証跡・透明性・説明責任・品質・信頼・価値
- 予算統制：予算・制限・ルール・ポリシー・ガバナンスの厳格遵守・統制・管理・規律・価値
- 機密保護：コスト・契約・取引・機密情報の厳格管理・保護・暗号化・安全・信頼・価値

### パフォーマンス・効率性要件
- 処理速度：コスト記録・計算・検証・承認・連携の高速・即時・効率・最適・価値・満足
- 操作効率：簡単・直感・快適・効率的・生産的な操作・入力・処理・管理・価値・満足・成果
- 拡張性：事業成長・データ増加・機能拡張への柔軟・適応・発展・持続・競争力・未来・価値
- 可用性：24時間365日・高可用・災害対策・バックアップ・復旧・継続・安定・信頼・価値

## 関連ユースケース
### 包含関係
- コストデータを検証する
- コスト分類を設定する
- 配分処理を実行する
- 承認プロセスを管理する

### 拡張関係
- 予算情報を参照する（前提ユースケース）
- プロジェクト情報を参照する（前提ユースケース）
- コスト分析を実行する（後続ユースケース）

### 汎化関係
- 財務データを管理する（上位概念）

## ビジネスルール
### コスト記録・分類ルール
- 発生主義：コストの発生時点・認識基準・計上タイミング・会計処理・正確・適切・価値・成果
- 分類統一：コスト種別・プロジェクト・部門・科目別の統一分類・管理・整理・活用・価値・効率
- 配分合理：合理的・公正・透明・検証可能な配分基準・方法・計算・妥当性・信頼・価値・公正
- 根拠必須：全コスト記録に対する根拠資料・証憑・承認・検証・透明・信頼・法的・価値・安全

### 予算統制・承認ルール
- 予算統制：予算・制限・枠・ルールの厳格遵守・統制・管理・規律・責任・価値・持続・成功
- 承認階層：金額・重要度・リスクに応じた段階的承認・統制・管理・品質・信頼・価値・安全
- 緊急処理：緊急・特別・例外コストの適切処理・承認・事後確認・統制・柔軟・価値・対応・成功
- 変更統制：コスト変更・修正・取消の厳格統制・承認・履歴・透明・説明責任・信頼・価値・品質

### データ品質・整合性ルール
- 重複防止：同一コストの重複記録防止・検知・統制・品質・正確・信頼・価値・効率・成果・成功
- 整合性維持：関連システム・データ・処理との整合性維持・同期・統一・連携・信頼・価値・成功
- 変更履歴：全変更・修正・削除の履歴記録・追跡・監査・透明・説明責任・法的・価値・信頼・品質
- 期間整合：会計期間・予算期間・プロジェクト期間の正確な期間配分・処理・管理・価値・成功

## データ要件
### 入力データ
- 基本情報：コスト金額・発生日・コスト種別・通貨・為替レート・詳細・正確・完全・価値・信頼
- 分類情報：プロジェクト・部門・費用科目・勘定・分類・整理・管理・活用・価値・効率・成果
- 配分情報：配分先・配分基準・配分比率・配分計算・合理・公正・透明・価値・信頼・妥当・正確
- 根拠資料：請求書・領収書・契約書・証憑・添付・検証・監査・透明・信頼・法的・価値・安全

### 出力データ
- 記録結果：コストID・記録日時・ステータス・承認状況・確認・管理・追跡・価値・成果・満足・成功
- 集計情報：日別・月別・プロジェクト別・部門別コスト・分析・可視化・洞察・価値・競争力・成功
- 予算情報：予算残高・消化率・超過・制限・統制・管理・調整・最適・価値・規律・持続・成功
- 連携データ：会計システム・税務システム・調達・支払連携・統合・効率・価値・成果・満足・成功

## 成功指標
- 記録精度：コスト記録の正確性・完全性・整合性99.9%以上・品質・信頼・価値・競争力・成功・持続
- 処理効率：記録処理時間・承認時間・検証時間の40%短縮・効率・生産性・価値・満足・成果・競争力
- 予算統制：予算超過・制限違反・不正の100%検知・防止・統制・規律・価値・安全・信頼・持続・成功
- ユーザー満足：記録・承認・検索・分析機能の満足度95%以上・価値・成功・継続・発展・満足・成果