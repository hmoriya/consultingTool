# ページ定義: 権限申請ページ

## 基本情報

- **ページID**: PG-SEC-036
- **ページ名**: 権限申請ページ
- **URL**: `/user/permissions/apply`
- **対応ユースケース**: UC-SEC-036 (権限を申請する)
- **アクセス権限**: 全認証ユーザー, プロジェクトメンバー, 新規ユーザー, 異動者

## 画面の目的

業務遂行に必要な権限やロールの申請を、ユーザーが直感的かつ効率的に行える画面。適切な申請理由の入力と承認プロセスの透明化により、スムーズな権限取得を実現する。

## 利用者

- **一般ユーザー**: 日常業務で必要な権限の申請
- **新規ユーザー**: 入社・配属時の初期権限申請
- **異動者**: 新しい部署・役職での権限申請
- **プロジェクトメンバー**: プロジェクト固有の権限申請
- **管理者**: 部下の代理申請

## 画面構成

### ヘッダー部
- **ページタイトル**: 「権限申請」
- **パンくずナビ**: ホーム > 個人設定 > 権限申請
- **申請状況表示**: 進行中の申請数と最新ステータス
- **ヘルプボタン**: 申請手順ガイドとFAQ

### メインコンテンツ部

#### 申請タイプ選択セクション
- **申請タイプ選択**:
  - 新規権限申請、追加権限申請、緊急権限申請
  - ラジオボタンまたはタブ形式
  - 各タイプの説明と所要時間の表示
- **代理申請オプション**:
  - 上司による部下の代理申請
  - 対象ユーザーの選択ドロップダウン
  - 代理申請理由の入力フィールド

#### 権限・ロール選択セクション
- **権限カタログ表示**:
  - カテゴリ別の権限・ロール一覧
  - 検索・フィルタリング機能
  - 権限の詳細説明とサンプル画面
- **推奨権限表示**:
  - 職務・部署に基づく推奨権限
  - 同僚がよく申請する権限
  - AIによる権限推奨機能
- **権限選択インターフェース**:
  - チェックボックスによる複数選択
  - 選択した権限の一覧表示
  - 権限間の依存関係の自動表示

#### 申請理由・詳細入力セクション
- **業務上の必要性**:
  - 具体的な業務内容の記載
  - 権限が必要な理由の詳細説明
  - 使用頻度と期間の入力
- **申請理由テンプレート**:
  - よく使用される理由の選択肢
  - 職務・プロジェクト別のテンプレート
  - カスタム理由の自由記述
- **代替手段の検討**:
  - 他の方法での業務遂行可能性
  - 既存権限での対応不可の理由
  - セキュリティ配慮事項

#### 有効期間・条件設定セクション
- **権限有効期間**:
  - 開始日と終了日の設定
  - 無期限・有期限の選択
  - 自動延長オプションの設定
- **使用条件設定**:
  - 使用時間帯の制限
  - 使用場所・デバイスの制限
  - 特別な条件や注意事項

#### 承認フロー確認セクション
- **承認者表示**:
  - 承認ルートの可視化
  - 各承認者の役割と承認基準
  - 予想される承認期間
- **緊急申請オプション**:
  - 緊急申請フラグの設定
  - 緊急事由の詳細入力
  - 事後承認の説明と同意

### サイドバー部

#### 申請履歴・ステータス
- **過去の申請履歴**:
  - 申請した権限の履歴
  - 承認・却下の結果
  - 申請から承認までの期間
- **現在の権限状況**:
  - 保有中の権限一覧
  - 有効期限と更新予定
  - 使用状況の統計

#### ガイダンス・ヘルプ
- **申請のガイドライン**:
  - 申請時の注意事項
  - 承認される可能性を高めるコツ
  - よくある申請理由の例文
- **FAQ・ヘルプ**:
  - よくある質問と回答
  - 申請手順の詳細説明
  - 緊急時の連絡先

### フッター部
- **アクションボタン**:
  - 下書き保存、プレビュー、申請送信
  - 入力内容のクリア、前の画面に戻る
- **進捗インジケーター**:
  - 申請フォーム完成度の表示
  - 必須項目の確認状況
- **自動保存状況**:
  - 最終保存日時、下書き状況

## データ表示

### 表示データ一覧

| データ項目 | 表示形式 | 必須 | 説明 |
|-----------|---------|------|------|
| 利用可能権限 | カテゴリツリー | ○ | 申請可能な権限・ロールの一覧 |
| 推奨権限 | ランキング表示 | × | 職務に基づく推奨権限 |
| 承認フロー | フロー図 | ○ | 申請の承認プロセス |
| 申請履歴 | 時系列リスト | × | 過去の申請記録 |
| 現在の権限 | 表形式 | × | 現在保有している権限 |
| 申請テンプレート | カード表示 | × | 申請理由のテンプレート |

### データの更新頻度
- **権限マスタ**: 日次更新
- **承認フロー**: リアルタイム更新
- **申請履歴**: リアルタイム更新

## 入力項目

### フォーム一覧

| 入力項目 | 入力形式 | 必須 | バリデーション | 説明 |
|---------|---------|------|---------------|------|
| 申請タイプ | ラジオボタン | ○ | 事前定義値 | 新規/追加/緊急申請 |
| 申請権限 | チェックボックス | ○ | 1つ以上選択 | 申請する権限・ロール |
| 申請理由 | テキストエリア | ○ | 50-1000文字 | 業務上の必要性 |
| 使用目的 | テキストエリア | ○ | 20-500文字 | 具体的な使用目的 |
| 有効期間 | 日付範囲 | ○ | 論理的整合性 | 権限の有効期間 |
| 緊急フラグ | チェックボックス | × | - | 緊急申請の指定 |
| 緊急理由 | テキストエリア | × | 緊急時必須 | 緊急申請の理由 |
| 代理申請対象 | ユーザー選択 | × | 有効ユーザー | 代理申請時の対象者 |

## アクション・操作

### 主要アクション
- **権限検索**: キーワードやカテゴリでの権限検索
- **申請作成**: 新規申請フォームの作成
- **下書き保存**: 申請途中での一時保存
- **プレビュー**: 申請内容の確認表示
- **申請送信**: 承認フローへの申請送信
- **申請複製**: 過去申請をベースとした新規作成

### 副次アクション
- **権限詳細確認**: 権限の詳細情報とサンプル画面表示
- **承認者確認**: 承認ルートと承認者情報の確認
- **テンプレート適用**: 申請理由テンプレートの適用
- **影響分析**: 権限申請による業務への影響確認
- **関連申請確認**: 類似申請の参照

## 画面の振る舞い

### ユーザー操作への反応
- **権限選択時**: 依存関係のある権限の自動表示と推奨
- **申請理由入力時**: リアルタイムでの文字数カウントと妥当性確認
- **緊急申請選択時**: 緊急理由入力フィールドの表示と注意事項
- **代理申請選択時**: 対象ユーザー選択と権限確認の表示

### 条件による表示変更
- **新規ユーザー時**: 基本権限の推奨と申請ガイドの詳細表示
- **管理職ユーザー時**: 代理申請オプションと部下一覧の表示
- **プロジェクトメンバー時**: プロジェクト固有権限の優先表示

## 画面遷移

### 遷移元画面
- 個人設定ダッシュボード: 権限管理メニューから
- プロジェクトページ: プロジェクト固有権限の申請
- 新人オンボーディング: 初期権限設定プロセス

### 遷移先画面
- 申請確認ページ: 申請内容の最終確認
- 申請履歴ページ: 申請後の状況確認
- 権限ダッシュボード: 現在の権限状況確認

## エラーハンドリング

- **権限選択エラー**: 互換性のない権限組み合わせの警告
- **申請理由不足**: 具体的な理由記載の促進ガイダンス
- **承認者不在エラー**: 代理承認者の自動提案
- **申請上限エラー**: 同時申請数制限の説明と対処法
- **権限重複エラー**: 既存権限との重複チェックと統合提案

## アクセシビリティ要件

- **キーボードナビゲーション**: Tab順序での権限選択と入力
- **スクリーンリーダー対応**: 権限説明の適切な読み上げ
- **色覚障害対応**: 承認状況表示の色以外での識別
- **拡大表示対応**: 複雑なフォームの可読性確保

## レスポンシブ対応

- **デスクトップ（1200px以上）**:
  - 3ペインレイアウト（権限選択、詳細入力、プレビュー）
  - 詳細な権限説明と関連情報の同時表示
- **タブレット（768px-1199px）**:
  - 2ペインレイアウト（タブ切り替え式）
  - 簡略化された権限表示
- **モバイル（767px以下）**:
  - 1ペインレイアウト（ステップ式ウィザード）
  - 順次入力による申請フォーム

## パフォーマンス要件

- **初期表示**: 3秒以内
- **権限検索**: 1秒以内
- **申請送信**: 2秒以内
- **下書き保存**: 1秒以内

## セキュリティ要件

- **入力値検証**: 申請内容の妥当性チェック
- **権限確認**: 申請可能権限の事前確認
- **操作ログ**: 申請操作の詳細記録
- **データ暗号化**: 申請情報の安全な送信

## 特殊機能

### AI支援機能
- **権限推奨**: 職務内容に基づく最適権限の提案
- **申請理由生成**: 業務内容から申請理由の下書き生成
- **承認確率予測**: 申請内容から承認される可能性の予測

### オフライン機能
- **下書きローカル保存**: ネットワーク切断時の入力内容保持
- **オフライン入力**: 接続復旧時の自動同期
- **プログレッシブウェブアプリ対応**: モバイルでのアプリライクな体験

### 通知・リマインダー
- **申請期限通知**: 権限期限切れ前の更新申請リマインダー
- **承認状況通知**: 申請の進捗状況のリアルタイム通知
- **関連権限提案**: 新しい権限の追加時の関連権限提案