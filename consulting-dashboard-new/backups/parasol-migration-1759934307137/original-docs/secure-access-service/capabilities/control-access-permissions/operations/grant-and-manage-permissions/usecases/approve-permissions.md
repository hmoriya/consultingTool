# ユースケース: 権限を承認する

## 基本情報

- **ユースケースID**: UC-SEC-037
- **ユースケース名**: 権限を承認する
- **アクター**: 直属上司, 部門長, セキュリティ管理者, 役員, 代理承認者
- **概要**: 部下や組織メンバーからの権限申請を審査し、適切性を判断して承認または却下を決定する

## 事前条件

- 承認者がシステムにログインしている
- 承認対象の権限申請が存在する
- 承認者が該当申請の承認権限を持っている
- 申請内容が完全かつ正確に入力されている

## 事後条件

### 成功時
- 権限申請の承認・却下が決定される
- 申請者に結果通知が送信される
- 承認済み申請は権限付与プロセスに移行する
- 却下申請は理由とともに申請者に返却される

### 失敗時
- エラーメッセージが表示される
- 承認状況が保持される
- 失敗理由が記録される

## 基本フロー

1. 承認者が承認待ち一覧画面にアクセスする
2. システムが承認待ちの申請一覧を表示する
3. 承認者が確認したい申請を選択する
4. システムが申請詳細と申請者情報を表示する
5. 承認者が申請内容の妥当性を評価する
6. 承認者が申請者の職務適合性を確認する
7. 承認者が承認・却下・保留のいずれかを選択する
8. 承認者が承認理由またはコメントを入力する
9. システムが承認判定を記録する
10. システムが申請者に結果通知を送信する
11. システムが次のステップ（権限付与または却下処理）を実行する

## 代替フロー

### 代替フロー1: 条件付き承認
- 7a. 条件を設けて承認する場合
  - 7a1. 承認者が条件付き承認を選択する
  - 7a2. 承認者が条件内容を詳細入力する
  - 7a3. システムが条件達成の確認方法を設定する
  - 7a4. 基本フロー8に進む

### 代替フロー2: 上位承認への委譲
- 5a. 申請内容が承認者の権限を超える場合
  - 5a1. 承認者が上位承認への委譲を選択する
  - 5a2. システムが適切な上位承認者を提示する
  - 5a3. 承認者が委譲理由とコメントを入力する
  - 5a4. システムが上位承認者に申請を転送する

### 代替フロー3: 追加情報要求
- 6a. 申請内容に不明点がある場合
  - 6a1. 承認者が追加情報要求を選択する
  - 6a2. 承認者が必要な追加情報を具体的に記載する
  - 6a3. システムが申請者に情報提供を要求する
  - 6a4. 申請者の回答後、基本フロー5に戻る

## 例外フロー

### 例外1: 申請者の職務変更
- 6a. 申請者の所属・職務が申請時と異なる場合
  - 6a1. システムが職務変更を検出し警告表示する
  - 6a2. 承認者が現在の職務での必要性を再評価する
  - 6a3. 承認者が継続・修正・却下のいずれかを選択する
  - 6a4. 選択に応じた処理を実行する

### 例外2: 緊急申請の期限切れ
- 5a. 緊急申請の有効期限が切れている場合
  - 5a1. システムが期限切れ警告を表示する
  - 5a2. 承認者が期限延長・却下のいずれかを選択する
  - 5a3. 期限延長の場合は新たな期限を設定する
  - 5a4. 基本フロー7に進む

### 例外3: 承認者の権限不足
- 1a. ログインした承認者に該当申請の承認権限がない場合
  - 1a1. システムが権限不足エラーを表示する
  - 1a2. システムが適切な承認者を提示する
  - 1a3. 申請を適切な承認者に転送するか確認する

## 特別要件

### 性能要件
- 承認待ち一覧表示: 3秒以内
- 申請詳細表示: 2秒以内
- 承認判定記録: 2秒以内
- 通知送信: 3秒以内

### セキュリティ要件
- 承認者の認証確認
- 承認権限の厳格なチェック
- 承認操作の監査ログ記録
- 承認情報の暗号化保存

### 可用性要件
- 24時間365日の承認機能提供
- 99.9%以上のシステム稼働率

## 非機能要件

### 使いやすさ
- 申請内容の分かりやすい表示
- 申請者の履歴・実績表示
- ワンクリック承認・却下機能
- 承認理由のテンプレート提供

### 拡張性
- 新しい承認ルールへの対応
- 複雑な承認フローの設定
- 大量申請の効率的な処理

## ビジネスルール

### 承認権限の階層
- **直属上司**: 一般権限の承認
- **部門長**: 部門内の重要権限承認
- **セキュリティ管理者**: システム権限・機密情報アクセス権承認
- **役員**: 管理者権限・特権の承認

### 承認期限の設定
- **一般申請**: 3営業日以内に承認・却下
- **緊急申請**: 4時間以内に承認・却下
- **重要権限**: 5営業日以内（詳細審査のため）
- **期限切れ**: 自動却下または上位承認者にエスカレーション

### 承認判定基準
- **職務適合性**: 申請者の職務との関連性
- **必要性**: 業務遂行上の必要性と緊急性
- **最小権限**: 必要最小限の権限かどうか
- **リスク評価**: セキュリティリスクの許容範囲

### 却下理由の分類
- **職務不適合**: 申請者の職務に不適切
- **権限過多**: 必要以上の権限を申請
- **理由不十分**: 申請理由が不明確・不十分
- **リスク過大**: セキュリティリスクが高すぎる

## 関連ユースケース

- **前提**: UC-SEC-036 (権限を申請する) - 承認対象申請の存在
- **後続**: UC-SEC-038 (権限を付与する) - 承認後の権限付与実行
- **関連**: UC-SEC-039 (権限を剥奪する) - 不適切承認の事後修正
- **包含**: UC-SEC-001 (ユーザーを認証する) - 承認者の認証確認

## 実装ノート

### データ要件
- 承認情報（承認ID、承認者、承認日時、判定結果）
- 承認理由（承認・却下理由、条件、コメント）
- 承認履歴（承認プロセスの進行状況）
- 権限マッピング（承認者と承認可能権限の関係）

### 技術的考慮事項
- 承認権限マトリックスの動的評価
- 組織階層変更への対応
- 承認期限の自動管理
- 大量申請の効率的な表示・処理

### UI/UX要件
- 申請内容の見やすい整理表示
- 承認判定の直感的な操作
- 関連情報の効率的な確認機能
- モバイルでの承認操作対応

### データ整合性
- 承認者権限の動的チェック
- 申請状態の一貫性管理
- 承認プロセスの中断・再開処理
- 並行承認の競合状態回避

### 通知機能
- 申請到着の即座通知
- 承認期限の事前警告
- 判定結果の自動通知
- エスカレーション通知

### ワークフロー管理
- 複数段階承認の管理
- 承認者不在時の代理設定
- 承認ルートの動的変更
- 承認プロセスの可視化

### レポート機能
- 承認実績の統計分析
- 承認期間の分析
- 却下理由の傾向分析
- 承認者別のパフォーマンス

### 監査要件
- 承認判定の完全な記録
- 承認理由の詳細保存
- 承認プロセスの透明性確保
- 外部監査への対応準備

### 自動化機能
- 定型申請の自動承認
- リスクベースの承認ルーティング
- 承認期限の自動管理
- 異常パターンの自動検出