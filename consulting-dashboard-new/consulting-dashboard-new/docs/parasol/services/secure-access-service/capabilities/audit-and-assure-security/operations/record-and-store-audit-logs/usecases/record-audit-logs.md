[38;2;141;161;185m───────┬────────────────────────────────────────────────────────────────────────[0m
       [38;2;141;161;185m│ [0m[1mSTDIN[0m
[38;2;141;161;185m───────┼────────────────────────────────────────────────────────────────────────[0m
[38;2;141;161;185m   1[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m# ユースケース: 監査ログを記録する[0m
[38;2;141;161;185m   2[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m   3[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 基本情報[0m
[38;2;141;161;185m   4[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **ユースケースID**: UC-SEC-016[0m
[38;2;141;161;185m   5[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **アクター**: システム, ユーザー, 管理者, 監査ログシステム, 自動記録エージェント[0m
[38;2;141;161;185m   6[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **概要**: システム内のすべてのセキュリティ関連活動とユーザー行動を標準化された形式で自動的に記録し、法的要件とコンプライアンス基準を満たす包括的な監査証跡を構築する[0m
[38;2;141;161;185m   7[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m   8[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 事前条件[0m
[38;2;141;161;185m   9[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 監査ログシステムが正常に稼働している[0m
[38;2;141;161;185m  10[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログ記録対象システムが適切に設定されている[0m
[38;2;141;161;185m  11[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 標準化されたログフォーマットが定義されている[0m
[38;2;141;161;185m  12[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログ記録権限が適切に設定されている[0m
[38;2;141;161;185m  13[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ストレージ容量が十分に確保されている[0m
[38;2;141;161;185m  14[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  15[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 事後条件[0m
[38;2;141;161;185m  16[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 成功時[0m
[38;2;141;161;185m  17[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- セキュリティイベントが標準フォーマットで記録される[0m
[38;2;141;161;185m  18[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログエントリがタイムスタンプ付きで保存される[0m
[38;2;141;161;185m  19[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ユーザー活動の詳細が追跡可能な形で記録される[0m
[38;2;141;161;185m  20[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- システム変更が完全に記録される[0m
[38;2;141;161;185m  21[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログの整合性が暗号学的に保護される[0m
[38;2;141;161;185m  22[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  23[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 失敗時[0m
[38;2;141;161;185m  24[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログ記録エラーがシステムログに記録される[0m
[38;2;141;161;185m  25[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 代替ログ記録システムが自動起動される[0m
[38;2;141;161;185m  26[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログ欠損の警告が管理者に通知される[0m
[38;2;141;161;185m  27[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 影響期間と範囲が特定・記録される[0m
[38;2;141;161;185m  28[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  29[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 基本フロー[0m
[38;2;141;161;185m  30[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m1. システムまたはユーザーがセキュリティ関連の活動を実行する[0m
[38;2;141;161;185m  31[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m2. 監査ログシステムが活動を自動検知する[0m
[38;2;141;161;185m  32[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m3. システムが活動内容を標準化されたフォーマットで構造化する[0m
[38;2;141;161;185m  33[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m4. システムが必要な属性情報（ユーザー、時刻、場所、操作内容）を収集する[0m
[38;2;141;161;185m  34[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m5. システムがログエントリにタイムスタンプとシーケンス番号を付与する[0m
[38;2;141;161;185m  35[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m6. システムがログエントリのハッシュ値を計算し整合性を保護する[0m
[38;2;141;161;185m  36[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m7. システムがログエントリを適切なストレージに永続化する[0m
[38;2;141;161;185m  37[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m8. システムがログ記録の成功を確認し必要に応じて通知する[0m
[38;2;141;161;185m  38[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  39[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 代替フロー[0m
[38;2;141;161;185m  40[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 代替フロー1: 大量ログ発生時[0m
[38;2;141;161;185m  41[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 2a. 短時間で大量のログが発生した場合[0m
[38;2;141;161;185m  42[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a1. システムがバッファリング機能を使用[0m
[38;2;141;161;185m  43[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a2. 優先度に基づいてログを処理[0m
[38;2;141;161;185m  44[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a3. 必要に応じて追加ストレージを確保[0m
[38;2;141;161;185m  45[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a4. 基本フロー3に戻る[0m
[38;2;141;161;185m  46[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  47[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 代替フロー2: 機密情報を含む場合[0m
[38;2;141;161;185m  48[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 4a. ログに機密情報が含まれる場合[0m
[38;2;141;161;185m  49[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a1. 機密部分を自動検出・マスキング[0m
[38;2;141;161;185m  50[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a2. 必要最小限の情報のみ記録[0m
[38;2;141;161;185m  51[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a3. 追加暗号化を適用[0m
[38;2;141;161;185m  52[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a4. 基本フロー5に戻る[0m
[38;2;141;161;185m  53[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  54[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 代替フロー3: リアルタイム監視要求時[0m
[38;2;141;161;185m  55[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 7a. リアルタイム監視が必要な場合[0m
[38;2;141;161;185m  56[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a1. 即座にアラートシステムに通知[0m
[38;2;141;161;185m  57[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a2. 監視ダッシュボードに即座反映[0m
[38;2;141;161;185m  58[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a3. 必要に応じて自動対応を起動[0m
[38;2;141;161;185m  59[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a4. 基本フロー8に戻る[0m
[38;2;141;161;185m  60[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  61[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 例外フロー[0m
[38;2;141;161;185m  62[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 例外1: ストレージ容量不足[0m
[38;2;141;161;185m  63[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 7a. ストレージ容量が不足した場合[0m
[38;2;141;161;185m  64[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a1. 緊急容量拡張を自動実行[0m
[38;2;141;161;185m  65[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a2. 古いログのアーカイブを実行[0m
[38;2;141;161;185m  66[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a3. 管理者に緊急通知を送信[0m
[38;2;141;161;185m  67[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a4. 容量確保後に記録を再開[0m
[38;2;141;161;185m  68[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  69[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 例外2: ログシステム障害[0m
[38;2;141;161;185m  70[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- *a. 監査ログシステムに障害が発生した場合[0m
[38;2;141;161;185m  71[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a1. バックアップログシステムに自動切替[0m
[38;2;141;161;185m  72[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a2. 一時的にローカルファイルに記録[0m
[38;2;141;161;185m  73[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a3. システム管理者に障害を通知[0m
[38;2;141;161;185m  74[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a4. 復旧後に統合・同期を実行[0m
[38;2;141;161;185m  75[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  76[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 例外3: ネットワーク分断[0m
[38;2;141;161;185m  77[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 7a. ネットワーク接続が失われた場合[0m
[38;2;141;161;185m  78[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a1. ローカルバッファに一時保存[0m
[38;2;141;161;185m  79[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a2. 接続復旧を定期的に試行[0m
[38;2;141;161;185m  80[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a3. 復旧後にバッファ内容を同期[0m
[38;2;141;161;185m  81[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 7a4. データ整合性を検証[0m
[38;2;141;161;185m  82[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  83[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 特別要件[0m
[38;2;141;161;185m  84[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **完全性**: すべてのセキュリティ関連活動の漏れない記録[0m
[38;2;141;161;185m  85[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **可用性**: 99.9%以上の稼働率でのログ記録継続[0m
[38;2;141;161;185m  86[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **性能**: 高負荷時でも1秒以内でのログ記録完了[0m
[38;2;141;161;185m  87[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **セキュリティ**: ログデータの暗号化と改ざん検知[0m
[38;2;141;161;185m  88[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **準拠性**: 法的・規制要件への完全準拠[0m
[38;2;141;161;185m  89[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  90[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 関連ユースケース[0m
[38;2;141;161;185m  91[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **包含**: なし[0m
[38;2;141;161;185m  92[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **拡張**: ログを安全に保存する、ログの整合性を検証する[0m
[38;2;141;161;185m  93[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **汎化**: なし[0m
[38;2;141;161;185m  94[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  95[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## ビジネスルール[0m
[38;2;141;161;185m  96[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- すべてのログはUTC時刻で記録[0m
[38;2;141;161;185m  97[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 個人情報は自動マスキング処理を適用[0m
[38;2;141;161;185m  98[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 重要度の高いイベントは重複記録を実施[0m
[38;2;141;161;185m  99[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログ保持期間は法的要件に基づき設定[0m
[38;2;141;161;185m 100[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 記録対象の活動は包括的に定義[0m
[38;2;141;161;185m 101[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 102[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 記録対象活動[0m
[38;2;141;161;185m 103[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### ユーザー活動[0m
[38;2;141;161;185m 104[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログイン・ログアウト[0m
[38;2;141;161;185m 105[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 権限変更・昇格[0m
[38;2;141;161;185m 106[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- データアクセス・操作[0m
[38;2;141;161;185m 107[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- システム設定変更[0m
[38;2;141;161;185m 108[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ファイル操作・転送[0m
[38;2;141;161;185m 109[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 110[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### システム活動[0m
[38;2;141;161;185m 111[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- セキュリティポリシー変更[0m
[38;2;141;161;185m 112[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- システム構成変更[0m
[38;2;141;161;185m 113[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ソフトウェア更新・パッチ適用[0m
[38;2;141;161;185m 114[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- バックアップ・復旧操作[0m
[38;2;141;161;185m 115[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- セキュリティ制御の有効化・無効化[0m
[38;2;141;161;185m 116[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 117[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### セキュリティイベント[0m
[38;2;141;161;185m 118[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 認証失敗・成功[0m
[38;2;141;161;185m 119[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 権限違反の試行[0m
[38;2;141;161;185m 120[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- マルウェア検知[0m
[38;2;141;161;185m 121[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 侵入検知アラート[0m
[38;2;141;161;185m 122[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- セキュリティポリシー違反[0m
[38;2;141;161;185m 123[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 124[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## ログフォーマット仕様[0m
[38;2;141;161;185m 125[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 標準属性[0m
[38;2;141;161;185m 126[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **タイムスタンプ**: ISO8601形式（UTC）[0m
[38;2;141;161;185m 127[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **イベントID**: 一意識別子[0m
[38;2;141;161;185m 128[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **ユーザーID**: 実行者識別[0m
[38;2;141;161;185m 129[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **ソースIP**: 発信元IPアドレス[0m
[38;2;141;161;185m 130[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **イベント種別**: カテゴリ分類[0m
[38;2;141;161;185m 131[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **重要度**: Critical/High/Medium/Low[0m
[38;2;141;161;185m 132[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **詳細情報**: 構造化された追加情報[0m
[38;2;141;161;185m 133[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 134[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 拡張属性[0m
[38;2;141;161;185m 135[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **セッションID**: ユーザーセッション識別[0m
[38;2;141;161;185m 136[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **プロセスID**: 実行プロセス情報[0m
[38;2;141;161;185m 137[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **対象リソース**: 操作対象の特定[0m
[38;2;141;161;185m 138[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **結果**: 成功/失敗/部分成功[0m
[38;2;141;161;185m 139[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **追加メタデータ**: コンテキスト依存情報[0m
[38;2;141;161;185m 140[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 141[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 技術的制約[0m
[38;2;141;161;185m 142[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログ記録の遅延は最大1秒以内[0m
[38;2;141;161;185m 143[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 同時アクセス時の整合性保証[0m
[38;2;141;161;185m 144[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 暗号化によるオーバーヘッド最小化[0m
[38;2;141;161;185m 145[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ストレージ効率の最適化[0m
[38;2;141;161;185m 146[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 高可用性アーキテクチャでの運用[0m
[38;2;141;161;185m 147[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 148[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 品質保証[0m
[38;2;141;161;185m 149[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログ記録の完全性定期検証[0m
[38;2;141;161;185m 150[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- パフォーマンス監視と最適化[0m
[38;2;141;161;185m 151[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- エラー率の継続的測定[0m
[38;2;141;161;185m 152[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- データ品質の定期監査[0m
[38;2;141;161;185m 153[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 法的要件への準拠確認[0m
[38;2;141;161;185m 154[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 155[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## セキュリティ対策[0m
[38;2;141;161;185m 156[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログデータの暗号化保存[0m
[38;2;141;161;185m 157[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- アクセス制御による保護[0m
[38;2;141;161;185m 158[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 改ざん検知機能[0m
[38;2;141;161;185m 159[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 安全な転送プロトコル使用[0m
[38;2;141;161;185m 160[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 定期的なセキュリティ監査[0m
[38;2;141;161;185m───────┴────────────────────────────────────────────────────────────────────────[0m
