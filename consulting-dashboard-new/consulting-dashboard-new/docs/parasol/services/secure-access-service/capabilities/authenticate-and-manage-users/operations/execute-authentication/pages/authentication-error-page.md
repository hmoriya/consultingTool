# ページ定義: 認証エラーページ

## 基本情報

- **ページID**: PG-SEC-027
- **ページ名**: 認証エラーページ
- **URL**: `/auth/error`
- **アクセス権限**: 未認証ユーザー（認証失敗時に表示）
- **関連ユースケース**: UC-SEC-027 (認証失敗を処理する)

## ページ概要

認証失敗時にユーザーに適切なガイダンスを提供し、迅速な問題解決を支援するエラーページ。セキュリティを保ちながら、ユーザビリティを最大化し、復旧までの時間を最小化する。

## レイアウト構成

### ヘッダーセクション
- **ブランドロゴ**: 組織ロゴとシステム名（ユーザーの安心感確保）
- **エラー識別子**: 一意のエラーID（サポート時の問い合わせ用）
- **タイムスタンプ**: エラー発生日時

### メインコンテンツエリア

#### 1. 基本エラー表示（パスワード間違い等の一般的な失敗）
```
┌─ ログインできませんでした ─────────────────┐
│                                           │
│        🔒                                 │
│                                           │
│ ログイン情報を確認してください             │
│                                           │
│ 入力された情報に誤りがあります。           │
│ ユーザーIDとパスワードを確認の上、         │
│ もう一度お試しください。                   │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 💡 お困りの場合は:                         │
│                                           │
│ [🔄 もう一度試す]                          │
│                                           │
│ [🔑 パスワードを忘れた場合]                │
│                                           │
│ [👤 ユーザーIDを忘れた場合]                │
│                                           │
│ [💬 サポートに連絡]                        │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 残り試行回数: 3回                          │
│ (5回連続失敗でアカウントがロックされます)   │
└───────────────────────────────────────┘
```

#### 2. アカウントロック時のエラー表示
```
┌─ アカウントがロックされています ───────────┐
│                                           │
│        🚫                                 │
│                                           │
│ アカウントが一時的にロックされました       │
│                                           │
│ セキュリティ保護のため、このアカウントは   │
│ 一定時間ロックされています。               │
│                                           │
│ ロック解除まで: ⏰ 25分30秒                │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 🔓 今すぐアクセスが必要な場合:              │
│                                           │
│ [📧 管理者にロック解除を依頼]              │
│                                           │
│ [🆔 別のアカウントでログイン]              │
│                                           │
│ [📱 本人確認による緊急解除]                │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 📋 ロック理由: 連続ログイン失敗             │
│ 🕐 ロック開始: 2024-01-15 14:30           │
│ 🔄 自動解除: 2024-01-15 15:00             │
│                                           │
│ エラーID: ERR-AUTH-2024011530              │
└───────────────────────────────────────┘
```

#### 3. 多要素認証失敗時のエラー表示
```
┌─ 多要素認証に失敗しました ─────────────────┐
│                                           │
│        📱❌                               │
│                                           │
│ 認証コードが正しくありません               │
│                                           │
│ 入力された認証コードが無効です。           │
│ 正しいコードを入力してください。           │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 💡 認証コードの確認ポイント:                │
│                                           │
│ ✅ 最新のコードを使用していますか？        │
│ ✅ 数字の入力に間違いはありませんか？       │
│ ✅ 有効期限内（30秒以内）ですか？          │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 🔧 解決方法:                               │
│                                           │
│ [🔄 新しいコードを取得]                    │
│                                           │
│ [📱 認証アプリを確認]                      │
│                                           │
│ [📧 メール認証に変更]                      │
│                                           │
│ [📞 SMS認証に変更]                         │
│                                           │
│ [🆘 認証方法をリセット]                    │
│                                           │
│ 残り試行回数: 2回                          │
└───────────────────────────────────────┘
```

#### 4. 権限不足エラー表示
```
┌─ アクセス権限がありません ─────────────────┐
│                                           │
│        🚷                                 │
│                                           │
│ このシステムにアクセスする権限がありません │
│                                           │
│ ご利用のアカウントでは、このシステムへの   │
│ アクセスが許可されていません。             │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 🎯 必要な対応:                             │
│                                           │
│ [📋 アクセス権限を申請]                    │
│                                           │
│ [👤 上司に相談・承認依頼]                  │
│                                           │
│ [📞 システム管理者に連絡]                  │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 📝 権限申請に必要な情報:                   │
│ ├ 所属部署: 営業本部 第一営業部            │
│ ├ 利用目的: 顧客情報確認                   │
│ ├ 申請期間: 継続利用                       │
│ └ 承認者: 直属上司の承認が必要             │
│                                           │
│ 📧 申請状況確認: application@company.com  │
└───────────────────────────────────────┘
```

#### 5. システムメンテナンス・障害時エラー表示
```
┌─ システムメンテナンス中 ───────────────────┐
│                                           │
│        🔧                                 │
│                                           │
│ システムメンテナンス中です                 │
│                                           │
│ より良いサービスを提供するため、           │
│ システムメンテナンスを実施しております。   │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ ⏰ メンテナンス情報:                       │
│                                           │
│ 📅 実施期間:                               │
│    2024-01-15 22:00 ～ 2024-01-16 02:00  │
│                                           │
│ 🔄 完了予定: 2024-01-16 02:00              │
│                                           │
│ 📋 作業内容: セキュリティアップデート       │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 💼 緊急時のアクセス:                       │
│                                           │
│ [📞 緊急連絡先] (24時間対応)               │
│                                           │
│ [📧 緊急事態報告] メール受付               │
│                                           │
│ [🌐 システム状況確認] ステータスページ     │
│                                           │
│ ────────────────────────────────          │
│                                           │
│ 📬 メンテナンス完了通知:                   │
│ メール通知を希望される場合は登録してください │
│                                           │
│ [📧 通知登録]                              │
└───────────────────────────────────────┘
```

### サイドバー情報エリア
```
┌─ ヘルプ・サポート ─────────────────────────┐
│                                           │
│ 🆘 サポート情報                            │
│                                           │
│ 📞 ヘルプデスク                            │
│ ├ 電話: 0120-xxx-xxx                      │
│ ├ 受付: 平日 9:00-18:00                   │
│ └ 緊急時: 24時間対応                       │
│                                           │
│ 💬 チャットサポート                        │
│ ├ [💬 チャットを開始]                      │
│ ├ AI応答: 24時間                          │
│ └ 専門スタッフ: 営業時間内                 │
│                                           │
│ 📧 メールサポート                          │
│ ├ support@company.com                     │
│ └ 回答目安: 営業日24時間以内               │
│                                           │
│ 📚 よくある質問                            │
│ ├ ❓ パスワードを忘れました                │
│ ├ ❓ アカウントがロックされました          │
│ ├ ❓ 認証コードが届きません                │
│ └ [📖 全FAQ表示]                           │
└───────────────────────────────────────┘

┌─ セキュリティ情報 ─────────────────────────┐
│                                           │
│ 🔒 セキュリティ通知                        │
│                                           │
│ 📢 重要: 不審なアクセスについて             │
│                                           │
│ もしもこのエラーに覚えがない場合:           │
│                                           │
│ ⚠️ 第三者による不正アクセスの可能性         │
│                                           │
│ 🚨 すぐに実施すべき対策:                   │
│ ├ 1. パスワードの即座変更                 │
│ ├ 2. 多要素認証の有効化                   │
│ ├ 3. セキュリティ担当者への報告           │
│ └ 4. アクセス履歴の確認                   │
│                                           │
│ [🚨 セキュリティインシデント報告]          │
│                                           │
│ [🛡️ セキュリティ設定の確認]                │
└───────────────────────────────────────┘
```

## インタラクション仕様

### エラー分類による動的表示
- **エラータイプ検出**: 認証失敗の原因を自動分類
- **コンテキスト対応**: ユーザーの状況に応じた最適な表示
- **段階的ガイド**: 解決手順の順序立てた案内

### 自動復旧支援
- **リトライ機能**: 適切な間隔での再試行案内
- **代替手段提示**: 複数の解決オプション提供
- **プログレス表示**: 復旧手順の進行状況表示

### セキュリティ配慮
- **情報制限**: セキュリティ上重要な詳細情報の秘匿
- **攻撃対策**: ブルートフォース攻撃等への対策
- **監視連携**: 不正アクセス検知システムとの連携

## UI要件

### ビジュアルデザイン
- **カラーパレット**:
  - エラー表示: #EF4444 (レッド) - 明確な問題認識
  - 警告表示: #F59E0B (オレンジ) - 注意喚起
  - 情報表示: #3B82F6 (ブルー) - 補足情報
  - 成功表示: #10B981 (グリーン) - 解決済み状態

### エラーメッセージ設計
- **明確性**: 問題の性質を分かりやすく説明
- **建設性**: 次に取るべきアクションを明示
- **一貫性**: 統一されたトーンとスタイル

### アイコンシステム
- **状況表現**: エラータイプを直感的に表現するアイコン
- **アクション**: 実行可能な操作を示すアイコン
- **ステータス**: 現在の状況を表すアイコン

## レスポンシブ対応

### デスクトップ (1024px以上)
- 2カラムレイアウト: エラー情報（左）+ サポート情報（右）
- 詳細表示: エラー詳細とヘルプ情報の同時表示
- 複数アクション: 並列する解決オプションの表示

### タブレット (768px-1023px)
- 1カラムレイアウト: エラー情報を優先表示
- 折りたたみ式: ヘルプ情報のアコーディオン表示
- タッチ最適化: 大きなボタンでの操作性向上

### モバイル (767px以下)
- シンプルレイアウト: 最小限の情報表示
- 一行表示: 重要情報の絞り込み表示
- 指操作対応: タップしやすいボタンサイズ

## アクセシビリティ

### スクリーンリーダー対応
- 見出し構造: 適切な見出しレベルでの情報整理
- エラー説明: 詳細で理解しやすいエラー説明
- 操作ガイド: ステップバイステップの音声案内

### キーボードナビゲーション
- Tab順序: 論理的な順序でのフォーカス移動
- ショートカット: 主要アクションへの素早いアクセス
- Enter/Space: ボタン操作の確実な実行

## セキュリティ要件

### 情報保護
- **詳細情報の制限**: 攻撃者に有用な情報の漏洩防止
- **ログ記録**: エラー発生状況の詳細記録
- **監視連携**: セキュリティ監視システムとの連携

### 攻撃対策
- **情報推測防止**: ユーザー存在判定等の情報漏洩防止
- **タイミング攻撃対策**: レスポンス時間の一定化
- **ブルートフォース対策**: 連続試行に対する適切な制限

## パフォーマンス要件

### レスポンス時間
- エラーページ表示: 1秒以内
- 復旧アクション実行: 3秒以内
- ヘルプ情報表示: 2秒以内

### 可用性
- エラーページ自体の高可用性: 99.9%以上
- 軽量設計: 最小限のリソース使用
- 独立性: 他システム障害の影響を受けない設計

## 測定・改善指標

### ユーザビリティ指標
- エラー解決率（目標: 80%以上）
- 平均解決時間（目標: 5分以内）
- サポート問い合わせ削減率（目標: 30%削減）

### セキュリティ指標
- 情報漏洩防止率（目標: 100%）
- 攻撃検知・対処率（目標: 95%以上）
- セキュリティインシデント関連削減率（目標: 40%削減）

### 運用指標
- エラーページ稼働率（目標: 99.9%以上）
- ページロード時間（目標: 1秒以内）
- ユーザー満足度（目標: 3.5/5.0以上）