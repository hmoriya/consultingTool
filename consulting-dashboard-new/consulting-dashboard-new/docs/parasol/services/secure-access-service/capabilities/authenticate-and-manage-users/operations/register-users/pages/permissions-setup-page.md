# ページ定義: 権限設定ページ

## 基本情報

- **ページID**: PG-SEC-022
- **ページ名**: 権限設定ページ
- **URL**: `/auth/permissions-setup`
- **アクセス権限**: システム管理者, セキュリティ管理者, 部門管理者
- **関連ユースケース**: UC-SEC-022 (初期権限を設定する)

## ページ概要

新規ユーザーの初期権限設定を効率的に行うための管理画面。ロールベースアクセス制御（RBAC）の原則に基づき、直感的な操作で適切な権限付与を実現する。承認フローとセキュリティチェックを組み込んだ包括的な権限管理インターフェース。

## レイアウト構成

### ヘッダーセクション
- **ページタイトル**: "権限設定 - [ユーザー名]"
- **ユーザー情報**: 名前、所属部署、役職の表示
- **プログレスステータス**: 設定完了状況の可視化

### メインコンテンツエリア

#### 1. ユーザー基本情報セクション
```
┌─ ユーザー基本情報 ─────────────────────────┐
│                                           │
│ 👤 [アバター]  田中 太郎                    │
│ ├ 📧 tanaka@company.com                   │
│ ├ 🏢 営業本部 > 第一営業部                 │
│ ├ 👔 マネージャー                         │
│ ├ 📅 入社日: 2024/01/15                   │
│ └ 🔑 推奨ロール: 営業管理者                │
│                                           │
│ 📋 特記事項:                               │
│ ├ ☑ 新規事業開発プロジェクト参加予定       │
│ ├ ☑ 機密情報アクセス権限必要               │
│ └ □ 外部システム連携利用                   │
└───────────────────────────────────────┘
```

#### 2. 基本ロール設定セクション
```
┌─ 基本ロール設定 ───────────────────────────┐
│                                           │
│ 🏷️ プライマリロール（必須選択）             │
│                                           │
│ ○ 一般ユーザー                             │
│ │  └ 基本的な社内システム利用権限           │
│                                           │
│ ● 営業担当者                               │
│ │  └ 営業活動、顧客情報アクセス権限         │
│                                           │
│ ○ マネージャー                             │
│ │  └ チーム管理、承認機能の利用権限         │
│                                           │
│ ○ 部門管理者                               │
│ │  └ 部門全体の管理・監督権限               │
│                                           │
│ ○ システム管理者                           │
│ │  └ システム設定・ユーザー管理権限         │
│                                           │
│ 🔍 [詳細な権限内容を確認]                  │
└───────────────────────────────────────┘
```

#### 3. 詳細権限設定セクション
```
┌─ 詳細権限設定 ─────────────────────────────┐
│                                           │
│ 📁 システムアクセス権限                    │
│ ├ ☑ 顧客管理システム（読み取り）           │
│ ├ ☑ 顧客管理システム（編集）               │
│ ├ ☑ 売上管理システム（読み取り）           │
│ ├ ☐ 売上管理システム（編集）               │
│ ├ ☑ レポート作成システム                   │
│ └ ☐ 財務システム                           │
│                                           │
│ 👥 チーム・プロジェクト権限                │
│ ├ ☑ 第一営業部（メンバー）                 │
│ ├ ☐ 第一営業部（リーダー）                 │
│ ├ ☑ 新規事業プロジェクト（メンバー）       │
│ ├ ☐ 新規事業プロジェクト（管理者）         │
│ └ ☐ 全社プロジェクト（閲覧のみ）           │
│                                           │
│ 🔒 セキュリティレベル                      │
│ ├ ● 標準（一般業務情報）                   │
│ ├ ○ 機密（重要業務情報）                   │
│ ├ ○ 極秘（機密業務情報）                   │
│ └ ○ 最高機密（経営情報）                   │
│                                           │
│ ⏰ 時間制限                                │
│ ├ 利用時間: 平日 [09:00] - [18:00]        │
│ ├ 休日利用: ☐ 許可する                     │
│ └ 深夜利用: ☐ 許可する（22:00-06:00）     │
└───────────────────────────────────────┘
```

#### 4. 承認フロー設定セクション
```
┌─ 承認フロー ───────────────────────────────┐
│                                           │
│ 📝 権限レビュー状況                        │
│                                           │
│ 1️⃣ 直属上司承認                           │
│ ├ 👤 承認者: 山田 花子（部長）             │
│ ├ 📧 自動通知済み                         │
│ └ ⏳ 承認待ち                              │
│                                           │
│ 2️⃣ セキュリティ承認                       │
│ ├ 👤 承認者: システム管理部                │
│ ├ 📋 自動セキュリティチェック: ✅ 通過     │
│ └ ⏳ 承認待ち                              │
│                                           │
│ 3️⃣ 最終承認                               │
│ ├ 👤 承認者: 人事部                       │
│ └ ⏸️ 待機中                                │
│                                           │
│ ⚡ 緊急承認オプション                      │
│ ├ ☐ 緊急業務のため即座承認                 │
│ ├ 理由: [________________]                │
│ └ ⚠️ 後日正式承認手続きが必要               │
└───────────────────────────────────────┘
```

#### 5. 権限プレビュー・確認セクション
```
┌─ 権限プレビュー ───────────────────────────┐
│                                           │
│ 🔍 設定内容確認                            │
│                                           │
│ 📊 権限サマリー:                           │
│ ├ プライマリロール: 営業担当者             │
│ ├ アクセス可能システム: 6個                │
│ ├ 参加チーム/プロジェクト: 2個             │
│ ├ セキュリティレベル: 標準                 │
│ └ 利用時間制限: 平日9-18時                 │
│                                           │
│ ⚠️ セキュリティアラート:                   │
│ ├ 高権限の組み合わせが検出されました       │
│ ├ [詳細を確認] [リスク評価レポート]       │
│                                           │
│ 📋 コンプライアンスチェック:               │
│ ├ ✅ SOX法要件準拠                         │
│ ├ ✅ 個人情報保護法準拠                    │
│ ├ ✅ 職責分離原則準拠                      │
│ └ ⚠️ 定期レビュー設定推奨                  │
│                                           │
│ 🎯 推奨改善事項:                           │
│ ├ • 最小権限の原則に基づく権限削減         │
│ ├ • 期間限定権限の設定                     │
│ └ • 多要素認証の有効化                     │
└───────────────────────────────────────┘
```

### サイドバー情報エリア
```
┌─ 権限管理ガイド ───────────────────────────┐
│                                           │
│ 📚 クイックガイド                          │
│ ├ 🎯 最小権限の原則                        │
│ ├ 🔄 定期的な権限レビュー                  │
│ ├ 👥 職責分離の重要性                      │
│ └ 📖 詳細ガイドを見る                      │
│                                           │
│ 🚨 セキュリティポリシー                    │
│ ├ 📝 権限付与基準                          │
│ ├ ⏱️ 承認タイムライン                      │
│ ├ 🔒 機密情報アクセス規則                  │
│ └ 📋 コンプライアンス要件                  │
│                                           │
│ 📊 統計情報                                │
│ ├ 👥 部門内ユーザー数: 24名                │
│ ├ 🔑 平均権限数: 12個                      │
│ ├ ⚡ 平均承認時間: 2.5時間                 │
│ └ 📈 月間権限変更: 8件                     │
│                                           │
│ 🆘 サポート                                │
│ ├ 📞 セキュリティヘルプデスク              │
│ ├ 💬 チャットサポート                      │
│ └ 📧 権限管理チーム                        │
└───────────────────────────────────────┘
```

### フッターアクション
```
┌─ アクション ───────────────────────────────┐
│                                           │
│ [📋 下書き保存]  [👁️ プレビュー]  [✉️ 承認依頼] │
│                                           │
│ [🔙 戻る]                        [💾 保存] │
└───────────────────────────────────────┘
```

## インタラクション仕様

### 権限選択インターフェース
- **階層的表示**: 権限カテゴリの展開・折りたたみ機能
- **一括選択**: チェックボックスによる複数権限の同時選択
- **依存関係表示**: 関連権限の自動表示・推奨機能
- **競合検知**: 矛盾する権限組み合わせの警告表示

### リアルタイム検証
- **セキュリティスコア**: 権限設定に基づくリスクレベル表示
- **コンプライアンスチェック**: 規制要件への準拠状況確認
- **推奨最適化**: AI による権限最適化提案
- **影響分析**: 権限変更の影響範囲可視化

### 承認ワークフロー
- **進捗可視化**: 承認プロセスの現在状況表示
- **通知機能**: 承認者への自動通知送信
- **エスカレーション**: 承認遅延時の自動エスカレーション
- **履歴管理**: 承認・却下履歴の完全記録

## UI要件

### ビジュアルデザイン
- **カラーパレット**:
  - プライマリ: #1E40AF (青)
  - セカンダリ: #059669 (緑)
  - 警告: #D97706 (オレンジ)
  - 危険: #DC2626 (赤)
  - ニュートラル: #64748B (グレー)

### 権限レベル表示
- **低権限**: 青色のバッジ（🔵）
- **中権限**: 黄色のバッジ（🟡）
- **高権限**: オレンジ色のバッジ（🟠）
- **特権**: 赤色のバッジ（🔴）

### 状態インジケーター
- **承認済み**: 緑のチェックマーク（✅）
- **承認待ち**: 黄色のクロック（⏳）
- **拒否**: 赤のX マーク（❌）
- **警告**: オレンジの感嘆符（⚠️）

## レスポンシブ対応

### デスクトップ (1024px以上)
- 3カラムレイアウト: メイン70%、サイド30%
- 詳細権限設定: 展開可能なアコーディオンUI
- ドラッグ&ドロップ: 権限の直感的な移動・整理

### タブレット (768px-1023px)
- 2カラムレイアウト: 可変幅でのレスポンシブ調整
- タブ形式: 権限カテゴリのタブ切り替え
- スワイプ操作: 水平スクロールによる権限一覧

### モバイル (767px以下)
- 単一カラムレイアウト: 縦積み配置
- 折りたたみ式: 権限セクションの段階的表示
- 大型ボタン: 指操作に最適化されたインターフェース

## アクセシビリティ

### キーボードナビゲーション
- Tab順序: 論理的な順序でのフォーカス移動
- ショートカット: 主要操作のキーボードショートカット
- フォーカス可視化: 現在位置の明確な表示

### スクリーンリーダー対応
- セマンティクス: 適切なHTMLタグの使用
- ラベリング: aria-label による詳細説明
- 動的更新: aria-live による変更通知

### 視覚サポート
- 高コントラスト: WCAG AA準拠のコントラスト比
- 文字サイズ: 拡大機能対応
- カラーユニバーサル: 色覚多様性への配慮

## セキュリティ要件

### アクセス制御
- **ロール認証**: 管理者権限の厳格な確認
- **セッション管理**: 安全なセッション維持
- **監査ログ**: 全操作の詳細記録

### データ保護
- **暗号化通信**: TLS 1.3 による通信保護
- **入力検証**: SQLインジェクション等の攻撃防止
- **CSRF保護**: トークンベースの攻撃防止

## パフォーマンス要件

### レスポンス時間
- 権限検索: 1秒以内
- 設定保存: 3秒以内
- 承認通知: 5秒以内

### データ処理
- 大量権限表示: 500項目まで円滑表示
- 検索フィルタリング: リアルタイム絞り込み
- 自動補完: 300ms 以内のレスポンス

## 測定・改善指標

### 効率性指標
- 権限設定完了時間（目標: 5分以内）
- 設定エラー率（目標: 2%以下）
- 承認プロセス時間（目標: 4時間以内）

### セキュリティ指標
- 過剰権限付与率（目標: 1%以下）
- セキュリティ違反件数（目標: 月0件）
- コンプライアンス準拠率（目標: 100%）

### ユーザビリティ指標
- 管理者満足度（目標: 4.5/5.0以上）
- 操作完了率（目標: 98%以上）
- サポート問い合わせ率（目標: 5%以下）