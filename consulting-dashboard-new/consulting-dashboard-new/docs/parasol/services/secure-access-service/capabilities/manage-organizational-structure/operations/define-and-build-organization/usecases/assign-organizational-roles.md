# ユースケース: 組織ロールを割り当てる

## 基本情報

- **ユースケースID**: UC-SEC-042
- **ユースケース名**: 組織ロールを割り当てる
- **アクター**: 組織管理者, HR担当者, 部門長, 人事部, システム管理者
- **概要**: 組織構造に基づいて、各メンバーに適切な組織ロール（役職・権限・責任）を割り当て、組織運営を円滑にする

## 事前条件

- 組織構造と階層関係が確立されている
- 組織ロール管理権限を保有している
- 対象となるメンバーがシステムに登録されている
- ロール定義（役職・権限）が完成している

## 事後条件

### 成功時
- 各メンバーに適切な組織ロールが割り当てられている
- 役職に応じた権限が正しく設定されている
- 組織図でメンバーの配置が可視化されている
- 責任と権限の所在が明確になっている
- 人事システムとの連携が完了している

### 失敗時
- ロール割り当てが不完全になる
- 権限設定に矛盾が生じる
- 組織運営に支障が発生する
- 責任範囲が曖昧になる

## 基本フロー

1. 組織管理者がロール割り当て機能にアクセスする
2. システムが現在の組織構造とメンバー一覧を表示する
3. 組織管理者が割り当て対象の部門・チームを選択する
4. システムが選択された組織単位の詳細情報を表示する
5. 組織管理者が対象メンバーと利用可能なロールを確認する
6. システムがメンバーの経歴・スキル・現在のロールを表示する
7. 組織管理者が各メンバーに適切な組織ロールを選択・割り当てる
8. システムがロール割り当ての妥当性（権限重複・不足）をチェックする
9. 組織管理者が割り当て結果をプレビューで確認する
10. システムが他部門・他システムへの影響を分析・表示する
11. 組織管理者が割り当て内容を最終確認し、実行を承認する
12. システムがロール割り当てを実行し、関係者に通知を送信する

## 代替フロー

### 代替フロー1: 一括ロール割り当て
- 7a. 複数メンバーに同じロールを一括割り当てする場合
  - 7a1. 組織管理者が一括割り当てモードを選択する
  - 7a2. システムが一括対象メンバーと適用ロールの選択画面を提供する
  - 7a3. 組織管理者が一括割り当ての条件と除外対象を設定する
  - 7a4. システムが一括処理の結果をプレビュー表示する
  - 7a5. 基本フロー9に戻る

### 代替フロー2: 暫定ロール設定
- 7b. 正式決定前に暫定ロールを設定する場合
  - 7b1. 組織管理者が暫定設定モードを選択する
  - 7b2. システムが暫定期間と正式決定までのスケジュールを入力する画面を表示する
  - 7b3. 組織管理者が暫定ロールと期限を設定する
  - 7b4. システムが暫定期間終了時の自動処理を確認する
  - 7b5. 基本フロー8に戻る

### 代替フロー3: ロール移行処理
- 11a. 既存ロールからの移行を伴う場合
  - 11a1. システムが現在のロールと新しいロールの差異を分析する
  - 11a2. 組織管理者が移行に伴うデータ・権限の引き継ぎ方法を設定する
  - 11a3. システムが移行スケジュールと影響範囲を確認する
  - 11a4. 基本フロー12に戻る

## 例外フロー

### 例外1: ロール競合の検出
- 8a. 権限の重複や競合が検出された場合
  - 8a1. システムが競合する権限と影響範囲を表示する
  - 8a2. 組織管理者が競合解決方法（優先権・分離・調整）を選択する
  - 8a3. システムが解決方法に基づいて設定を調整する
  - 8a4. 基本フロー8から再開する

### 例外2: 必須ロールの欠如
- 8b. 組織運営に必須のロールが不足している場合
  - 8b1. システムが不足しているロールと業務への影響を警告する
  - 8b2. 組織管理者が追加割り当てまたはロール統合を決定する
  - 8b3. 対応完了後、基本フロー8から再開する

### 例外3: システム制約違反
- 12a. システムやライセンスの制約に違反した場合
  - 12a1. システムが制約内容と代替案を提示する
  - 12a2. 組織管理者が割り当てを調整するか、制約緩和を申請する
  - 12a3. 調整後、基本フロー12から再開する

## 特別要件

- **性能**: ロール割り当ての実行は対象人数に関わらず30秒以内で完了する
- **可用性**: ロール変更中も既存の業務アクセス権は継続される
- **セキュリティ**: 重要ロールの割り当てには多段階承認が必要である
- **監査性**: 全てのロール変更履歴が完全に記録・追跡可能である

## 関連ユースケース

- **前提**: 「組織構造を定義する」「階層関係を確立する」
- **包含**: 「ロール権限を設定する」
- **拡張**: 「ロール変更を承認する」「ロール履歴を管理する」
- **汎化**: 「組織変更を実行する」