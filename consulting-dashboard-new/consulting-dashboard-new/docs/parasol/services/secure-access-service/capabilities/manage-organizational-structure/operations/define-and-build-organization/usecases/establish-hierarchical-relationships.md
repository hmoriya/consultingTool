# ユースケース: 階層関係を確立する

## 基本情報

- **ユースケースID**: UC-SEC-041
- **ユースケース名**: 階層関係を確立する
- **アクター**: 組織管理者, HR担当者, 部門長, システム管理者
- **概要**: 組織内の部門・チーム・個人間の階層関係と報告ラインを明確に確立し、指揮命令系統を体系化する

## 事前条件

- 組織の基本構造が定義されている
- 組織管理権限を保有している
- 対象となる部門・役職が存在している
- 階層設計の原則が決定されている

## 事後条件

### 成功時
- 部門間の階層関係が明確に設定されている
- 報告ライン（上司・部下関係）が確立されている
- 指揮命令系統が体系化されている
- 権限の継承関係が定義されている
- 組織図で階層が可視化可能になっている

### 失敗時
- 階層関係が曖昧なまま残る
- 報告ラインに矛盾が生じる
- 権限の混乱が発生する
- 意思決定プロセスが不明確になる

## 基本フロー

1. 組織管理者が階層関係設定機能にアクセスする
2. システムが現在の組織構成と設定可能な階層パターンを表示する
3. 組織管理者が階層設計の基本方針（深い階層・フラット・混合）を選択する
4. システムが選択した方針に応じた設定画面を提供する
5. 組織管理者が最上位組織（本社・グループ会社）を設定する
6. システムが最上位組織の妥当性を確認する
7. 組織管理者が第2階層（事業部・子会社）の親子関係を設定する
8. システムが階層の一貫性をチェックする
9. 組織管理者が第3階層以下（部門・課・係）の詳細な階層を構築する
10. システムが全体の階層構造の整合性を検証する
11. 組織管理者が各階層での報告関係と権限継承ルールを定義する
12. システムが設定された階層関係を保存し、階層図を生成する

## 代替フロー

### 代替フロー1: マトリックス組織の設定
- 7a. マトリックス組織構造を採用する場合
  - 7a1. 組織管理者がマトリックス設定モードを選択する
  - 7a2. システムが機能軸と事業軸の設定画面を提供する
  - 7a3. 組織管理者が複数の報告関係を定義する
  - 7a4. システムが複数報告の優先順位を確認する
  - 7a5. 基本フロー9に戻る

### 代替フロー2: 段階的階層構築
- 9a. 大規模組織で段階的に構築する場合
  - 9a1. 組織管理者が優先構築エリアを選択する
  - 9a2. システムが段階構築のスケジュールを提案する
  - 9a3. 組織管理者が第1段階の階層を完成させる
  - 9a4. システムが段階完了を記録し、次段階を案内する
  - 9a5. 基本フロー10に戻る

### 代替フロー3: テンプレート適用
- 5b. 業界標準の階層テンプレートを使用する場合
  - 5b1. システムが業界別・規模別の階層テンプレートを提示する
  - 5b2. 組織管理者が適切なテンプレートを選択する
  - 5b3. システムがテンプレートを現在の組織に適用する
  - 5b4. 基本フロー7に戻る

## 例外フロー

### 例外1: 階層の循環参照
- 10a. 階層に循環参照が検出された場合
  - 10a1. システムが循環する部分を特定・表示する
  - 10a2. 組織管理者が循環を解消する修正を行う
  - 10a3. システムが修正後の整合性を再チェックする
  - 10a4. 基本フロー10から再開する

### 例外2: 権限継承の矛盾
- 11a. 権限継承に矛盾が発生した場合
  - 11a1. システムが矛盾する権限関係を警告する
  - 11a2. 組織管理者が権限設計を見直すか、例外設定を行う
  - 11a3. 修正完了後、基本フロー11から再開する

### 例外3: 階層深度の制限超過
- 9b. システムの階層深度制限を超えた場合
  - 9b1. システムが制限値と代替案を提示する
  - 9b2. 組織管理者が階層を統合するか、制限緩和を申請する
  - 9b3. 調整後、基本フロー9から再開する

## 特別要件

- **性能**: 階層図の生成は組織規模に関わらず15秒以内で完了する
- **可用性**: 階層変更中も既存の業務プロセスに影響しない
- **セキュリティ**: 階層関係の変更は承認フローを経て実行される
- **拡張性**: 最大10階層まで対応可能である

## 関連ユースケース

- **包含**: 「組織ロールを割り当てる」
- **前提**: 「組織構造を定義する」
- **拡張**: 「組織権限を継承する」
- **汎化**: 「組織変更を承認する」