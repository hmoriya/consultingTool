# ユースケース: 組織図をエクスポートする

## 基本情報

- **ユースケースID**: UC-SEC-047
- **ユースケース名**: 組織図をエクスポートする
- **アクター**: 組織管理者, HR担当者, 部門長, 経営層, 外部関係者
- **概要**: 作成・カスタマイズされた組織図を様々な形式・用途に応じてエクスポートし、社内外での共有・配布・プレゼンテーションを効果的に支援する

## 事前条件

- エクスポート対象の組織図が完成している
- ユーザーがエクスポート権限を保有している
- エクスポートの目的・用途が明確になっている
- 出力先の環境・システムが確認されている

## 事後条件

### 成功時
- 指定された形式で組織図がエクスポートされている
- エクスポートファイルが利用目的に適した品質・サイズである
- 必要な関係者が組織図にアクセス可能になっている
- 配布・共有・プレゼンテーションが効果的に実行できる
- エクスポート履歴が適切に記録されている

### 失敗時
- エクスポートが失敗し、ファイルが生成されない
- 品質・形式が要求に適さない
- 機密情報の漏洩リスクが発生する
- 利用目的が達成できない

## 基本フロー

1. ユーザーが組織図エクスポート機能にアクセスする
2. システムがエクスポート可能な組織図一覧と権限範囲を表示する
3. ユーザーがエクスポート対象の組織図を選択する
4. システムが選択された組織図の詳細情報と現在の設定を表示する
5. ユーザーがエクスポート形式（PDF・PNG・SVG・PowerPoint・Excel）を選択する
6. システムが選択された形式に応じた詳細設定オプションを提示する
7. ユーザーが出力品質（解像度・サイズ・色深度）を設定する
8. システムが設定に基づいてファイルサイズと品質の予測を表示する
9. ユーザーがエクスポート範囲（全体・部分・複数ページ）を指定する
10. システムが指定範囲のプレビューと分割方法を確認する
11. ユーザーが最終設定を確認し、エクスポートを実行する
12. システムがファイルを生成し、ダウンロード・共有リンクを提供する

## 代替フロー

### 代替フロー1: バッチエクスポート
- 3a. 複数の組織図を一括エクスポートする場合
  - 3a1. ユーザーが一括エクスポートモードを選択する
  - 3a2. システムが対象組織図の複数選択画面を表示する
  - 3a3. ユーザーが共通設定（形式・品質・命名ルール）を設定する
  - 3a4. システムが一括処理の進捗と完了予測時間を表示する
  - 3a5. 基本フロー11に戻る

### 代替フロー2: カスタムテンプレート出力
- 6a. 特定のテンプレート形式で出力する場合
  - 6a1. ユーザーが利用可能なテンプレート一覧を確認する
  - 6a2. システムが各テンプレートの特徴と適用用途を表示する
  - 6a3. ユーザーが適切なテンプレートを選択する
  - 6a4. システムがテンプレートに組織図データを適用する
  - 6a5. 基本フロー9に戻る

### 代替フロー3: セキュア配布
- 12a. 機密性の高い組織図を配布する場合
  - 12a1. ユーザーがセキュア配布オプションを選択する
  - 12a2. システムがアクセス制限と有効期限の設定画面を表示する
  - 12a3. ユーザーが配布先と権限レベルを設定する
  - 12a4. システムが暗号化・パスワード保護されたファイルを生成する

## 例外フロー

### 例外1: ファイルサイズ制限
- 8a. エクスポートファイルがサイズ制限を超える場合
  - 8a1. システムが制限値と現在のサイズ予測を表示する
  - 8a2. システムがサイズ削減方法（分割・圧縮・簡略化）を提案する
  - 8a3. ユーザーが削減方法を選択するか、設定を調整する
  - 8a4. 調整後、基本フロー8から再開する

### 例外2: エクスポート処理エラー
- 12a. ファイル生成中にエラーが発生した場合
  - 12a1. システムがエラー内容と原因を分析・表示する
  - 12a2. システムが代替設定や復旧方法を提案する
  - 12a3. ユーザーが設定を調整するか、再試行を選択する
  - 12a4. 成功後、基本フロー12から再開する

### 例外3: 権限・セキュリティ制約
- 5a. エクスポート権限に制約がある場合
  - 5a1. システムが制約内容と利用可能な選択肢を表示する
  - 5a2. ユーザーが制約内での最適な設定を選択する
  - 5a3. 必要に応じて、追加権限の申請を行う
  - 5a4. 権限確認後、基本フロー6から再開する

## 特別要件

- **品質**: エクスポートファイルは印刷・プレゼンテーションに適した高品質である
- **効率性**: 1000名規模の組織図を30秒以内でエクスポートする
- **セキュリティ**: 機密情報の適切な保護機能を提供する
- **互換性**: 主要なオフィスソフトウェアで利用可能な形式をサポートする

## 関連ユースケース

- **前提**: 「組織図を作成する」「可視化オプションをカスタマイズする」
- **拡張**: 「組織図を配布する」「プレゼンテーションを作成する」
- **汎化**: 「組織情報を共有する」