# テスト定義仕様書

**作成日**: 2025-01-26  
**更新日**: 2025-01-26  
**バージョン**: 1.0.0

## 1. 概要

テスト定義は、ユースケースが正しく実現されていることを確認するためのテストシナリオを定義します。パラソル設計では実装技術（テストフレームワーク、自動化ツール等）に依存せず、ビジネス視点での確認内容を自然言語で記述します。

### 1.1 位置づけ

```
ユースケース（システム利用シナリオ）
    ↓
【テスト定義】← ここ（ビジネス視点での確認）
    ↓
テスト実装（具体的なテストコード）
```

### 1.2 目的
- ビジネス要求の充足確認
- 利用者視点での品質保証
- 受入基準の明確化
- 実装非依存のテスト仕様

### 1.3 パラソル設計原則
- **ビジネス成果重視**: 技術的な動作ではなくビジネス結果を確認
- **利用者視点**: システム内部ではなく利用者から見える振る舞い
- **自然言語記述**: テストコードではなく日本語での表現
- **再現可能性**: 誰でも同じテストを実施できる明確さ

## 2. 3要素記法の適用

テスト定義も3要素記法を使用します：

```
日本語名 [英語名] [SYSTEM_NAME]
```

例：
```
プロジェクト登録テスト [ProjectRegistrationTest] [PROJECT_REGISTRATION_TEST]
進捗確認テスト [ProgressVerificationTest] [PROGRESS_VERIFICATION_TEST]
権限確認テスト [AuthorizationTest] [AUTHORIZATION_TEST]
```

## 3. 文書構造

### 3.1 必須セクション

```markdown
# テスト定義: [テスト名]

## テストの目的
### 確認したい内容
### 関連するユースケース
### 重要度

## テスト前提条件
### 環境条件
### データ条件
### 利用者条件

## テストシナリオ
### シナリオ1: [正常系]
### シナリオ2: [代替系]
### シナリオ3: [異常系]

## 期待結果
### 成功基準
### 確認項目

## テストデータ
### 入力データ
### マスタデータ
### 期待される出力

## エラーケース
### エラーパターン
### 回復確認
```

## 4. 記述規則

### 4.1 禁止事項
- ❌ テストコード（assert、expect等）
- ❌ 技術的な用語（API、データベース、SQL等）
- ❌ 自動化ツール名（Selenium、JUnit等）
- ❌ 内部処理の確認

### 4.2 推奨表現
- ✅ 利用者の行動と結果
- ✅ ビジネス上の期待値
- ✅ 業務シナリオ
- ✅ 目に見える変化

## 5. テストの目的

### 5.1 目的の記述
```markdown
## テストの目的
### 確認したい内容
[このテストで何を確認したいかを明確に記述]
[ビジネス上のリスクや価値を含める]

### 関連するユースケース
- [ユースケース名] [[UseCase]] [[USE_CASE]]
  - 確認観点: [UCのどの部分を確認するか]

### 重要度
- レベル: [高/中/低]
- 理由: [なぜこの重要度なのか]
```

## 6. テスト前提条件

### 6.1 条件の定義
```markdown
### 環境条件
- 時期: [いつテストを実施するか]
- 状況: [どのような業務状況を想定するか]

### データ条件
- 必要なデータ: [事前に準備すべきデータ]
- データの状態: [データがどういう状態か]

### 利用者条件
- テスト実施者: [誰がテストを行うか]
- 権限: [必要な権限や役割]
```

## 7. テストシナリオ

### 7.1 シナリオ構造
```markdown
### シナリオ[N]: [シナリオ名]
#### 目的
[このシナリオで確認したいこと]

#### 手順
1. [利用者が行う操作1]
2. [確認する内容1]
3. [利用者が行う操作2]
4. [確認する内容2]

#### 期待される結果
- [確認項目1]: [期待値]
- [確認項目2]: [期待値]

#### 判定基準
[成功/失敗を判断する明確な基準]
```

### 7.2 シナリオの種類

#### 正常系シナリオ
```markdown
### シナリオ1: 基本的な成功パス
通常の業務フローに沿った最も一般的な利用方法
```

#### 代替系シナリオ
```markdown
### シナリオ2: 別ルートでの成功
通常とは異なる方法で同じ目的を達成するパス
```

#### 異常系シナリオ
```markdown
### シナリオ3: エラー処理の確認
意図的に問題を発生させて適切な対処を確認
```

## 8. 期待結果の定義

### 8.1 成功基準
```markdown
### 成功基準
- **業務完了**: [どの業務が完了していること]
- **データ状態**: [データがどう変化していること]
- **通知**: [誰に何が通知されていること]
- **次の行動**: [次に何ができる状態になっていること]
```

### 8.2 確認項目
```markdown
### 確認項目
| 確認内容 | 期待値 | 確認方法 |
|---------|--------|----------|
| [確認項目1] | [期待される状態] | [どうやって確認するか] |
| [確認項目2] | [期待される値] | [どうやって確認するか] |
```

## 9. テストデータ

### 9.1 データの定義
```markdown
### 入力データ
- [データ項目1]: [具体的な値]
  - 選定理由: [なぜこの値を使うか]
- [データ項目2]: [具体的な値]
  - 選定理由: [なぜこの値を使うか]

### マスタデータ
- [マスタ種別]: [必要な設定内容]
- [参照データ]: [存在すべきデータ]

### 期待される出力
- [出力項目1]: [期待値]
- [出力項目2]: [期待値]
```

## 10. エラーケース

### 10.1 エラーパターン
```markdown
### エラーパターン
- **[エラー名]**: [発生条件]
  - 確認内容: [エラー時の振る舞い]
  - 回復方法: [どう回復するか]
  - メッセージ: [利用者に伝わる内容]
```

### 10.2 境界値テスト
```markdown
### 境界値
- **[項目名]の最小値**: [値]
  - 期待動作: [正常に処理される]
- **[項目名]の最大値**: [値]
  - 期待動作: [正常に処理される]
- **[項目名]の範囲外**: [値]
  - 期待動作: [適切にエラーとなる]
```

## 11. 品質基準

### 11.1 網羅性
- ユースケースの全フローをカバー
- 主要なエラーケースを含む
- ビジネスルールを確認

### 11.2 明確性
- 手順が具体的で再現可能
- 期待結果が明確
- 判定基準が客観的

### 11.3 独立性
- 他のテストに依存しない
- 実行順序に依存しない
- 環境に過度に依存しない

## 12. テストの分類

### 12.1 受入テスト
```markdown
## 受入テストの観点
- ビジネス要求の充足
- 利用者の期待との一致
- 業務フローの完遂
```

### 12.2 シナリオテスト
```markdown
## シナリオテストの観点
- 一連の業務の流れ
- 複数機能の連携
- 実際の利用場面の再現
```

### 12.3 回帰テスト
```markdown
## 回帰テストの観点
- 既存機能への影響
- 過去の問題の再発防止
- 基本機能の継続動作
```

## 13. アンチパターン

### 13.1 避けるべき記述例
```markdown
❌ 悪い例：
「HTTPステータスコード200を確認」
「データベースのレコードが作成される」
「assertEqualsでチェック」

✅ 良い例：
「登録完了メッセージが表示される」
「次回ログイン時に登録した情報が表示される」
「エラーなく処理が完了する」
```

### 13.2 よくある間違い
- 技術的な実装の確認
- UIの詳細な確認
- パフォーマンスの数値的確認
- 内部状態の確認

## 14. 段階的詳細化

### 14.1 初期段階（Phase 1）
- 主要な成功パスのみ
- 基本的な確認項目
- 最小限のテストデータ

### 14.2 詳細化段階（Phase 2）
- 代替パスの追加
- エラーケースの定義
- 詳細なテストデータ

### 14.3 完成段階（Phase 3）
- 全シナリオの網羅
- 境界値テスト
- 回帰テストの考慮

## 15. テスト実施のガイドライン

### 15.1 実施タイミング
- 開発完了後
- 変更実施後
- リリース前

### 15.2 実施者
- 業務担当者
- 品質保証担当
- 利用者代表

### 15.3 記録方法
- 実施日時
- 実施者
- 結果（成功/失敗）
- 問題があった場合の詳細