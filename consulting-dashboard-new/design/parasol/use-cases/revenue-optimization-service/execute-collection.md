# ユースケース: 督促を実施する [Execute Collection] [EXECUTE_COLLECTION]

## ユースケース概要

### 目的
支払期限を超過した未入金案件に対して段階的な督促活動を実施し、適切な債権回収と顧客関係の維持を両立させることで、売掛金の健全な回収を実現する。

### アクター
- **主アクター**: 経理担当者 [Accounting Staff] [ACCOUNTING_STAFF]
  - 説明: 督促活動の計画と実行を担当する
- **副アクター**: 財務マネージャー [Finance Manager] [FINANCE_MANAGER]
  - 説明: 督促方針の決定と困難案件の対応を行う
- **副アクター**: プロジェクトマネージャー [Project Manager] [PROJECT_MANAGER]
  - 説明: クライアントとの関係性を考慮した督促方法の助言を行う
- **副アクター**: クライアント [Client] [CLIENT]
  - 説明: 督促通知の受領と支払対応を行う

### 事前条件
1. 支払期限を超過した未入金の請求書が存在する
2. クライアントの連絡先情報が最新に更新されている
3. 督促段階別のテンプレートと手順が設定されている
4. 経理担当者が督促実行権限を持っている

### 事後条件
1. 適切な督促活動が段階的に実施されている
2. 督促履歴と顧客の反応が記録されている
3. 支払約束や分割払い等の合意が文書化されている
4. 必要に応じて法的手続きの準備が開始されている

### トリガー
- **種別**: 時間駆動 + 要求駆動
- **詳細**: 支払期限超過の自動検知、または手動による督促開始指示

## 基本フロー

1. 経理担当者が督促対象案件一覧を確認し、督促実施対象を選択する
2. システムが対象案件の遅延日数と督促履歴を表示する
3. 経理担当者が督促段階（第1督促、第2督促等）を判定・設定する
4. システムが設定された段階に応じた督促方法とテンプレートを提示する
5. 経理担当者が督促内容を確認・調整し、督促を実行する
6. システムが督促実施を記録し、次回督促予定日を設定する
7. クライアントから回答があった場合、経理担当者が内容を確認・記録する
8. システムが督促結果に基づき、次のアクション（継続督促、法的手続き等）を提案する

## 代替フロー

### 代替フロー1: 分割払い合意の締結
- **分岐点**: 基本フロー ステップ7
- **条件**: クライアントから分割払いの提案があった場合
1. 経理担当者が分割払い条件（回数、金額、期日）を確認する
2. 財務マネージャーが分割払い条件の妥当性を評価・承認する
3. システムが分割払い合意書を生成し、クライアントに送付する
4. クライアントから合意書の署名を取得する
5. システムが分割払いスケジュールを設定し、個別管理を開始する

### 代替フロー2: 緊急督促の実施
- **分岐点**: 基本フロー ステップ3
- **条件**: 大口案件で緊急回収が必要な場合
1. 経理担当者が緊急督促フラグを設定する
2. 財務マネージャーとプロジェクトマネージャーが緊急対応方針を決定する
3. 複数チャネル（メール、電話、訪問）での同時督促を実行する
4. エグゼクティブレベルでの督促も並行して実施する
5. 基本フロー ステップ6に進む

## 例外フロー

### 例外フロー1: クライアントとの連絡不通
- **発生点**: 基本フロー ステップ5
- **条件**: 督促通知への応答がなく、連絡が取れない場合
1. システムが連絡不通の継続期間を確認する
2. 経理担当者が代替連絡手段（郵送、関係者経由等）を試行する
3. プロジェクトマネージャーに現場レベルでの接触を依頼する
4. 一定期間（30日）経過後は法的手続きの検討を開始する

### 例外フロー2: 支払拒否の表明
- **発生点**: 基本フロー ステップ7
- **条件**: クライアントが支払義務を否認した場合
1. 経理担当者が拒否理由と根拠を詳細に記録する
2. プロジェクトマネージャーが契約内容と成果物を再確認する
3. 法務部門に相談し、法的根拠と対応方針を検討する
4. 必要に応じて証拠保全と法的手続きの準備を開始する

### 例外フロー3: クライアントの財務困窮
- **発生点**: 基本フロー ステップ7
- **条件**: クライアントが経営困難を理由に支払困難を表明した場合
1. 経理担当者がクライアントの財務状況を調査・確認する
2. 財務マネージャーが債権保全策（担保設定、保証人等）を検討する
3. 長期分割払いや債権放棄等の選択肢を検討する
4. 必要に応じて弁護士に相談し、債権回収方針を決定する

## ビジネスルール

1. **段階的督促ルール**: 督促は段階的にエスカレーションし、関係悪化を最小限に抑制する
   - 適用タイミング: 基本フロー ステップ3
   - 例: 第1督促（リマインド）→第2督促（正式通知）→第3督促（最終通告）

2. **督促間隔ルール**: 各督促段階間には適切な間隔を設ける
   - 適用タイミング: 基本フロー ステップ6
   - 例: 第1督促後7日、第2督促後14日、第3督促後30日

3. **記録保持ルール**: 全ての督促活動は法的証拠として保存する
   - 適用タイミング: 全プロセス
   - 例: 送付証明、通話録音、面談記録等を完全保存

## 入出力情報

### 入力情報
- 延滞債権情報 [Overdue Receivables Information] [OVERDUE_RECEIVABLES_INFO]
  - 内容: 請求書番号、延滞額、延滞日数、クライアント情報、過去督促履歴
  - 形式: システム内部データ
  - 必須/任意: 必須
  - 検証ルール: 支払期限超過済み、未回収残高が存在

- 督促段階設定 [Collection Stage Settings] [COLLECTION_STAGE_SETTINGS]
  - 内容: 督促段階、督促方法、テンプレート、エスカレーション条件
  - 形式: 設定データ（JSON）
  - 必須/任意: 必須
  - 検証ルール: 段階的にエスカレーション、法的手続きまでのフロー

### 出力情報
- 督促通知書 [Collection Notice] [COLLECTION_NOTICE]
  - 内容: 延滞内容、支払要求、期限、法的措置の警告
  - 用途: クライアントへの正式な支払要求
  - 形式: PDF形式、配達証明付き送付

- 督促活動記録 [Collection Activity Record] [COLLECTION_ACTIVITY_RECORD]
  - 内容: 督促日時、方法、内容、クライアント反応、次回予定
  - 用途: 債権回収の証跡と法的手続きの根拠
  - 保存期間: 10年間（法的要件）

## 非機能要件

- **応答性**:
  - 督促リスト生成: 5秒以内
  - 督促通知送付: 30秒以内

- **利用可能性**:
  - 利用時間: 平日8:00-20:00（必須）、緊急時は24時間対応
  - 計画停止: 督促期限日は停止回避

- **セキュリティ**:
  - 個人情報保護: 督促情報の暗号化保存
  - アクセス制御: 経理担当者以上の権限が必要
  - 監査ログ: 全ての督促活動を改ざん不可能な形で記録

- **法的準拠**:
  - 債権回収規制: 関連法規に完全準拠
  - 証拠能力: 法的手続きで使用可能なレベルの記録

## 関連ユースケース

- <<include>> 延滞状況を確認する [Check Overdue Status] [CHECK_OVERDUE_STATUS]
  - 説明: 督促実施前に必ず実行される

- <<extend>> 法的手続きを開始する [Initiate Legal Proceedings] [INITIATE_LEGAL_PROCEEDINGS]
  - 説明: 督促が不調に終わった場合のみ実行される

- 先行: 入金状況を確認する [Check Payment Status] [CHECK_PAYMENT_STATUS]
  - 説明: このユースケースの前に完了している必要がある

- 後続: 債権回収結果を記録する [Record Collection Results] [RECORD_COLLECTION_RESULTS]
  - 説明: このユースケースの後に通常実行される

## ページ遷移概要

```
[督促管理ダッシュボード] → [督促対象選択ページ] → [督促段階設定ページ] → [督促内容作成ページ] → [督促実行ページ] → [結果記録ページ]
        ↓                   ↓                    ↓                  ↓
   [延滞分析ページ]      [督促履歴ページ]      [テンプレート編集ページ] [分割払い合意ページ]
```

## テストシナリオ概要

1. **正常系テスト**:
   - 標準的な3段階督促を最初から最後まで完全実行
   - 各督促段階での適切なエスカレーションを確認
   - 督促記録の正確性と法的証拠能力を確認

2. **代替系テスト**:
   - 分割払い合意と緊急督促を個別に実行
   - 各代替フローの正常動作を確認

3. **例外系テスト**:
   - 連絡不通、支払拒否、財務困窮を意図的に発生
   - エラーハンドリングと例外処理を確認

4. **法的準拠テスト**:
   - 債権回収関連法規への準拠性を確認
   - 督促記録の法的証拠能力を確認

5. **ストレステスト**:
   - 大量督促案件（500件）での処理性能を確認
   - 督促期限集中時の処理能力を確認