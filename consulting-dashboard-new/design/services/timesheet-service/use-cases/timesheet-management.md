# 工数管理 ユースケース

**更新日: 2025-01-13**

## UC-TIME-001: 日次工数入力

### 概要
コンサルタントが日々の作業時間をプロジェクト・タスクごとに記録する

### アクター
- コンサルタント
- プロジェクトマネージャー

### 事前条件
- ユーザーがログイン済みである
- ユーザーがプロジェクトメンバーである
- 工数入力対象日が工数入力可能期間内である

### 基本フロー
1. ユーザーが「工数入力」メニューを選択する
2. システムが週次カレンダー形式の工数入力画面を表示する
   - 当週の日付（月〜日）
   - 参画中のプロジェクト一覧
   - 各日の入力済み工数
3. ユーザーが入力する日付のセルをクリックする
4. システムが工数入力フォームを表示する
   - プロジェクト選択
   - タスク選択（オプション）
   - 作業時間（0.5時間単位）
   - 作業内容
   - 請求可否フラグ
5. ユーザーが工数情報を入力する
6. ユーザーが「保存」ボタンをクリックする
7. システムがバリデーションを実行する
   - 1日の合計が24時間を超えていないか
   - 過去の締め日以前でないか
   - 将来日付でないか
8. システムが工数を保存する
9. システムが週次合計を更新する

### 代替フロー
- 3a. 複数プロジェクトの工数を入力する場合
  1. ユーザーが「行追加」ボタンをクリック
  2. システムが新しい入力行を追加
  3. ユーザーが別プロジェクトの工数を入力

- 5a. 前日の工数をコピーする場合
  1. ユーザーが「前日コピー」ボタンをクリック
  2. システムが前日の工数データをコピー
  3. ユーザーが必要に応じて修正

### 事後条件
- 工数が記録される
- プロジェクトの実績工数が更新される
- 稼働率が再計算される

---

## UC-TIME-002: 週次工数確認・提出

### 概要
コンサルタントが週次で工数を確認し、承認申請する

### アクター
- コンサルタント

### 事前条件
- 当週の工数が入力されている
- 提出期限内である（通常は翌週月曜まで）

### 基本フロー
1. ユーザーが工数入力画面で当週の工数を確認する
2. システムが週次サマリーを表示する
   - 曜日別工数
   - プロジェクト別工数
   - 総工数
   - 請求可能工数
3. ユーザーが入力漏れがないか確認する
4. ユーザーが「提出」ボタンをクリックする
5. システムが最終確認ダイアログを表示する
6. ユーザーが「確定」をクリックする
7. システムが工数のステータスを「提出済み」に更新する
8. システムがPMに承認依頼通知を送信する

### 代替フロー
- 3a. 入力漏れがある場合
  1. ユーザーが未入力の日付を確認
  2. ユーザーが工数を追加入力
  3. 基本フローの4に戻る

### 事後条件
- 工数が提出済みステータスになる
- PMに通知が送信される
- 提出後は編集不可になる

---

## UC-TIME-003: 工数承認（PM）

### 概要
プロジェクトマネージャーがチームメンバーの工数を確認・承認する

### アクター
- プロジェクトマネージャー

### 事前条件
- チームメンバーが工数を提出済みである
- ユーザーがPM権限を持つ

### 基本フロー
1. PMが「工数承認」画面を開く
2. システムが承認待ち工数一覧を表示する
   - メンバー名
   - 期間
   - プロジェクト別工数
   - 総工数
   - ステータス
3. PMがメンバーの工数詳細をクリックする
4. システムが日別・タスク別の詳細を表示する
   - 作業内容
   - 請求可否
   - プロジェクト進捗との整合性
5. PMが工数の妥当性を確認する
6. PMが「承認」ボタンをクリックする
7. システムが工数ステータスを「承認済み」に更新する
8. システムがメンバーに承認完了通知を送信する

### 代替フロー
- 6a. 修正が必要な場合
  1. PMが「差戻し」ボタンをクリック
  2. システムがコメント入力欄を表示
  3. PMが修正依頼内容を入力
  4. システムが工数を「差戻し」ステータスに更新
  5. システムがメンバーに差戻し通知を送信

- 一括承認の場合
  1. PMが複数の工数記録を選択
  2. PMが「一括承認」ボタンをクリック
  3. システムが選択された工数をすべて承認

### 事後条件
- 工数が承認または差戻しされる
- 人件費計算の基礎データが確定する
- プロジェクト原価が更新される

---

## UC-TIME-004: 月次工数レポート

### 概要
月次の工数実績をレポート形式で確認する

### アクター
- コンサルタント
- プロジェクトマネージャー
- エグゼクティブ

### 事前条件
- 対象月の工数データが存在する
- ユーザーが適切な権限を持つ

### 基本フロー
1. ユーザーが「工数レポート」を選択する
2. システムが対象月選択画面を表示する
3. ユーザーが対象年月を選択する
4. システムが月次工数サマリーを表示する
   - 総工数
   - プロジェクト別工数
   - 請求可能/不可能工数
   - 承認済み/未承認工数
5. システムが工数分析グラフを表示する
   - 日別工数推移
   - プロジェクト別割合
   - 稼働率推移
6. ユーザーが「詳細表示」をクリックする
7. システムが日別・プロジェクト別の詳細を表示する
8. ユーザーが「エクスポート」をクリックする
9. システムがExcel形式でダウンロードする

### 代替フロー
- 権限による表示制御
  - コンサルタント：自分の工数のみ
  - PM：自プロジェクトのメンバー工数
  - エグゼクティブ：全社工数

### 事後条件
- 工数実績が可視化される
- 必要に応じてレポートがエクスポートされる

---

## UC-TIME-005: 工数修正

### 概要
承認前の工数を修正する、または承認後の工数を特別に修正する

### アクター
- コンサルタント（承認前のみ）
- プロジェクトマネージャー
- システム管理者

### 事前条件
- 修正対象の工数が存在する
- 適切な権限を持つ

### 基本フロー（承認前の修正）
1. ユーザーが工数入力画面を開く
2. システムが編集可能な工数を表示する
3. ユーザーが修正したい工数をクリックする
4. システムが編集フォームを表示する
5. ユーザーが工数情報を修正する
6. ユーザーが「更新」ボタンをクリックする
7. システムがバリデーションを実行する
8. システムが工数を更新する

### 代替フロー（承認後の修正）
1. PMまたは管理者が「工数修正申請」を選択する
2. システムが修正申請フォームを表示する
3. ユーザーが修正内容と理由を入力する
4. システムが修正履歴を記録する
5. システムが関連する財務データを再計算する

### 事後条件
- 工数が修正される
- 修正履歴が記録される
- 関連データが更新される

---

## UC-TIME-006: 稼働率分析

### 概要
個人およびチームの稼働率を分析し、リソース最適化を図る

### アクター
- プロジェクトマネージャー
- エグゼクティブ
- リソースマネージャー

### 事前条件
- 工数データが蓄積されている
- ユーザーが管理権限を持つ

### 基本フロー
1. ユーザーが「稼働率分析」を選択する
2. システムが分析対象選択画面を表示する
   - 個人/チーム/全社
   - 期間
3. ユーザーが分析条件を設定する
4. システムが稼働率データを計算・表示する
   - 平均稼働率
   - 標準労働時間に対する実働率
   - 請求可能工数率
5. システムが稼働率トレンドグラフを表示する
   - 月次推移
   - 個人別比較
   - 目標値との差異
6. システムがアラートを表示する
   - 過重労働リスク（稼働率90%以上）
   - 低稼働（稼働率60%未満）
7. ユーザーが詳細分析を確認する
   - プロジェクト別内訳
   - 非請求工数の要因

### 事後条件
- 稼働状況が可視化される
- リソース配分の最適化につながる

---

## UC-TIME-007: 工数予実管理

### 概要
プロジェクトの見積工数と実績工数を比較し、進捗を管理する

### アクター
- プロジェクトマネージャー
- エグゼクティブ

### 事前条件
- プロジェクトに見積工数が設定されている
- 実績工数データが存在する

### 基本フロー
1. PMがプロジェクト詳細から「工数予実」を選択する
2. システムが工数予実比較画面を表示する
   - WBS/タスク別見積工数
   - 実績工数
   - 消化率
   - 残工数
3. システムが予実差異分析を表示する
   - 超過タスクのハイライト
   - 要因分析
   - 完了予測
4. PMが問題のあるタスクを確認する
5. システムが改善提案を表示する
   - リソース追加
   - スコープ調整
   - スケジュール見直し

### 代替フロー
- EVM（Earned Value Management）分析
  1. システムがEVM指標を計算
  2. CV（コスト差異）、SV（スケジュール差異）を表示
  3. 完了時予測を提示

### 事後条件
- 工数超過リスクが早期に発見される
- プロジェクト計画の見直しが行われる

---

## UC-TIME-008: 工数データ連携

### 概要
工数データを他システムと連携し、給与計算や請求処理に活用する

### アクター
- システム管理者
- 経理担当者

### 事前条件
- 対象期間の工数が承認済みである
- 連携先システムが設定されている

### 基本フロー
1. ユーザーが「工数データ出力」を選択する
2. システムが出力条件設定画面を表示する
   - 対象期間
   - 対象組織/プロジェクト
   - 出力形式
3. ユーザーが条件を設定する
4. システムがデータを抽出・整形する
   - 個人別集計
   - プロジェクト別集計
   - 請求用集計
5. システムが出力プレビューを表示する
6. ユーザーが「出力実行」をクリックする
7. システムがデータをエクスポートする
   - CSV/Excel形式
   - API連携（将来実装）

### 事後条件
- 工数データが外部システムで利用可能になる
- 給与計算や請求処理が効率化される