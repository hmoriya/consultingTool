# CLAUDE.md ドキュメント構成管理

## 📏 ファイルサイズ制限について

### 背景
CLAUDE.mdは大規模プロジェクトの包括的な設計書として成長してきましたが、以下の制限により分割が必要になっています：

- **Claude Codeの読み込み制限**: 約2000行（約100KB）
- **可読性の問題**: 単一ファイルでの長大な文書は管理・検索が困難
- **更新頻度の違い**: 各分野で更新タイミングが異なる

### 現在のファイル状況

```
consulting-dashboard-new/
├── CLAUDE.md                          # 🏠 メインプロジェクト設計書
├── CLAUDE-README.md                   # 📖 プロジェクト概要・README
└── docs/
    ├── CLAUDE-documentation-structure.md  # 📋 この構成管理ファイル
    └── issues/
        ├── issue-146-api-what-how-separation-completion-report.md
        └── issue-146-parasol-integration-completion.md
```

## 🎯 推奨分割構成

### 提案する分割ファイル構成

```
consulting-dashboard-new/
├── CLAUDE.md                          # 🏠 メインプロジェクト設計書（軽量化版）
├── CLAUDE-基本設定.md                  # ⚙️ 環境構築・基本設定・開発コマンド
├── CLAUDE-パラソル設計.md              # 🎨 パラソル設計v2.0詳細・テンプレート
├── CLAUDE-データベース設計.md          # 🗄️ マイクロサービス DB設計・スキーマ
├── CLAUDE-API設計.md                  # 🔗 API設計・Issue #146成果詳細
└── claude-github.md                   # 🐙 GitHub運用・CI/CD・デプロイ
```

### 各ファイルの内容分担

#### 1. CLAUDE.md（メインファイル）- 約1500行
**対象読者**: 全開発者
**内容**:
- プロジェクト概要・アーキテクチャスタック
- 重要な実装指針・設計原則
- 他ドキュメントへのナビゲーション
- 緊急時の重要情報

#### 2. CLAUDE-基本設定.md - 約800行
**対象読者**: 新規開発者・環境構築担当
**内容**:
- 環境構築手順・開発コマンド
- データベース初期化・シードデータ
- トラブルシューティング
- 開発ツール設定

#### 3. CLAUDE-パラソル設計.md - 約1200行
**対象読者**: 設計者・アーキテクト
**内容**:
- パラソル設計v2.0詳細仕様
- テンプレート・命名規則
- 設計プロセス・品質チェック
- 1対1関係強制ディレクトリ構造

#### 4. CLAUDE-データベース設計.md - 約1000行
**対象読者**: データベース設計者・運用担当
**内容**:
- マイクロサービス別DB構成
- Prismaスキーマ管理
- データ移行・バックアップ戦略
- パフォーマンス最適化

#### 5. CLAUDE-API設計.md - 約1000行
**対象読者**: API設計者・バックエンド開発者
**内容**:
- Issue #146 API WHAT/HOW分離詳細
- API設計テンプレート・ガイドライン
- エンドポイント設計・認証仕様
- APIUsageManagementPanel活用法

#### 6. claude-github.md - 約600行
**対象読者**: DevOps・運用担当・全開発者
**内容**:
- GitHub運用手順・PR作成
- CI/CD設定・自動化
- デプロイ手順・リリース管理
- Issue管理・ブランチ戦略

## 🚀 分割実施計画

### Phase 1: 基本分割（2時間）
1. **CLAUDE-基本設定.md作成**: 環境・DB関連セクション移動
2. **CLAUDE-パラソル設計.md作成**: パラソル設計関連セクション移動
3. **メインCLAUDE.mdの軽量化**: 他ファイルへの参照リンク追加

### Phase 2: 専門分割（3時間）
1. **CLAUDE-データベース設計.md作成**: DB設計詳細の分離
2. **CLAUDE-API設計.md作成**: Issue #146関連の独立化
3. **claude-github.md強化**: 運用手順の充実

### Phase 3: 統合・検証（1時間）
1. **相互リンクの設置**: ファイル間ナビゲーション強化
2. **検索インデックス作成**: 各ファイルの内容サマリー
3. **動作確認**: 分割後の利用性確認

## 📋 ファイル管理ルール

### 更新時の注意事項
1. **影響範囲確認**: 関連ファイルへの影響を事前チェック
2. **リンク整合性**: 他ファイルからの参照リンクの維持
3. **バージョン管理**: 主要変更時のバージョン番号更新
4. **更新通知**: 重要変更時のチーム共有

### ファイルサイズ監視
```bash
# ファイルサイズ確認スクリプト
for file in CLAUDE*.md claude*.md; do
    if [ -f "$file" ]; then
        lines=$(wc -l < "$file")
        size=$(ls -lh "$file" | awk '{print $5}')
        echo "$file: $lines lines, $size"
        if [ $lines -gt 2000 ]; then
            echo "⚠️  WARNING: $file exceeds 2000 lines limit"
        fi
    fi
done
```

### 分割基準
- **2000行超過**: 即座に分割検討
- **1800行到達**: 分割準備開始
- **関連性**: 機能別・対象読者別に論理的分割
- **独立性**: 各ファイルが独立して理解可能

## 🔍 利用者向けガイド

### 情報の探し方
1. **プロジェクト全体把握**: CLAUDE.md → 概要セクション
2. **環境構築**: CLAUDE-基本設定.md
3. **設計手法**: CLAUDE-パラソル設計.md
4. **データベース**: CLAUDE-データベース設計.md
5. **API設計**: CLAUDE-API設計.md
6. **運用・GitHub**: claude-github.md

### 検索効率化
- **ファイル内検索**: 各ファイルのヘッダーで内容確認
- **横断検索**: `grep -r "キーワード" CLAUDE*.md claude*.md`
- **目次活用**: 各ファイルの目次セクションを参照

## ✅ 分割完了チェックリスト

### 分割実施時
- [ ] 元ファイルのバックアップ作成
- [ ] 新ファイル作成・内容移動
- [ ] 相互リンクの設置
- [ ] ファイルサイズ確認（2000行以下）
- [ ] 内容の整合性確認

### 品質確認
- [ ] 各ファイルが独立して理解可能
- [ ] 対象読者に適した内容構成
- [ ] 検索・ナビゲーションの効率性
- [ ] メンテナンス性の向上

---

**更新日**: 2025-10-13
**管理者**: Claude Code開発チーム
**次回レビュー**: CLAUDE.mdが1800行到達時