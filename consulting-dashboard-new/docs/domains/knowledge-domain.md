# ナレッジドメイン（Knowledge Domain）

## ドメイン概要
ナレッジドメインは、コンサルティングファームの知識・ノウハウの蓄積、共有、活用を担当する境界づけられたコンテキストです。

## ユビキタス言語定義

### 基本型定義
```
UUID: 一意識別子（36文字）
STRING_20: 最大20文字の文字列
STRING_50: 最大50文字の文字列
STRING_100: 最大100文字の文字列
STRING_255: 最大255文字の文字列
STRING_500: 最大500文字の文字列
TEXT: 長文テキスト（制限なし）
MARKDOWN: Markdown形式のテキスト
URL: URL形式（RFC3986準拠）
DATE: 日付（YYYY-MM-DD形式）
TIMESTAMP: 日時（ISO8601形式）
INTEGER: 整数
DECIMAL: 小数点数値
BOOLEAN: 真偽値（true/false）
JSON: JSON形式のデータ
ENUM: 列挙型
```

## エンティティ（Entities）

### ナレッジ記事（KnowledgeArticle）
知識やノウハウを記録した記事を表現するエンティティ

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| 記事ID | UUID | ○ | 記事の一意識別子 |
| タイトル | STRING_255 | ○ | 記事のタイトル |
| 本文 | MARKDOWN | ○ | 記事の内容 |
| 要約 | TEXT | - | 記事の要約 |
| カテゴリ | ナレッジカテゴリ | ○ | 記事の分類 |
| タグ | JSON | - | 関連タグ |
| 作成者ID | UUID | ○ | 記事作成者 |
| ステータス | 記事ステータス | ○ | 公開状態 |
| 公開日 | DATE | - | 公開日 |
| 最終更新者ID | UUID | ○ | 最終更新者 |
| 閲覧数 | INTEGER | ○ | 閲覧回数 |
| 評価 | DECIMAL | - | 平均評価点 |
| 作成日時 | TIMESTAMP | ○ | レコード作成日時 |
| 更新日時 | TIMESTAMP | ○ | 最終更新日時 |

#### ビジネスルール
- 公開（publish）：記事を公開する
- アーカイブ（archive）：記事をアーカイブ化
- 評価更新（updateRating）：評価を更新
- 閲覧数増加（incrementViews）：閲覧数を増やす

### テンプレート（Template）
再利用可能なドキュメントテンプレート

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| テンプレートID | UUID | ○ | テンプレートの一意識別子 |
| テンプレート名 | STRING_100 | ○ | テンプレートの名称 |
| 説明 | TEXT | ○ | テンプレートの説明 |
| テンプレート種別 | テンプレートタイプ | ○ | テンプレートの種類 |
| コンテンツ | MARKDOWN | ○ | テンプレート内容 |
| 変数定義 | JSON | - | 変数プレースホルダー |
| カテゴリ | STRING_50 | ○ | テンプレートカテゴリ |
| 使用回数 | INTEGER | ○ | 使用された回数 |
| 作成者ID | UUID | ○ | テンプレート作成者 |
| 公開範囲 | 公開範囲 | ○ | アクセス可能範囲 |
| 作成日時 | TIMESTAMP | ○ | レコード作成日時 |
| 更新日時 | TIMESTAMP | ○ | 最終更新日時 |

### FAQ（FrequentlyAskedQuestion）
よくある質問と回答

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| FAQ_ID | UUID | ○ | FAQの一意識別子 |
| 質問 | TEXT | ○ | 質問内容 |
| 回答 | MARKDOWN | ○ | 回答内容 |
| カテゴリ | FAQカテゴリ | ○ | FAQの分類 |
| タグ | JSON | - | 関連タグ |
| 参照回数 | INTEGER | ○ | 参照された回数 |
| 有用度 | INTEGER | ○ | 有用度評価 |
| 公開状態 | BOOLEAN | ○ | 公開フラグ |
| 作成者ID | UUID | ○ | FAQ作成者 |
| 作成日時 | TIMESTAMP | ○ | レコード作成日時 |
| 更新日時 | TIMESTAMP | ○ | 最終更新日時 |

### エキスパート（Expert）
専門知識を持つ人材情報

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| エキスパートID | UUID | ○ | エキスパートの一意識別子 |
| ユーザーID | UUID | ○ | エキスパートのユーザーID |
| 専門分野 | JSON | ○ | 専門分野リスト |
| プロフィール | TEXT | ○ | プロフィール説明 |
| 経験年数 | INTEGER | ○ | 専門分野の経験年数 |
| 資格認定 | JSON | - | 保有資格・認定 |
| 貢献ポイント | INTEGER | ○ | ナレッジ貢献度 |
| 回答数 | INTEGER | ○ | 質問への回答数 |
| 評価 | DECIMAL | - | 平均評価点 |
| ステータス | エキスパートステータス | ○ | 活動状態 |
| 作成日時 | TIMESTAMP | ○ | レコード作成日時 |

### レビュー（Review）
ナレッジコンテンツへのレビュー

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| レビューID | UUID | ○ | レビューの一意識別子 |
| 対象ID | UUID | ○ | レビュー対象 |
| 対象種別 | レビュー対象 | ○ | 対象の種類 |
| レビュアーID | UUID | ○ | レビュー投稿者 |
| 評価 | INTEGER | ○ | 評価点（1-5） |
| コメント | TEXT | - | レビューコメント |
| 有用性 | BOOLEAN | ○ | 有用だったか |
| 作成日時 | TIMESTAMP | ○ | レコード作成日時 |

## 値オブジェクト（Value Objects）

### ナレッジカテゴリ（KnowledgeCategory）
```
列挙型：
- BestPractice: ベストプラクティス
- CaseStudy: ケーススタディ
- Framework: フレームワーク
- Methodology: 方法論
- Industry: 業界知識
- Technology: 技術情報
- Process: プロセス
- Policy: ポリシー
- Training: トレーニング
- Other: その他
```

### 記事ステータス（ArticleStatus）
```
列挙型：
- Draft: 下書き
- Review: レビュー中
- Published: 公開
- Archived: アーカイブ
- Deprecated: 非推奨
```

### テンプレートタイプ（TemplateType）
```
列挙型：
- Proposal: 提案書
- Report: レポート
- Presentation: プレゼンテーション
- Analysis: 分析ドキュメント
- Contract: 契約書
- Specification: 仕様書
- Manual: マニュアル
- Checklist: チェックリスト
- Other: その他
```

### FAQカテゴリ（FAQCategory）
```
列挙型：
- General: 一般
- Technical: 技術
- Process: プロセス
- Policy: ポリシー
- Tool: ツール
- Project: プロジェクト
- Other: その他
```

### 公開範囲（AccessScope）
```
列挙型：
- Public: 全体公開
- Internal: 社内のみ
- Team: チーム内
- Project: プロジェクト内
- Private: 非公開
```

### エキスパートステータス（ExpertStatus）
```
列挙型：
- Active: アクティブ
- Inactive: 非アクティブ
- OnLeave: 休暇中
- Retired: 退職
```

### レビュー対象（ReviewTarget）
```
列挙型：
- Article: 記事
- Template: テンプレート
- FAQ: FAQ
- Expert: エキスパート回答
```

### 検索クエリ（SearchQuery）
| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| キーワード | STRING_255 | ○ | 検索キーワード |
| カテゴリ | ナレッジカテゴリ | - | 絞り込みカテゴリ |
| タグ | JSON | - | フィルタータグ |
| 期間 | DATE_RANGE | - | 期間指定 |

## 集約（Aggregates）

### ナレッジ記事集約（ArticleAggregate）
- **集約ルート**: ナレッジ記事
- **含まれるエンティティ**: ナレッジ記事、レビュー
- **含まれる値オブジェクト**: ナレッジカテゴリ、記事ステータス

### テンプレート集約（TemplateAggregate）
- **集約ルート**: テンプレート
- **含まれるエンティティ**: テンプレート
- **含まれる値オブジェクト**: テンプレートタイプ、公開範囲

### エキスパート集約（ExpertAggregate）
- **集約ルート**: エキスパート
- **含まれるエンティティ**: エキスパート
- **含まれる値オブジェクト**: エキスパートステータス

## ドメインサービス

### ナレッジ管理サービス（KnowledgeManagementService）
ナレッジ記事の作成・管理

**提供機能**:
- 記事作成（createArticle）：新規記事を作成
- 記事更新（updateArticle）：記事を更新
- 記事公開（publishArticle）：記事を公開
- アーカイブ（archiveArticle）：記事をアーカイブ

### 検索サービス（SearchService）
ナレッジの検索・推薦

**提供機能**:
- 全文検索（fullTextSearch）：キーワード検索
- 類似検索（similaritySearch）：類似コンテンツ検索
- タグ検索（tagSearch）：タグで絞り込み
- 推薦取得（getRecommendations）：関連コンテンツ推薦

### テンプレートサービス（TemplateService）
テンプレートの管理・利用

**提供機能**:
- テンプレート作成（createTemplate）：新規テンプレート作成
- テンプレート適用（applyTemplate）：テンプレートを適用
- 変数置換（replaceVariables）：変数を置換
- バージョン管理（manageVersion）：バージョン管理

### エキスパートサービス（ExpertService）
エキスパートのマッチング・評価

**提供機能**:
- エキスパート検索（findExpert）：専門家を検索
- 質問割当（assignQuestion）：質問を割り当て
- 評価更新（updateRating）：評価を更新
- 貢献度計算（calculateContribution）：貢献度を計算

## ドメインイベント

### 記事公開イベント（ArticlePublished）
| 属性名 | 型 | 説明 |
|--------|-----|------|
| 記事ID | UUID | 公開された記事 |
| タイトル | STRING_255 | 記事タイトル |
| 作成者ID | UUID | 記事作成者 |
| カテゴリ | ナレッジカテゴリ | 記事カテゴリ |
| 発生日時 | TIMESTAMP | イベント発生日時 |

### テンプレート使用イベント（TemplateUsed）
| 属性名 | 型 | 説明 |
|--------|-----|------|
| テンプレートID | UUID | 使用されたテンプレート |
| 使用者ID | UUID | テンプレート使用者 |
| プロジェクトID | UUID | 使用プロジェクト |
| 発生日時 | TIMESTAMP | イベント発生日時 |

### エキスパート回答イベント（ExpertAnswered）
| 属性名 | 型 | 説明 |
|--------|-----|------|
| エキスパートID | UUID | 回答したエキスパート |
| 質問ID | UUID | 回答した質問 |
| 回答内容 | TEXT | 回答の要約 |
| 発生日時 | TIMESTAMP | イベント発生日時 |

## ビジネスルール

### ナレッジ管理ルール
1. **品質管理**: 公開前にレビュー必須
2. **バージョン管理**: 重要な変更はバージョン更新
3. **アクセス制御**: カテゴリと役割で制限
4. **保持期間**: 最終参照から2年
5. **非推奨管理**: 古いコンテンツは非推奨マーク

### 検索・推薦ルール
1. **関連度算出**: キーワード、タグ、閲覧履歴
2. **パーソナライズ**: ユーザーの専門分野を考慮
3. **新着優先**: 最新情報を上位表示
4. **人気度考慮**: 閲覧数と評価を加味
5. **キャッシュ**: 検索結果は15分キャッシュ

### テンプレートルール
1. **変数定義**: 必須変数とオプション変数
2. **バリデーション**: 変数の型チェック
3. **バージョン互換**: 下位互換性保証
4. **使用追跡**: テンプレート使用履歴保存
5. **アクセス制限**: テンプレート毎に権限設定

### エキスパートルール
1. **専門分野認定**: 3つまでの専門分野
2. **活動維持**: 6ヶ月間非活動でステータス変更
3. **評価闾値**: 平均評価3.0未満で警告
4. **回答品質**: 最低100文字以上
5. **貢献ポイント**: 回答、記事作成で加点

## リポジトリインターフェース

### ナレッジ記事リポジトリ（ArticleRepository）
**必須メソッド**:
- IDで検索（findById）: UUID → ナレッジ記事
- カテゴリで検索（findByCategory）: ナレッジカテゴリ → 記事リスト
- 全文検索（search）: 検索クエリ → 記事リスト
- 保存（save）: ナレッジ記事 → 成功/失敗
- 削除（delete）: UUID → 成功/失敗

### テンプレートリポジトリ（TemplateRepository）
**必須メソッド**:
- IDで検索（findById）: UUID → テンプレート
- 種別で検索（findByType）: テンプレートタイプ → テンプレートリスト
- 保存（save）: テンプレート → 成功/失敗
- 削除（delete）: UUID → 成功/失敗