# プロジェクトドメイン（Project Domain）

## ドメイン概要
プロジェクトドメインは、コンサルティングプロジェクトの計画・実行・監視を担当する境界づけられたコンテキストです。

## ユビキタス言語定義

### 基本型定義
```
UUID: 一意識別子（36文字）
STRING_10: 最大10文字の文字列
STRING_20: 最大20文字の文字列
STRING_50: 最大50文字の文字列
STRING_100: 最大100文字の文字列
STRING_255: 最大255文字の文字列
TEXT: 長文テキスト（制限なし）
DATE: 日付（YYYY-MM-DD形式）
TIMESTAMP: 日時（ISO8601形式）
DECIMAL: 小数点数値
INTEGER: 整数
PERCENTAGE: パーセンテージ（0-100）
MONEY: 金額（通貨単位付き）
BOOLEAN: 真偽値（true/false）
```

## エンティティ（Entities）

### プロジェクト（Project）
コンサルティング案件を表現する中核エンティティ

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| プロジェクトID | UUID | ○ | プロジェクトの一意識別子 |
| プロジェクトコード | STRING_20 | ○ | プロジェクト管理番号 |
| プロジェクト名 | STRING_100 | ○ | プロジェクトの正式名称 |
| 概要説明 | TEXT | ○ | プロジェクトの概要 |
| クライアントID | UUID | ○ | 発注元クライアント |
| ステータス | プロジェクトステータス | ○ | 現在の状態 |
| 開始日 | DATE | ○ | プロジェクト開始日 |
| 終了予定日 | DATE | ○ | 完了予定日 |
| 実終了日 | DATE | - | 実際の完了日 |
| 予算総額 | MONEY | ○ | プロジェクト予算 |
| 契約形態 | 契約形態種別 | ○ | 請負/準委任など |
| 優先度 | 優先度レベル | ○ | プロジェクトの重要度 |
| 作成日時 | TIMESTAMP | ○ | レコード作成日時 |
| 更新日時 | TIMESTAMP | ○ | 最終更新日時 |

#### ビジネスルール
- ステータス変更（changeStatus）：プロジェクトの状態を遷移
- 予算承認（approveBudget）：予算を承認する
- 完了確認（complete）：プロジェクトを完了させる
- リスク評価（assessRisk）：リスクレベルを評価

### タスク（Task）
プロジェクト内の作業単位を表現するエンティティ

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| タスクID | UUID | ○ | タスクの一意識別子 |
| タスクコード | STRING_20 | ○ | タスク管理番号 |
| タスク名 | STRING_100 | ○ | タスクの名称 |
| 詳細説明 | TEXT | - | タスクの詳細内容 |
| プロジェクトID | UUID | ○ | 所属プロジェクト |
| 親タスクID | UUID | - | 親タスク（階層構造） |
| 担当者ID | UUID | ○ | 主担当者 |
| ステータス | タスクステータス | ○ | 現在の状態 |
| 優先度 | 優先度レベル | ○ | タスクの重要度 |
| 開始予定日 | DATE | ○ | 作業開始予定日 |
| 完了予定日 | DATE | ○ | 作業完了予定日 |
| 実開始日 | DATE | - | 実際の開始日 |
| 実完了日 | DATE | - | 実際の完了日 |
| 見積工数 | DECIMAL | ○ | 予定作業時間（時間） |
| 実績工数 | DECIMAL | - | 実際の作業時間 |
| 進捗率 | PERCENTAGE | ○ | 完了度合い |

### マイルストーン（Milestone）
プロジェクトの重要な節目を表現するエンティティ

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| マイルストーンID | UUID | ○ | 一意識別子 |
| プロジェクトID | UUID | ○ | 所属プロジェクト |
| マイルストーン名 | STRING_100 | ○ | 節目の名称 |
| 達成基準 | TEXT | ○ | 完了条件の定義 |
| 予定日 | DATE | ○ | 達成予定日 |
| 実績日 | DATE | - | 実際の達成日 |
| ステータス | マイルストーンステータス | ○ | 達成状況 |
| 承認者ID | UUID | ○ | 承認責任者 |
| 承認日時 | TIMESTAMP | - | 承認された日時 |

### 成果物（Deliverable）
プロジェクトで作成・納品する成果物

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| 成果物ID | UUID | ○ | 一意識別子 |
| プロジェクトID | UUID | ○ | 所属プロジェクト |
| 成果物名 | STRING_100 | ○ | 成果物の名称 |
| 種別 | 成果物種別 | ○ | ドキュメント/システム等 |
| 説明 | TEXT | ○ | 成果物の説明 |
| 納期 | DATE | ○ | 納品予定日 |
| 納品日 | DATE | - | 実際の納品日 |
| ステータス | 成果物ステータス | ○ | 作成状況 |
| バージョン | STRING_10 | ○ | バージョン番号 |
| ファイルパス | STRING_255 | - | 保管場所 |
| レビュー状態 | レビュー状態 | ○ | レビューの進捗 |

### プロジェクトメンバー（ProjectMember）
プロジェクトに参画するメンバー

| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| メンバーID | UUID | ○ | 一意識別子 |
| プロジェクトID | UUID | ○ | 所属プロジェクト |
| ユーザーID | UUID | ○ | メンバーのユーザーID |
| 役割 | メンバー役割 | ○ | プロジェクト内での役割 |
| 参画開始日 | DATE | ○ | アサイン開始日 |
| 参画終了日 | DATE | - | アサイン終了日 |
| 稼働率 | PERCENTAGE | ○ | プロジェクトへの稼働割合 |
| 単価 | MONEY | - | 時間単価 |
| 承認権限 | BOOLEAN | ○ | 承認可否フラグ |

## 値オブジェクト（Value Objects）

### プロジェクトステータス（ProjectStatus）
```
列挙型：
- Planning: 計画中
- InProgress: 進行中
- OnHold: 一時停止
- Completed: 完了
- Cancelled: 中止
- Archived: アーカイブ済
```

### タスクステータス（TaskStatus）
```
列挙型：
- NotStarted: 未着手
- InProgress: 作業中
- Reviewing: レビュー中
- Completed: 完了
- Cancelled: 中止
- Blocked: ブロック中
```

### 優先度レベル（PriorityLevel）
```
列挙型：
- Critical: 緊急
- High: 高
- Medium: 中
- Low: 低
- None: なし
```

### 契約形態種別（ContractType）
```
列挙型：
- FixedPrice: 請負契約
- TimeAndMaterial: 準委任契約
- Retainer: 顧問契約
- Subscription: サブスクリプション
- Other: その他
```

### メンバー役割（MemberRole）
```
列挙型：
- ProjectManager: プロジェクトマネージャー
- LeadConsultant: リードコンサルタント
- Consultant: コンサルタント
- Analyst: アナリスト
- Expert: 専門家
- Observer: オブザーバー
```

### 成果物種別（DeliverableType）
```
列挙型：
- Document: ドキュメント
- Presentation: プレゼンテーション
- Report: レポート
- System: システム
- Data: データ
- Model: モデル
- Other: その他
```

### プロジェクト期間（ProjectDuration）
| 属性名 | 型 | 必須 | 説明 |
|--------|-----|------|------|
| 開始日 | DATE | ○ | 期間の開始日 |
| 終了日 | DATE | ○ | 期間の終了日 |

#### 制約
- 開始日は終了日より前
- 期間は最低1日、最大3年

## 集約（Aggregates）

### プロジェクト集約（ProjectAggregate）
- **集約ルート**: プロジェクト
- **含まれるエンティティ**: プロジェクト、タスク、マイルストーン、成果物、プロジェクトメンバー
- **含まれる値オブジェクト**: プロジェクトステータス、優先度レベル、契約形態種別

### タスク集約（TaskAggregate）
- **集約ルート**: タスク
- **含まれるエンティティ**: タスク（親子階層）
- **含まれる値オブジェクト**: タスクステータス、優先度レベル

## ドメインサービス

### プロジェクト管理サービス（ProjectManagementService）
プロジェクトの全体管理を担当

**提供機能**:
- プロジェクト作成（createProject）：新規プロジェクトを立ち上げ
- ステータス更新（updateStatus）：プロジェクトの状態を変更
- 進捗計算（calculateProgress）：全体の進捗率を算出
- リスク評価（evaluateRisks）：プロジェクトのリスクを評価

### タスク管理サービス（TaskManagementService）
タスクの割当と進捗管理を担当

**提供機能**:
- タスク割当（assignTask）：メンバーにタスクを割り当て
- 依存関係設定（setDependencies）：タスク間の依存を定義
- クリティカルパス計算（calculateCriticalPath）：クリティカルパスを特定
- 工数集計（aggregateEffort）：タスクの工数を集計

### 成果物管理サービス（DeliverableService）
成果物の作成とレビューを管理

**提供機能**:
- 成果物登録（registerDeliverable）：成果物を登録
- レビュー依頼（requestReview）：レビューを依頼
- 承認処理（approve）：成果物を承認
- バージョン管理（manageVersion）：バージョンを管理

## ドメインイベント

### プロジェクト開始イベント（ProjectStarted）
| 属性名 | 型 | 説明 |
|--------|-----|------|
| プロジェクトID | UUID | 開始されたプロジェクト |
| プロジェクト名 | STRING_100 | プロジェクト名 |
| 開始日 | DATE | 開始日 |
| PM_ID | UUID | プロジェクトマネージャー |
| 発生日時 | TIMESTAMP | イベント発生日時 |

### タスク完了イベント（TaskCompleted）
| 属性名 | 型 | 説明 |
|--------|-----|------|
| タスクID | UUID | 完了したタスク |
| プロジェクトID | UUID | 所属プロジェクト |
| 完了者ID | UUID | 完了処理実行者 |
| 実績工数 | DECIMAL | 実際にかかった工数 |
| 発生日時 | TIMESTAMP | イベント発生日時 |

### マイルストーン達成イベント（MilestoneAchieved）
| 属性名 | 型 | 説明 |
|--------|-----|------|
| マイルストーンID | UUID | 達成されたマイルストーン |
| プロジェクトID | UUID | 所属プロジェクト |
| 達成日 | DATE | 実際の達成日 |
| 承認者ID | UUID | 承認した人 |
| 発生日時 | TIMESTAMP | イベント発生日時 |

## ビジネスルール

### プロジェクト管理ルール
1. **プロジェクトコード一意性**: プロジェクトコードは組織内で一意
2. **予算超過警告**: 実績が予算の80%を超えたら警告
3. **期間制約**: プロジェクト期間は最低1週間、最大3年
4. **PM必須**: 各プロジェクトには必ず1名のPMが必要
5. **ステータス遷移**: Planningから直接Completedへは遷移不可

### タスク管理ルール
1. **階層深度制限**: タスクの階層は最大5階層まで
2. **工数上限**: 1タスクの見積工数は最大160時間
3. **担当者必須**: 各タスクには必ず担当者を設定
4. **進捗更新**: 進捗率は10%単位で更新
5. **完了条件**: 子タスクが全て完了しないと親タスクは完了不可

### 成果物管理ルール
1. **レビュー必須**: 全ての成果物はレビュー承認が必要
2. **バージョン管理**: 更新時は必ずバージョンを上げる
3. **納期遵守**: 納期3日前に未完了なら警告
4. **ファイルサイズ**: 1ファイル最大100MBまで
5. **アクセス制御**: プロジェクトメンバーのみアクセス可能

### メンバー管理ルール
1. **稼働率上限**: 1人の合計稼働率は120%まで
2. **最小稼働率**: プロジェクト参画は最低20%から
3. **役割制限**: 1プロジェクトでPMは1名のみ
4. **承認権限**: PMとリードコンサルタントのみ承認可能
5. **離任手続き**: タスク完了後のみ離任可能

## リポジトリインターフェース

### プロジェクトリポジトリ（ProjectRepository）
**必須メソッド**:
- IDで検索（findById）: UUID → プロジェクト
- コードで検索（findByCode）: STRING_20 → プロジェクト
- ステータスで検索（findByStatus）: プロジェクトステータス → プロジェクトリスト
- 保存（save）: プロジェクト → 成功/失敗
- 削除（delete）: UUID → 成功/失敗

### タスクリポジトリ（TaskRepository）
**必須メソッド**:
- IDで検索（findById）: UUID → タスク
- プロジェクトIDで検索（findByProjectId）: UUID → タスクリスト
- 担当者IDで検索（findByAssigneeId）: UUID → タスクリスト
- 保存（save）: タスク → 成功/失敗
- 一括更新（bulkUpdate）: タスクリスト → 成功/失敗