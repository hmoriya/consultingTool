# ユースケース: 収益データを記録する

## 基本情報
- **ユースケースID**: UC-ROS-001-001
- **アクター**: 財務担当者、経理担当者、プロジェクトマネージャー、エグゼクティブ
- **概要**: プロジェクトやサービスから発生する収益データを正確に記録し、収益追跡システムに登録する

## 事前条件
- 収益記録権限を持つユーザーがログインしている
- プロジェクト・契約情報が登録されている
- 収益データの基準・分類方法が定義されている
- 請求書・契約書等の根拠資料が準備されている

## 事後条件
### 成功時
- 収益データが正確にシステムに記録されている
- 収益の分類・配分が適切に設定されている
- 関連するプロジェクト・契約との紐付けが完了している
- 収益記録の履歴・監査証跡が保存されている

### 失敗時
- 記録エラーの原因が特定・ログに記録されている
- 部分的な入力データが一時保存されている
- 必要な修正・追加情報が明確化されている

## 基本フロー
1. ユーザーが収益記録画面にアクセスする
2. システムが記録可能なプロジェクト・契約の一覧を表示する
3. ユーザーが対象プロジェクト・契約・収益種別を選択する
4. システムが関連する収益項目・テンプレート・過去実績を表示する
5. ユーザーが収益金額・発生日・詳細情報・根拠資料を入力する
6. システムが入力データの妥当性・整合性・承認要否を検証する
7. システムが収益の分類・配分・税務処理を自動算出する
8. ユーザーが記録内容を確認し、必要に応じて調整・承認依頼する

## 代替フロー
### 代替フロー1: 一括収益データ登録
- 5a. 大量収益データを一括登録する場合
  - 5a1. ユーザーがExcel・CSVファイルをアップロード
  - 5a2. システムがファイル形式・データ形式を検証
  - 5a3. データの妥当性チェック・重複確認を実行
  - 5a4. 基本フロー6に戻る

### 代替フロー2: 継続収益の自動記録設定
- 3a. 継続的な収益（月額料金等）を設定する場合
  - 3a1. ユーザーが継続収益パターン・自動記録ルールを設定
  - 3a2. システムが自動記録スケジュール・条件を確認
  - 3a3. 自動記録の開始・通知設定を完了
  - 3a4. 基本フロー8に戻る

### 代替フロー3: 為替レート・多通貨対応記録
- 5a. 外貨収益を記録する場合
  - 5a1. ユーザーが外貨金額・通貨種別・為替レートを入力
  - 5a2. システムが当日レート・履歴レートを参照・提案
  - 5a3. 円換算額・為替差損益を自動算出
  - 5a4. 基本フロー6に戻る

## 例外フロー
### 例外1: データ整合性エラー
- 6a. 収益データに矛盾・不整合が検出された場合
  - 6a1. システムが具体的なエラー箇所・修正方法を表示
  - 6a2. 関連する契約・プロジェクト情報との照合を実行
  - 6a3. 修正推奨値・類似事例を提示
  - 6a4. 基本フロー5から修正された入力を受付

### 例外2: 承認権限・プロセス問題
- 7a. 高額収益で承認が必要な場合
  - 7a1. システムが承認必要金額・承認者・プロセスを確認
  - 7a2. 承認依頼の自動送信・通知を実行
  - 7a3. 承認待ち状態での一時保存・進捗管理を開始
  - 7a4. 承認完了後、基本フロー8を実行

### 例外3: システム・外部連携エラー
- 7a. 税務システム・会計システムとの連携でエラーが発生した場合
  - 7a1. システムが連携エラーの詳細・影響範囲を分析
  - 7a2. 手動処理・後続処理の選択肢を提示
  - 7a3. エラー修復・再連携の実行を管理
  - 7a4. 連携完了後、基本フロー8を完了

## 特別要件
### データ精度・信頼性要件
- 正確性：収益データの100%正確性・検証可能性・監査対応・法的準拠・信頼性・確実性
- 完全性：全収益源・項目・分類・期間・根拠の漏れなき記録・管理・保全・活用・価値
- 整合性：契約・請求・入金・会計処理との完全整合・連携・同期・統一・一貫・信頼
- 時効性：リアルタイム・即時・最新・迅速・適時・効率的・価値・競争力・機会・成果

### セキュリティ・コンプライアンス要件
- 機密性：収益データの厳格管理・暗号化・アクセス制御・監査・保護・安全・信頼・価値
- 可用性：24時間365日・高可用性・災害対策・バックアップ・復旧・継続・安定・信頼
- 監査性：全操作・変更・アクセスの記録・追跡・検証・透明性・説明責任・法的対応
- 法的準拠：税法・会計基準・業界規制・監査要件・報告義務への完全準拠・対応・価値

### パフォーマンス・可用性要件
- レスポンス：収益記録・検索・集計・レポート生成の高速・即時・効率・最適・価値・満足
- スループット：大量データ・同時アクセス・一括処理の高性能・拡張・安定・信頼・価値
- 可用性：ミッション・クリティカル・ダウンタイムゼロ・高可用・災害・継続・価値・成功
- 拡張性：事業成長・データ増加・機能拡張への柔軟・適応・発展・持続・競争力・未来

## 関連ユースケース
### 包含関係
- 収益データを検証する
- 収益分類を設定する
- 承認プロセスを実行する
- 監査証跡を記録する

### 拡張関係
- 契約情報を参照する（前提ユースケース）
- プロジェクト情報を参照する（前提ユースケース）
- 収益レポートを生成する（後続ユースケース）

### 汎化関係
- 財務データを管理する（上位概念）

## ビジネスルール
### 収益記録・分類ルール
- 発生主義：収益の発生時点・認識基準・計上タイミング・会計処理・正確・適切・価値・成果
- 分類統一：収益種別・プロジェクト・部門・サービス別の統一分類・管理・整理・活用・価値
- 根拠必須：全収益記録に対する根拠資料・証憑・承認・検証・透明・信頼・法的・価値・安全
- 承認統制：権限・金額・重要度に応じた承認プロセス・統制・管理・品質・信頼・価値・成功

### データ品質・整合性ルール
- 重複防止：同一収益の重複記録防止・検知・統制・品質・正確・信頼・価値・効率・成果
- 整合性維持：契約・請求・入金・会計との整合性維持・同期・統一・連携・信頼・価値・成功
- 変更履歴：全変更・修正・削除の履歴記録・追跡・監査・透明・説明責任・法的・価値・信頼
- 期間整合：会計期間・四半期・年度の正確な期間配分・処理・管理・報告・価値・成功・満足

### 権限・セキュリティルール
- アクセス制御：ロール・権限・部門・プロジェクト別の厳格アクセス制御・管理・保護・安全
- 承認権限：金額・重要度・影響度に応じた承認権限・統制・管理・品質・信頼・価値・成功
- 監査対応：内部監査・外部監査・税務調査への完全対応・準備・品質・信頼・法的・価値
- 機密保持：収益情報の厳格管理・暗号化・保護・安全・信頼・価値・競争力・持続・成功

## データ要件
### 入力データ
- 基本情報：収益金額・発生日・収益種別・通貨・為替レート・詳細・正確・完全・価値・信頼
- 関連情報：プロジェクト・契約・顧客・部門・担当者・分類・整理・管理・活用・価値・成果
- 根拠資料：請求書・契約書・受注書・証憑・添付・検証・監査・透明・信頼・法的・価値
- 承認情報：承認者・承認日・承認理由・コメント・履歴・統制・品質・信頼・価値・成功

### 出力データ
- 記録結果：収益ID・記録日時・ステータス・承認状況・確認・管理・追跡・価値・成果・満足
- 集計情報：日別・月別・プロジェクト別・部門別収益・分析・可視化・洞察・価値・競争力・成功
- 監査情報：記録履歴・変更履歴・承認履歴・証跡・透明・説明責任・法的・信頼・価値・安全
- 連携データ：会計システム・税務システム・BI・レポート連携・統合・効率・価値・成果・満足

## 成功指標
- 記録精度：収益記録の正確性・完全性・整合性99.9%以上・品質・信頼・価値・競争力・成功
- 処理効率：記録処理時間・承認時間・検証時間の30%短縮・効率・生産性・価値・満足・成果
- コンプライアンス：監査・税務調査・報告要件の100%準拠・法的・信頼・価値・安全・成功
- ユーザー満足：記録・承認・検索・レポート機能の満足度95%以上・価値・成功・継続・発展