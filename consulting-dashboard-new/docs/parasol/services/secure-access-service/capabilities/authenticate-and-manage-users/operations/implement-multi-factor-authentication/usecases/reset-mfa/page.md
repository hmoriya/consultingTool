# ページ定義: MFAリセット管理ページ

**バージョン**: 2.0.0
**更新日**: 2025-10-20
**対応ユースケース**: UC-MFA-04（MFAをリセットする）

## 画面の目的
認証デバイス紛失やバックアップコード枯渇時に、管理者が安全で統制されたMFAリセット処理を実行し、ユーザーのアカウント復旧を支援する包括的な管理環境を提供する。

## 利用者
- **システム管理者**: 一般ユーザーのMFAリセット実行・承認権限を持つ管理者
- **セキュリティ管理者**: 重要アカウント・一括リセットの最終承認権限を持つ管理者
- **ヘルプデスク担当**: ユーザーサポート・リセット要求受付を担当するスタッフ
- **監査担当**: MFAリセット実行状況の監視・レポート作成を担当する監査者

## 画面構成

### ヘッダー部
- 画面タイトル: 「MFAリセット管理」
- セキュリティレベル表示: 「高度セキュリティ操作」警告表示
- 実行者情報: ログイン中の管理者名・権限レベル表示
- 緊急時モードスイッチ: 緊急時一括処理モードの切り替え

### リセット要求管理セクション
- **要求一覧**: 保留中・承認待ち・実行待ちのリセット要求一覧
- **要求詳細**: 要求理由・ユーザー情報・緊急度・証明資料
- **承認ワークフロー**: 承認者・承認状況・承認履歴の表示
- **要求検索**: ユーザー名・部門・要求日・状況による絞り込み検索

### ユーザー検索・選択セクション
- **ユーザー検索フィールド**: 名前・メール・部門による柔軟な検索
- **詳細フィルタ**: MFA状況・ロール・最終ログイン日による絞り込み
- **ユーザー一覧**: 検索結果の一覧表示・MFA状況の可視化
- **ユーザー詳細**: 選択ユーザーのMFA設定・使用履歴・セキュリティ状況

### MFA状況確認セクション
- **現在の設定**: 有効化状況・認証アプリ・バックアップコード残数
- **最近の利用**: MFA認証履歴・バックアップコード使用状況
- **セキュリティイベント**: 失敗試行・異常検出・アラート履歴
- **デバイス情報**: 登録デバイス・最終利用日・信頼状況

### リセット実行セクション
- **リセット理由入力**: 詳細理由・分類・緊急度の記録
- **リセット範囲選択**: 完全リセット・部分リセット・バックアップコードのみ
- **実行確認**: 影響範囲・実行内容・取り消し不可の警告表示
- **多重承認**: 重要アカウント用の追加承認者選択・承認要求

### 一括処理セクション
- **対象選択**: 部門・ロール・条件による一括対象選択
- **一括リセット実行**: セキュリティインシデント対応・緊急時処理
- **影響分析**: 対象ユーザー数・業務影響・復旧時間予測
- **実行監視**: 一括処理進捗・成功/失敗状況・エラー詳細

### 監査・ログセクション
- **実行履歴**: 過去のリセット実行履歴・実行者・対象ユーザー
- **監査ログ**: 詳細なセキュリティログ・アクセス記録・変更履歴
- **レポート生成**: 定期レポート・セキュリティサマリー・コンプライアンス報告
- **異常検出**: 不正リセット試行・パターン分析・アラート管理

## データ表示

### 表示データ一覧
| データ項目 | 表示形式 | 更新頻度 | 説明 |
|-----------|---------|---------|------|
| リセット要求数 | 数値バッジ | リアルタイム | 保留中・承認待ち・実行待ちの要求数 |
| ユーザーMFA状況 | ステータス | リアルタイム | 有効・無効・リセット中・エラー状態 |
| バックアップコード残数 | 数値・プログレスバー | 静的 | 各ユーザーの残りバックアップコード数 |
| 最終MFA利用日時 | 日時 | 静的 | 最後にMFA認証を行った日時 |
| セキュリティアラート | アラートレベル | リアルタイム | 高・中・低のセキュリティ警告レベル |
| 実行履歴 | 履歴リスト | 実行毎 | 過去のリセット実行記録・詳細情報 |

### データの更新頻度
- **リアルタイム更新**: リセット要求状況・MFA認証状況・セキュリティアラート
- **実行毎更新**: リセット実行結果・監査ログ・ユーザー状況変更
- **定期更新**: 統計データ・レポート・コンプライアンス情報
- **イベント駆動**: セキュリティインシデント・異常検出・緊急アラート

## 入力項目

### リセット実行項目
| 入力項目 | 入力形式 | 必須 | バリデーション | 説明 |
|---------|---------|------|---------------|------|
| 対象ユーザー | 選択・検索 | ○ | 存在確認・権限確認 | リセット対象となるユーザーの選択 |
| リセット理由 | テキストエリア | ○ | 最小50文字 | 詳細なリセット理由・背景の記録 |
| リセット種別 | 選択 | ○ | 規定選択肢 | 完全・部分・バックアップコードのみ |
| 緊急度 | 選択 | ○ | 高・中・低 | ビジネス影響度に基づく緊急度設定 |
| 承認者 | 選択 | △ | 権限確認 | 重要アカウント用の追加承認者指定 |

### 検索・フィルタ項目
| 入力項目 | 入力形式 | 必須 | バリデーション | 説明 |
|---------|---------|------|---------------|------|
| ユーザー検索 | テキスト | × | 3文字以上 | 名前・メール・部門による検索 |
| MFA状況フィルタ | チェックボックス | × | - | 有効・無効・エラー等の状況絞り込み |
| 日付範囲 | 日付選択 | × | 開始≤終了 | 履歴・ログの日付範囲指定 |
| 部門フィルタ | 選択 | × | 有効部門 | 組織構造に基づく部門絞り込み |

## アクション・操作

### 主要アクション
- **MFAリセット実行**: 選択ユーザーのMFA設定完全削除・初期化
- **部分リセット**: バックアップコードのみ・認証アプリのみの選択的リセット
- **一括リセット**: 複数ユーザー・部門単位での一括MFAリセット
- **承認プロセス**: 重要アカウントリセットの多段階承認実行

### 管理・監視アクション
- **要求承認**: 保留中リセット要求の承認・却下判定
- **実行監視**: リセット処理進捗の監視・エラー対応
- **履歴確認**: 過去のリセット実行履歴・監査ログの詳細確認
- **レポート生成**: セキュリティレポート・コンプライアンス報告書の作成

### 緊急時アクション
- **緊急リセット**: セキュリティインシデント時の即座MFA無効化
- **一括無効化**: 不正アクセス検出時の組織単位MFA一時停止
- **インシデント報告**: セキュリティチームへの緊急インシデント報告
- **復旧支援**: リセット後ユーザーの迅速なMFA再設定支援

## 画面の振る舞い

### 権限別表示制御
- **システム管理者**時: 一般ユーザーリセット・部分リセット権限のみ表示
- **セキュリティ管理者**時: 全機能・一括リセット・緊急時処理の完全アクセス
- **ヘルプデスク**時: 要求受付・状況確認のみ・実行権限なし
- **監査担当**時: 履歴確認・レポート生成のみ・読み取り専用

### リアルタイム状況監視
- **実行状況監視**時: リセット処理の進捗・成功率・エラー状況のリアルタイム表示
- **セキュリティ監視**時: 異常なリセット試行・不正アクセスの即座検出・アラート
- **ユーザー状況監視**時: MFA状況変更・認証試行・バックアップコード使用の追跡
- **システム監視**時: パフォーマンス・可用性・エラー率の継続監視

### 自動化・支援機能
- **要求自動分類**時: リセット理由・緊急度の自動分析・分類提案
- **承認ルート自動選択**時: ユーザーロール・リスクレベルに基づく承認フロー自動設定
- **影響分析自動実行**時: リセット対象・影響範囲・復旧時間の自動算出
- **フォローアップ自動案内**時: リセット完了後の再設定手順・サポート情報の自動提供

## 画面遷移

### 遷移元画面
- 管理者ダッシュボード: 「MFAリセット管理」メニューから
- ユーザー管理画面: 個別ユーザーの「MFAリセット」アクションから
- セキュリティ監視画面: インシデント対応・緊急リセット要求から
- ヘルプデスク画面: ユーザーサポート・リセット要求受付から

### 遷移先画面
- リセット実行確認画面: 実行前の最終確認・警告表示
- 一括処理監視画面: 大規模リセット実行時の専用監視画面
- ユーザー詳細画面: リセット後のユーザー状況確認・再設定支援
- 監査レポート画面: 実行結果・コンプライアンス報告の詳細表示

## MFAリセット管理の専門機能

### 高度セキュリティ統制
- **多層承認**: ユーザーロール・データ機密度に基づく段階的承認プロセス
- **リアルタイム監査**: 全操作の即座ログ記録・改ざん防止・フォレンジック支援
- **不正検出**: 異常なリセットパターン・時間外操作・権限逸脱の自動検出
- **インシデント対応**: セキュリティ侵害検出時の自動対応・エスカレーション

### 業務継続性保証
- **優先度管理**: ビジネス影響度に基づく処理優先度・SLA管理
- **バッチ処理**: 大規模組織でのスケーラブルな一括処理・負荷分散
- **復旧支援**: リセット後の迅速なMFA再設定・ユーザーガイダンス
- **影響最小化**: 業務中断を最小限に抑える段階的処理・時間分散

### 運用効率化
- **自動化ワークフロー**: 承認・実行・通知の自動化・人的エラー削減
- **統合管理**: 他のIT管理システムとの連携・一元的な運用管理
- **予測分析**: リセット要求パターン・リソース需要の予測・最適化
- **効率測定**: 処理時間・成功率・ユーザー満足度の継続的測定・改善

## エラーハンドリング

### リセット実行エラー対応
- **権限不足エラー**: 実行権限確認失敗時の詳細権限情報・管理者連絡先表示
- **対象ユーザーエラー**: 無効ユーザー・削除済みアカウント時の状況説明・代替手段案内
- **システムエラー**: データベース・認証システム障害時の自動復旧・手動フォールバック
- **並行実行エラー**: 同時リセット試行・データ競合時の制御・再試行案内

### 承認プロセスエラー対応
- **承認者不在エラー**: 承認者アクセス不可時の代替承認者・エスカレーション手順
- **承認期限切れエラー**: 承認プロセス遅延時の自動キャンセル・再申請案内
- **承認矛盾エラー**: 複数承認者の判定不一致時の調整プロセス・最終判定者指定
- **承認権限エラー**: 承認者権限変更・削除時の引き継ぎ・代理承認手続き

## パフォーマンス最適化

### 大規模処理対応
- **並列処理**: 複数ユーザーリセットの並列実行・処理時間短縮
- **バッチ最適化**: 大規模一括処理の効率的なリソース利用・負荷分散
- **キューイング**: 処理要求の適切なキューイング・優先度制御
- **リソース管理**: システムリソースの動的割り当て・パフォーマンス監視

### レスポンシブ操作
- **高速検索**: ユーザー・履歴検索の高速化・インデックス最適化
- **即座フィードバック**: 操作結果の即座表示・進捗インジケーター
- **軽量表示**: 大量データの効率的表示・仮想スクロール・ページング
- **キャッシュ活用**: 頻繁アクセスデータの適切なキャッシュ・応答速度向上

この包括的なMFAリセット管理環境により、セキュリティを最大化しながら効率的なアカウント復旧を実現し、組織全体のセキュリティレベル維持と業務継続性を最高水準で両立する。
