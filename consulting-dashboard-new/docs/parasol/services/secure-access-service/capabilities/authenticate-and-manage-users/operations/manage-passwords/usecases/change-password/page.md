# ページ定義: パスワード変更フォーム

**バージョン**: 2.0.0
**更新日**: 2025-10-21
**設計方針**: 入力重視・強度リアルタイム確認

## 画面の目的
ユーザーが安全かつ直感的にパスワードを変更できる環境を提供し、リアルタイムでパスワード強度を確認しながらセキュリティポリシーに準拠したパスワードを設定する。

## 利用者
- **主要利用者**: 認証済みユーザー（パスワード変更を希望する全ユーザー）
- **副次利用者**: セキュリティ管理者（ポリシー違反監視、変更状況確認）

## 画面構成

### ヘッダー部
- **ページタイトル**: 「パスワード変更」
- **セキュリティアイコン**: パスワード保護状態の視覚表示
- **ヘルプリンク**: パスワード設定ガイドへのリンク

### メインコンテンツ部

#### セクション1: 現在パスワード確認
- **現在パスワード入力フィールド**:
  - プレースホルダー: 「現在のパスワードを入力」
  - タイプ: password（マスク表示）
  - 表示切り替えボタン: 👁️アイコンでマスク解除可能
  - バリデーション: リアルタイム検証（入力完了時）

#### セクション2: 新パスワード設定
- **新パスワード入力フィールド**:
  - プレースホルダー: 「新しいパスワードを入力」
  - タイプ: password（マスク表示）
  - 文字数カウンター: 「8文字以上 / 最大128文字」
  - リアルタイムバリデーション: 入力と同時に強度評価

- **パスワード確認フィールド**:
  - プレースホルダー: 「新しいパスワードを再入力」
  - 一致確認表示: ✅/❌ アイコンで即座確認

#### セクション3: パスワード強度表示（UC-PASS-04連携）
- **強度メーター**:
  - 視覚的プログレスバー: 弱（赤）→ 中（橙）→ 強（緑）→ 最強（青）
  - スコア表示: 「強度スコア: 75/100」
  - レベル表示: 「強いパスワード」

- **ポリシー準拠チェックリスト**:
  - ✅ 8文字以上
  - ✅ 大文字を含む
  - ✅ 数字を含む
  - ❌ 記号を含む（要改善）
  - ✅ 過去のパスワードと異なる

#### セクション4: 改善提案エリア
- **推奨事項表示**:
  - 「より安全にするために記号（!@#$%）を追加してください」
  - 「パスワード例: P@ssw0rd2024!」
  - 「よく使われる文字列は避けてください」

### アクションエリア
- **変更実行ボタン**:
  - ラベル: 「パスワードを変更する」
  - 状態: ポリシー準拠時のみ有効化
  - 色: 緑色（有効時）、グレー（無効時）

- **キャンセルボタン**:
  - ラベル: 「キャンセル」
  - 機能: 変更を破棄してダッシュボードに戻る

## データ表示

### 表示データ一覧
| データ項目 | 表示形式 | 更新頻度 | 説明 |
|-----------|---------|---------|------|
| パスワード強度スコア | 数値+プログレスバー | リアルタイム | 入力に連動して即座更新 |
| ポリシー準拠状況 | チェックリスト | リアルタイム | 各条件の達成状況を表示 |
| 改善提案 | テキスト+例示 | リアルタイム | 不足要件に基づく具体提案 |
| パスワード変更履歴 | 最終変更日時 | ページロード時 | 「前回変更: 2024-10-15」 |

## 入力項目

### フォーム一覧
| 入力項目 | 入力形式 | 必須 | バリデーション | 説明 |
|---------|---------|------|---------------|------|
| 現在パスワード | password | ○ | サーバー検証 | 認証用 |
| 新パスワード | password | ○ | リアルタイム強度評価 | メイン入力 |
| パスワード確認 | password | ○ | 一致確認 | タイポ防止 |

### 入力検証ルール
- **即座検証**: キー入力500ms後に強度評価実行
- **文字数制限**: 8文字以上128文字以下
- **禁止パターン**: 辞書単語、連続文字、キーボード配列
- **履歴チェック**: 過去5世代との重複禁止

## アクション・操作

### 主要アクション
- **パスワード変更実行**:
  - トリガー: 変更ボタンクリック
  - 条件: 全バリデーション通過時のみ
  - 実行後: 成功ページに遷移

- **リアルタイム強度評価**:
  - トリガー: 新パスワード入力変更
  - 応答時間: 500ms以内
  - 表示更新: 強度メーター、チェックリスト、改善提案

### 副次アクション
- **パスワード表示切り替え**: マスク解除/再適用
- **改善提案適用**: クリックで推奨パスワードを入力フィールドに適用
- **ヘルプ表示**: パスワード設定ガイドのモーダル表示

## 画面の振る舞い

### ユーザー操作への反応
- **パスワード入力時**: 即座に強度メーター更新、チェックリスト状態変更
- **ポリシー違反時**: 該当項目を赤色強調、具体的改善提案を表示
- **準拠達成時**: 変更ボタンを有効化、成功色でフィードバック
- **変更実行時**: ローディング表示、完了後に成功メッセージ

### 条件による表示変更
- **期限切れユーザー**: 緊急変更モードで警告バナー表示
- **管理者**: 追加でユーザー選択フィールド表示（代理変更時）
- **初回設定ユーザー**: 現在パスワード入力を非表示

## 画面遷移

### 遷移元画面
- **ダッシュボード**: 設定メニューからアクセス
- **プロファイル画面**: パスワード変更リンク
- **強制変更通知**: 期限切れ時の自動遷移
- **ログイン画面**: 期限切れ時のリダイレクト

### 遷移先画面
- **成功ページ**: 変更完了時（パスワード変更完了メッセージ）
- **ダッシュボード**: キャンセル時、または成功ページから
- **エラーページ**: システム障害時
- **ログイン画面**: セッション切れ時

## エラーハンドリング

### エラー表示方法
- **現在パスワード不正**: 入力フィールド下に「現在のパスワードが正しくありません」
- **ポリシー違反**: 違反項目を赤色表示、改善提案エリアに詳細説明
- **サーバーエラー**: ページ上部に「一時的なエラーが発生しました。しばらく待ってから再試行してください」
- **ネットワークエラー**: オフライン状態の表示、再接続ボタン

### 対処法ガイド
- **忘れた場合**: 「パスワードを忘れた方はこちら」リンク
- **技術的問題**: 管理者連絡先の表示
- **操作ガイド**: ステップバイステップのヘルプ

## アクセシビリティ要件

### キーボードナビゲーション
- タブ順序: 現在パスワード → 新パスワード → 確認 → 変更ボタン
- ショートカット: Enter キーで次フィールドに移動、Ctrl+Enter で実行

### スクリーンリーダー対応
- フィールドラベルの明確な関連付け
- 強度メーターの音声フィードバック「強度: 弱い」
- エラーメッセージの即座読み上げ

### 色覚障害への配慮
- 強度表示: 色だけでなく文字とアイコンで併用表示
- エラー表示: 赤色だけでなく❌アイコンも併用

## レスポンシブ対応

### デスクトップ（1024px以上）
- 2カラムレイアウト: 左側入力フォーム、右側強度表示・ガイド
- 横並び配置: 現在パスワードと新パスワードを横に配置

### タブレット（768px-1023px）
- 1カラムレイアウト: 縦積み配置
- 強度表示を入力フィールド直下に配置

### モバイル（767px以下）
- シンプル縦積み: 入力→強度表示→アクションの順序
- フィールド幅: 画面幅90%使用
- ボタンサイズ: タッチフレンドリーに大型化

## セキュリティ考慮事項

### 入力データ保護
- パスワード入力時の自動補完無効化
- メモリ上での即座クリア
- ブラウザ履歴への保存禁止

### セッション管理
- 変更完了後の自動ログアウト（セキュリティ強化オプション）
- 操作中断時のタイムアウト（30分）

---
*このページ定義は、UC-PASS-01「パスワードを変更する」と1対1対応し、パラソル設計v2.0仕様に基づくユーザビリティとセキュリティを両立しています*