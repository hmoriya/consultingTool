# ページ定義：ユーザーアカウント申請

## 画面の目的
新規メンバーまたはクライアントがシステムアクセスのためのアカウント発行を申請する画面。組織への参加希望を表明し、必要な情報を提供して承認を待つプロセスを開始する。

## 利用者
- **新規メンバー**: 組織に加わる予定のコンサルタント、エンジニア、アナリスト等の社員
- **新規クライアント**: コンサルティングサービスを受けるクライアント企業の担当者
- **外部パートナー**: 協力会社やフリーランスのコンサルタント

## 画面構成

### ヘッダー部
- アプリケーションロゴ
- 「アカウント申請」タイトル
- ログインページへのリンク（既にアカウントを持っている場合）

### 申請フォーム部

#### 申請者情報セクション
- **氏名**（姓・名を分けて入力）
  - 姓：全角20文字以内
  - 名：全角20文字以内
  - フリガナ：全角カタカナ20文字以内
- **メールアドレス**
  - 組織ドメインのメール推奨（例：@consulting-firm.com）
  - 最大100文字、RFC5322準拠
- **申請理由**
  - テキストエリア（500文字以内）
  - なぜアカウントが必要かを記述

#### 組織情報セクション
- **申請種別**（ラジオボタン）
  - 正社員
  - 派遣社員
  - 業務委託
  - クライアント
  - その他
- **所属組織**
  - クライアントの場合：クライアント企業名（100文字以内）
  - メンバーの場合：所属部署名（100文字以内）
- **役職・役割**（任意）
  - 入力フィールド（50文字以内）
  - 例：シニアコンサルタント、プロジェクトマネージャー

#### 連絡先情報セクション
- **電話番号**（任意）
  - 形式：ハイフン区切りまたは数字のみ
  - 例：090-1234-5678または09012345678
- **緊急連絡先**（任意）
  - 緊急時の連絡先名
  - 緊急連絡先電話番号

#### 利用規約・同意セクション
- **利用規約の表示**
  - スクロール可能なテキストボックス
  - 組織のセキュリティポリシー、利用規約を表示
- **同意チェックボックス**（必須）
  - 「上記の利用規約に同意します」
  - チェックしないと申請ボタンが無効

### アクションボタン部
- **申請ボタン**（プライマリボタン）
  - 全ての必須項目が入力されると有効化
  - クリックで申請を送信
- **クリアボタン**（セカンダリボタン）
  - 入力内容をすべてクリア
  - 確認ダイアログ表示後にクリア実行

### フッター部
- プライバシーポリシーへのリンク
- お問い合わせ窓口の表示
- 「既にアカウントをお持ちの方はこちら」→ログインページへのリンク

## データ表示

### 初期表示時
- 空の申請フォームを表示
- 申請種別は「正社員」が初期選択
- 全ての任意項目は空白

### バリデーション表示
- **リアルタイムバリデーション**
  - メールアドレス形式チェック
  - 文字数制限の表示（残り文字数）
  - 必須項目の未入力警告
- **エラーメッセージ**
  - 各入力フィールドの下に赤字で表示
  - 具体的なエラー内容を明記（例：「メールアドレスの形式が正しくありません」）

## 入力項目

### 必須入力
| 項目 | 形式 | バリデーション |
|------|------|---------------|
| 姓 | テキスト | 全角20文字以内、1文字以上 |
| 名 | テキスト | 全角20文字以内、1文字以上 |
| フリガナ（姓名） | テキスト | 全角カタカナ20文字以内 |
| メールアドレス | テキスト | RFC5322準拠、100文字以内、重複チェック |
| 申請理由 | テキストエリア | 500文字以内、20文字以上 |
| 申請種別 | ラジオボタン | いずれか1つ選択必須 |
| 所属組織 | テキスト | 100文字以内、1文字以上 |
| 利用規約同意 | チェックボックス | チェック必須 |

### 任意入力
| 項目 | 形式 | バリデーション |
|------|------|---------------|
| 役職・役割 | テキスト | 50文字以内 |
| 電話番号 | テキスト | 数字とハイフンのみ、10-11桁 |
| 緊急連絡先名 | テキスト | 50文字以内 |
| 緊急連絡先電話 | テキスト | 数字とハイフンのみ、10-11桁 |

## 画面の振る舞い

### 申請ボタンクリック時
1. **バリデーション実行**
   - 全ての必須項目が入力済みか確認
   - 各項目の形式が正しいか確認
   - エラーがあれば該当項目にエラーメッセージ表示

2. **確認ダイアログ表示**
   - 入力内容のサマリーを表示
   - 「この内容で申請しますか？」と確認
   - 「はい」「いいえ」ボタン

3. **申請送信**
   - ローディング表示（ボタンを無効化し、スピナー表示）
   - サーバーに申請データを送信
   - 成功：完了メッセージ表示と完了画面へ遷移
   - 失敗：エラーメッセージ表示（既に同じメールで申請済み、サーバーエラー等）

### リアルタイムバリデーション
- **メールアドレス入力時**
  - フォーカスアウト時に形式チェック
  - 既存アカウントとの重複チェック（非同期）

- **文字数カウンター**
  - テキストエリアや長文入力フィールドで残り文字数を動的表示
  - 超過時は赤字で警告

### エラーハンドリング
- **ネットワークエラー**
  - 「通信エラーが発生しました。もう一度お試しください」
  - 再送ボタン表示

- **サーバーエラー**
  - 「システムエラーが発生しました。しばらく経ってから再度お試しください」
  - エラー詳細をログに記録

- **重複申請エラー**
  - 「このメールアドレスは既に申請済みです。管理者にお問い合わせください」

## 画面遷移

### 遷移元画面
- **外部URL**: 組織の採用ページや案内メール内のリンク
- **ログインページ**: 「新規アカウント申請」リンクから

### 遷移先画面
- **申請完了画面**: 申請が正常に受理された場合
  - 「申請を受け付けました」メッセージ
  - 申請番号の表示
  - 「承認まで通常1〜2営業日かかります」の案内
  - 「確認メールを送信しました」の通知

- **ログインページ**: 既にアカウントを持っている場合

## アクセシビリティ要件
- **キーボード操作**
  - Tabキーで全てのフィールドを順次移動
  - Enterキーで申請ボタンをクリック（フォーム内で有効）

- **スクリーンリーダー対応**
  - 各入力フィールドにaria-labelを設定
  - エラーメッセージはaria-liveで即座に読み上げ
  - 必須項目にはaria-requiredを設定

- **色覚対応**
  - エラー表示は色だけでなくアイコンと文字で表現
  - 必須項目は「*（アスタリスク）」マークで明示

## レスポンシブ対応

### デスクトップ（1024px以上）
- 2カラムレイアウト
  - 左：入力フォーム
  - 右：申請ガイド、よくある質問
- フォーム幅：最大600px、中央配置

### タブレット（768px〜1023px）
- 1カラムレイアウト
- フォーム幅：画面幅の80%
- ガイド情報は折りたたみ可能なアコーディオン

### モバイル（767px以下）
- 完全な1カラム
- フォーム幅：画面幅の95%
- 入力フィールドは縦に配置
- 電話番号入力時は数値キーパッドを表示
- 固定フッターにアクションボタンを配置（常に表示）

## セキュリティ要件
- **CSRF対策**: 申請フォーム送信時にCSRFトークンを含める
- **入力サニタイゼーション**: XSS攻撃防止のため、全ての入力値をエスケープ
- **レート制限**: 同一IPアドレスからの連続申請を制限（1時間に3回まで）
- **通信暗号化**: HTTPS必須、平文通信は拒否
