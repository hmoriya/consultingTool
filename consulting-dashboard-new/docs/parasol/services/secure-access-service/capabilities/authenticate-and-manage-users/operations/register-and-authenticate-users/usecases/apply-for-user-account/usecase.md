# ユースケース: ユーザーアカウントを申請する

## 基本情報
- **ユースケースID**: UC-AUTH-01
- **アクター**: 申請者（新規ユーザー）
- **概要**: 組織に所属する新規ユーザーがセキュアアクセス環境への参加を申請し、必要な情報を提供してアカウント作成プロセスを開始する

## 事前条件
- 申請者が組織メンバーである（組織メールアドレス保有）
- 組織のアカウント申請ポリシーが設定済みである
- 申請フォームが利用可能である
- 申請者がパスワードポリシーを理解している

## 事後条件
### 成功時
- ユーザー申請が正常に登録されている（User.status = "pending"）
- 申請IDが生成され申請者に通知されている
- 管理者にアカウント申請通知が配信されている
- 申請データがセキュアに保存されている

### 失敗時
- 申請エラーが記録されている
- 申請者にエラーメッセージと修正方法が表示されている
- 不正な申請データは保存されていない

## 基本フロー
1. **申請者がアカウント申請フォームにアクセスする**
   - システムが申請フォームを表示
   - 組織ポリシーと利用規約を表示

2. **申請者が必要情報を入力する**
   - 個人情報（名、姓、メールアドレス）
   - 組織情報（所属部署、役職）
   - 申請理由とビジネス根拠
   - 希望するアクセス権限レベル

3. **システムが入力情報を検証する**
   - → UC-AUTH-03: アクセスログを記録する
   - メールアドレス形式・組織ドメイン検証
   - 重複アカウント確認
   - 申請データの完全性チェック

4. **申請者が申請内容を確認し送信する**
   - 入力内容の最終確認
   - 利用規約への同意
   - 申請送信の実行

5. **システムが申請を受理し処理を開始する**
   - User エンティティ（status: pending）の作成
   - 申請ID生成と申請者通知
   - → UC-NOTIFY-01: アカウント通知を配信する（管理者向け）

## 代替フロー
### 代替フロー1: 申請情報修正
- 3a. 入力情報に不備がある場合
  - 3a1. システムが詳細エラーメッセージを表示
  - 3a2. 修正ガイダンスと推奨値を提示
  - 3a3. 申請者が情報を修正
  - 3a4. 基本フロー3に戻る

### 代替フロー2: 重複アカウント検出
- 3b. 同一メールアドレスでの申請が検出された場合
  - 3b1. 既存アカウント情報を表示（セキュリティ配慮）
  - 3b2. アカウント統合オプションを提示
  - 3b3. パスワードリセット案内を表示
  - 3b4. 申請者が選択肢を選択

## 例外フロー
### 例外1: 組織ドメイン外申請
- *a. 組織外のメールアドレスで申請された場合
  - *a1. → UC-AUTH-03: セキュリティイベントを記録する
  - *a2. システムが申請を拒否
  - *a3. 組織管理者にセキュリティアラート配信
  - *a4. 申請者に適切なエラーメッセージ表示

### 例外2: システム障害
- *b. 申請処理中にシステム障害が発生した場合
  - *b1. 申請データの自動保存実行
  - *b2. 障害レベルに応じた復旧処理
  - *b3. 申請者に状況説明と次回アクション案内
  - *b4. 復旧後の申請継続機能提供

## 特別要件
- **性能**: 申請フォーム表示2秒以内、申請処理完了10秒以内
- **可用性**: システム稼働率99.9%以上
- **セキュリティ**: 申請データ暗号化保存、アクセスログ記録、不正申請検知
- **精度**: 組織ドメイン検証100%、重複検出100%
- **ユーザビリティ**: 直感的申請フォーム、リアルタイムバリデーション

## 関連ユースケース
- **包含**: UC-AUTH-03（アクセスログ記録）、UC-NOTIFY-01（通知配信）
- **前提**: 組織設定完了、申請ポリシー設定完了
- **後続**: UC-AUTH-02（申請承認）、UC-AUTH-03（セキュアログイン）

---
*このユースケースは パラソル設計v2.0仕様 に基づいて作成されました*
