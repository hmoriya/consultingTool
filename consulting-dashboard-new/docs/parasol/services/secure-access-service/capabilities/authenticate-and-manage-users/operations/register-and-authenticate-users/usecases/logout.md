[38;2;141;161;185m───────┬────────────────────────────────────────────────────────────────────────[0m
       [38;2;141;161;185m│ [0m[1mSTDIN[0m
[38;2;141;161;185m───────┼────────────────────────────────────────────────────────────────────────[0m
[38;2;141;161;185m   1[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m# ユースケース: ログアウトする[0m
[38;2;141;161;185m   2[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m   3[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 基本情報[0m
[38;2;141;161;185m   4[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **ユースケースID**: UC-SEC-004[0m
[38;2;141;161;185m   5[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **アクター**: ユーザー, システム[0m
[38;2;141;161;185m   6[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **概要**: ユーザーが安全にシステムからログアウトし、認証セッションを終了してセキュリティを確保する[0m
[38;2;141;161;185m   7[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m   8[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 事前条件[0m
[38;2;141;161;185m   9[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ユーザーがシステムにログインしている[0m
[38;2;141;161;185m  10[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 有効な認証セッションが存在する[0m
[38;2;141;161;185m  11[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ユーザーが認証されたページにアクセスしている[0m
[38;2;141;161;185m  12[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログアウト機能が利用可能である[0m
[38;2;141;161;185m  13[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  14[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 事後条件[0m
[38;2;141;161;185m  15[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 成功時[0m
[38;2;141;161;185m  16[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ユーザーの認証セッションが終了される[0m
[38;2;141;161;185m  17[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 認証トークンが無効化される[0m
[38;2;141;161;185m  18[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- セッションCookieが削除される[0m
[38;2;141;161;185m  19[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ユーザーがログインページにリダイレクトされる[0m
[38;2;141;161;185m  20[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログアウト成功ログが記録される[0m
[38;2;141;161;185m  21[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  22[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 失敗時[0m
[38;2;141;161;185m  23[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- セッションが適切に終了されない[0m
[38;2;141;161;185m  24[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- エラーメッセージが表示される[0m
[38;2;141;161;185m  25[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- ログアウト失敗ログが記録される[0m
[38;2;141;161;185m  26[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- セキュリティ警告が管理者に通知される[0m
[38;2;141;161;185m  27[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  28[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 基本フロー[0m
[38;2;141;161;185m  29[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m1. ユーザーがログアウトボタンまたはメニューを選択する[0m
[38;2;141;161;185m  30[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m2. システムがログアウト確認ダイアログを表示する[0m
[38;2;141;161;185m  31[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m3. ユーザーがログアウト実行を確認する[0m
[38;2;141;161;185m  32[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m4. システムが現在のセッション情報を取得する[0m
[38;2;141;161;185m  33[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m5. システムがサーバー側のセッションを無効化する[0m
[38;2;141;161;185m  34[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m6. システムが認証トークン（JWT）をブラックリストに追加する[0m
[38;2;141;161;185m  35[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m7. システムがクライアント側のセッションCookieを削除する[0m
[38;2;141;161;185m  36[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m8. システムがブラウザのセッションストレージをクリアする[0m
[38;2;141;161;185m  37[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m9. システムがログアウト成功ログを記録する[0m
[38;2;141;161;185m  38[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m10. システムがユーザーをログインページにリダイレクトする[0m
[38;2;141;161;185m  39[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m11. システムがログアウト完了メッセージを表示する[0m
[38;2;141;161;185m  40[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  41[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 代替フロー[0m
[38;2;141;161;185m  42[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 代替フロー1: 確認なしログアウト[0m
[38;2;141;161;185m  43[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 2a. システム設定で確認ダイアログが無効な場合[0m
[38;2;141;161;185m  44[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a1. 確認ダイアログをスキップする[0m
[38;2;141;161;185m  45[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a2. 基本フロー4に直接進む[0m
[38;2;141;161;185m  46[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  47[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 代替フロー2: 作業内容保存確認[0m
[38;2;141;161;185m  48[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 2a. 未保存の作業内容が検出された場合[0m
[38;2;141;161;185m  49[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a1. システムが「未保存の内容があります」を表示する[0m
[38;2;141;161;185m  50[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a2. システムが保存・破棄・キャンセルの選択肢を提示する[0m
[38;2;141;161;185m  51[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a3. ユーザーが保存を選択した場合、保存処理を実行する[0m
[38;2;141;161;185m  52[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 2a4. 保存完了後または破棄選択後、基本フロー4に進む[0m
[38;2;141;161;185m  53[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  54[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 代替フロー3: 全デバイスからのログアウト[0m
[38;2;141;161;185m  55[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 1a. ユーザーが「全デバイスからログアウト」を選択した場合[0m
[38;2;141;161;185m  56[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 1a1. システムが他のデバイス・ブラウザのセッション一覧を表示する[0m
[38;2;141;161;185m  57[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 1a2. ユーザーが全デバイスログアウトを確認する[0m
[38;2;141;161;185m  58[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 1a3. システムが当該ユーザーの全セッションを無効化する[0m
[38;2;141;161;185m  59[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 1a4. システムが他のデバイスに強制ログアウト通知を送信する[0m
[38;2;141;161;185m  60[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  61[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 代替フロー4: 自動ログアウト[0m
[38;2;141;161;185m  62[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- *a. セッションタイムアウトによる自動ログアウトの場合[0m
[38;2;141;161;185m  63[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a1. システムがタイムアウト警告を表示する[0m
[38;2;141;161;185m  64[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a2. ユーザーが応答しない場合、自動的にログアウト処理を実行する[0m
[38;2;141;161;185m  65[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a3. システムが「セッションが期限切れになりました」を表示する[0m
[38;2;141;161;185m  66[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a4. 基本フロー5-11を実行する[0m
[38;2;141;161;185m  67[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  68[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 例外フロー[0m
[38;2;141;161;185m  69[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 例外1: セッション無効化エラー[0m
[38;2;141;161;185m  70[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 5a. サーバー側セッション無効化に失敗した場合[0m
[38;2;141;161;185m  71[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 5a1. システムがエラーログを記録する[0m
[38;2;141;161;185m  72[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 5a2. システムがクライアント側のみ無効化を実行する[0m
[38;2;141;161;185m  73[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 5a3. システムが管理者にセッション無効化失敗を通知する[0m
[38;2;141;161;185m  74[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 5a4. ユーザーに部分的ログアウトの警告を表示する[0m
[38;2;141;161;185m  75[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  76[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 例外2: ネットワークエラー[0m
[38;2;141;161;185m  77[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 4a. ネットワーク接続エラーが発生した場合[0m
[38;2;141;161;185m  78[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a1. システムがクライアント側のセッション情報を削除する[0m
[38;2;141;161;185m  79[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a2. ローカルストレージとCookieをクリアする[0m
[38;2;141;161;185m  80[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a3. システムが「ネットワークエラーのためローカルログアウトしました」を表示する[0m
[38;2;141;161;185m  81[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a4. 次回ログイン時にサーバー側セッション確認を実行する[0m
[38;2;141;161;185m  82[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  83[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 例外3: システムエラー[0m
[38;2;141;161;185m  84[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- *a. ログアウト処理中にシステムエラーが発生した場合[0m
[38;2;141;161;185m  85[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a1. システムがエラーログを記録する[0m
[38;2;141;161;185m  86[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a2. 可能な範囲でセッション削除を実行する[0m
[38;2;141;161;185m  87[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a3. システムがユーザーに「ログアウト処理に問題が発生しました」を表示する[0m
[38;2;141;161;185m  88[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - *a4. セキュリティ上、ブラウザを完全に閉じることを推奨する[0m
[38;2;141;161;185m  89[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  90[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m### 例外4: 権限エラー[0m
[38;2;141;161;185m  91[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- 4a. セッション無効化の権限がない場合[0m
[38;2;141;161;185m  92[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a1. システムが権限エラーログを記録する[0m
[38;2;141;161;185m  93[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a2. システムが管理者に権限異常を通知する[0m
[38;2;141;161;185m  94[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a3. クライアント側のみログアウト処理を実行する[0m
[38;2;141;161;185m  95[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m  - 4a4. セキュリティ警告をユーザーに表示する[0m
[38;2;141;161;185m  96[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m  97[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 特別要件[0m
[38;2;141;161;185m  98[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **セキュリティ**: 全ての認証情報を確実に削除し、セッション再利用を防止[0m
[38;2;141;161;185m  99[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **パフォーマンス**: ログアウト処理は2秒以内に完了[0m
[38;2;141;161;185m 100[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **可用性**: ネットワークエラー時もクライアント側ログアウトを実行[0m
[38;2;141;161;185m 101[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **監査性**: 全てのログアウト試行を詳細ログと共に記録[0m
[38;2;141;161;185m 102[0m   [38;2;141;161;185m│[0m 
[38;2;141;161;185m 103[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m## 関連ユースケース[0m
[38;2;141;161;185m 104[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **包含**: なし[0m
[38;2;141;161;185m 105[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **拡張**: 「セッションを管理する」（管理者機能）[0m
[38;2;141;161;185m 106[0m   [38;2;141;161;185m│[0m [38;2;227;234;242m- **汎化**: なし[0m
[38;2;141;161;185m───────┴────────────────────────────────────────────────────────────────────────[0m
