# ユースケース: 異常アクセスを検知する

## 基本情報

- **ユースケースID**: UC-SEC-030
- **ユースケース名**: 異常アクセスを検知する
- **アクター**: 監査システム, セキュリティ担当者, 監査担当者, SIEM システム
- **概要**: 権限の異常な使用パターンを検知し、不正アクセスの可能性を特定する

## 事前条件

- アクセスログが継続的に収集されている
- ユーザーの正常行動パターンがベースライン化されている
- 異常検知ルールが設定されている
- アラート通知先が設定されている

## 事後条件

### 成功時
- 異常アクセスが検知される
- リスクレベルが評価される
- 関係者にアラートが送信される
- 対応推奨事項が提示される

### 失敗時
- エラーログが記録される
- 監視継続状態が維持される
- 技術者に障害通知が送信される

## 基本フロー

1. 監査システムがリアルタイムアクセス監視を実行する
2. システムがアクセスログを収集・分析する
3. システムがユーザー行動パターンを正常ベースラインと比較する
4. システムが異常パターンを検出する
5. システムがリスクレベルを評価する（低・中・高・緊急）
6. システムが異常の種類を分類する
7. システムが影響範囲を評価する
8. システムが対応優先度を決定する
9. システムが適切な関係者にアラートを送信する
10. セキュリティ担当者が異常内容を確認する
11. システムが初期対応推奨事項を提示する
12. システムが検知履歴を記録する

## 代替フロー

### 代替フロー1: 緊急度の高い異常
- 5a. 緊急レベルの異常が検出された場合
  - 5a1. システムが即座に緊急アラートを発信する
  - 5a2. システムが該当アカウントの一時停止を提案する
  - 5a3. システムがエスカレーション手順を開始する
  - 5a4. 基本フロー6に進む

### 代替フロー2: 複数の関連異常
- 4a. 複数ユーザーで関連する異常が検出された場合
  - 4a1. システムが関連性を分析する
  - 4a2. システムが攻撃キャンペーンの可能性を評価する
  - 4a3. システムが統合アラートを生成する
  - 4a4. 基本フロー5に進む

### 代替フロー3: 誤検知の可能性
- 4a. 誤検知の可能性が高い場合
  - 4a1. システムが追加検証を実行する
  - 4a2. システムが過去の類似パターンと照合する
  - 4a3. システムが確信度を調整する
  - 4a4. 基本フロー5に進む

## 例外フロー

### 例外1: ログデータ不備
- 2a. アクセスログが欠損または不完全な場合
  - 2a1. システムがログ品質を評価する
  - 2a2. システムが利用可能データで分析を継続する
  - 2a3. システムがデータ品質問題をアラート送信する
  - 2a4. 基本フロー3に進む

### 例外2: ベースライン未確立
- 3a. ユーザーの正常パターンが未確立の場合
  - 3a1. システムが学習期間不足を認識する
  - 3a2. システムが一般的なルールベース検知に切り替える
  - 3a3. システムが学習継続を通知する
  - 3a4. 基本フロー4に進む

### 例外3: システム負荷過多
- *a. システム負荷が過多で処理が困難な場合
  - *a1. システムが負荷軽減モードに切り替える
  - *a2. システムが優先度の高い検知のみ実行する
  - *a3. システムが負荷状況を管理者に通知する
  - *a4. 処理を継続（機能制限あり）

## 特別要件

### 性能要件
- リアルタイム検知: 5分以内
- アラート送信: 1分以内
- 大量ログ処理: 100万件/時間
- 応答時間: 平均2秒以内

### 精度要件
- 検知精度: 90%以上
- 誤検知率: 10%以下
- 重要な異常の見逃し率: 1%以下

### 可用性要件
- 24時間365日の監視継続
- システム稼働率: 99.99%以上
- フェイルオーバー時間: 30秒以内

## 非機能要件

### スケーラビリティ
- 増加するログ量への対応
- ユーザー数拡大への対応
- 新しい異常パターンへの適応

### セキュリティ
- 検知ロジックの秘匿性
- 監視データの暗号化
- 不正操作の防止

## 異常検知パターン

### 時間的異常
- 通常とは大幅に異なる時間帯のアクセス
- 異常に長時間の連続アクセス
- 短時間での大量アクセス

### 地理的異常
- 通常とは異なる地域からのアクセス
- 物理的に不可能な移動パターン
- 高リスク地域からのアクセス

### 行動的異常
- 通常と異なるリソースへのアクセス
- 権限を超えたアクセス試行
- 異常なデータダウンロード量

### 技術的異常
- 新しいデバイスからのアクセス
- 異常なユーザーエージェント
- 暗号化されていない通信の使用

## リスクレベル評価基準

### 緊急（Critical）
- 機密データの大量アクセス
- 管理者権限での異常操作
- 外部への大量データ転送

### 高（High）
- 権限昇格の試行
- システム設定の変更試行
- 異常な時間帯での管理操作

### 中（Medium）
- 通常パターンからの軽微な逸脱
- 新しいアクセスパターンの出現
- 一時的な異常行動

### 低（Low）
- 微細な行動変化
- 学習期間中の変動
- 設定変更に伴う一時的変化

## 関連ユースケース

- **前提**: UC-SEC-028 (権限利用状況を確認する) - ベースライン作成
- **関連**: UC-SEC-029 (不要権限を特定する) - 異常パターンとの照合
- **後続**: UC-SEC-031 (権限を是正する) - 異常検知結果に基づく対応
- **統合**: UC-SEC-032 (セキュリティインシデントを管理する) - インシデント対応連携

## 実装ノート

### 機械学習要件
- 教師なし学習による異常検知
- 時系列分析による予測
- クラスタリングによるパターン分類

### 技術的考慮事項
- リアルタイムストリーム処理
- 分散処理による性能確保
- エッジコンピューティングの活用

### 外部連携
- SIEM システムとの統合
- 脅威インテリジェンスフィードの活用
- 他組織との脅威情報共有