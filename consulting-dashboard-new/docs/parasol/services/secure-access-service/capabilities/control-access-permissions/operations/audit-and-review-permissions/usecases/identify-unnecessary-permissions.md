# ユースケース: 不要権限を特定する

## 基本情報

- **ユースケースID**: UC-SEC-029
- **ユースケース名**: 不要権限を特定する
- **アクター**: 監査担当者, システム管理者, 監査システム, HR システム
- **概要**: 利用状況分析に基づいて不要になった権限を特定し、削除候補として抽出する

## 事前条件

- 権限利用状況の分析が完了している
- 組織の権限ポリシーが定義されている
- ユーザーの職務情報が最新である
- 監査基準が設定されている

## 事後条件

### 成功時
- 不要権限リストが作成される
- 削除推奨度が設定される
- 是正計画案が生成される
- 関係者への通知が送信される

### 失敗時
- エラーメッセージが表示される
- 分析失敗の理由が記録される
- 管理者に障害通知が送信される

## 基本フロー

1. 監査担当者が不要権限特定処理を開始する
2. システムが権限利用分析結果を取得する
3. システムが組織の権限ポリシーを読み込む
4. システムが未使用期間基準を適用する（90日以上未使用）
5. システムが職務変更による不整合を検出する
6. システムが過剰権限パターンを分析する
7. システムが各権限のリスクレベルを評価する
8. システムが削除優先度を算出する
9. システムが不要権限リストを生成する
10. 監査担当者が特定結果を確認し承認する
11. システムが関係者に通知を送信する
12. システムが特定処理の履歴を記録する

## 代替フロー

### 代替フロー1: 条件付き削除
- 8a. 一部の権限で慎重な判断が必要な場合
  - 8a1. システムが条件付き削除として分類する
  - 8a2. システムが追加の確認プロセスを設定する
  - 8a3. システムが段階的削除スケジュールを提案する
  - 8a4. 基本フロー9に進む

### 代替フロー2: 緊急度の高い権限
- 7a. 高リスクの不要権限が検出された場合
  - 7a1. システムが緊急削除候補として分類する
  - 7a2. システムが即座に管理者にアラートを送信する
  - 7a3. システムが一時的な権限停止を提案する
  - 7a4. 基本フロー8に進む

### 代替フロー3: 職務関連権限の再評価
- 5a. 職務変更に伴う権限見直しが必要な場合
  - 5a1. システムが新職務に必要な権限を抽出する
  - 5a2. システムが現在権限との差分を分析する
  - 5a3. システムが過不足権限を特定する
  - 5a4. 基本フロー6に進む

## 例外フロー

### 例外1: データ不整合
- 4a. 権限データとユーザーデータに不整合がある場合
  - 4a1. システムがデータ不整合を検出する
  - 4a2. システムが整合性エラーを記録する
  - 4a3. システムが管理者に修正を依頼する
  - 4a4. ユースケース中断（データ修正後に再実行）

### 例外2: ポリシー未定義
- 3a. 適用すべき権限ポリシーが存在しない場合
  - 3a1. システムがポリシー不備を検出する
  - 3a2. システムがデフォルトポリシーの適用を確認する
  - 3a3. 監査担当者がポリシー設定を要求する
  - 3a4. ユースケース中断

### 例外3: システムエラー
- *a. 分析処理中にシステム障害が発生した場合
  - *a1. システムが処理を安全に中断する
  - *a2. システムが中間結果を保存する
  - *a3. システムが技術者にエラー通知を送信する
  - *a4. ユースケース中断

## 特別要件

### 性能要件
- 不要権限特定処理: 10分以内（1000ユーザー）
- リスク評価: 1秒以内（1権限あたり）
- 大規模組織対応: 10000ユーザーを1時間以内

### セキュリティ要件
- 削除候補権限の秘匿性保護
- 特定処理の完全な監査証跡
- 不正な権限削除の防止

### 精度要件
- 不要権限特定精度: 95%以上
- 誤検知率: 5%以下
- 見逃し率: 2%以下

## 非機能要件

### 信頼性
- 特定ロジックの透明性確保
- 削除判断根拠の明確化
- 復旧可能性の保証

### 運用性
- 自動化された定期実行
- 例外ケースの適切な処理
- 人的介入ポイントの明確化

## ビジネスルール

### 削除判断基準
- 90日以上未使用の権限は削除候補
- 職務変更から30日経過後の旧職務権限は削除対象
- 管理者権限は手動確認必須
- システム権限は自動削除禁止

### リスクレベル評価
- **高リスク**: 機密データアクセス権限
- **中リスク**: 一般業務システム権限
- **低リスク**: 参照のみの権限

### 削除優先度算出
- 未使用期間の長さ
- 権限のリスクレベル
- 職務との整合性
- 組織のセキュリティポリシー

## 関連ユースケース

- **前提**: UC-SEC-028 (権限利用状況を確認する) - 分析結果を使用
- **後続**: UC-SEC-031 (権限を是正する) - 特定結果に基づいて実行
- **関連**: UC-SEC-030 (異常アクセスを検知する) - 異常パターンと照合
- **包含**: UC-SEC-001 (ユーザーを認証する) - 監査権限の確認

## 実装ノート

### アルゴリズム要件
- 機械学習による権限利用パターン分析
- 統計的手法による異常検知
- ルールベース判定との組み合わせ

### データ要件
- 権限付与・削除履歴
- アクセスログ（詳細レベル）
- 組織構造・職務定義
- セキュリティポリシー定義

### 出力形式
- 削除推奨権限リスト（Excel、CSV）
- リスク評価レポート（PDF）
- 是正計画テンプレート
- 承認ワークフロー連携データ