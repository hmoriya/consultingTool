# ユースケース: 権限を申請する

## 基本情報

- **ユースケースID**: UC-SEC-036
- **ユースケース名**: 権限を申請する
- **アクター**: 一般ユーザー, 新規ユーザー, 異動者, プロジェクトメンバー, システム管理者
- **概要**: 業務遂行に必要な権限やロールの付与を申請し、適切な承認プロセスを経て権限取得を実現する

## 事前条件

- ユーザーがシステムにログインしている
- ユーザーアカウントが有効な状態である
- 申請対象の権限・ロールが定義済みである
- 申請者の所属・役職情報が登録されている

## 事後条件

### 成功時
- 権限申請が正常に登録される
- 承認者に申請通知が送信される
- 申請者に申請受付通知が送信される
- 申請状況が追跡可能な状態になる

### 失敗時
- エラーメッセージが表示される
- 申請内容が保持される
- 失敗理由が記録される

## 基本フロー

1. ユーザーが権限申請画面にアクセスする
2. システムが申請可能な権限・ロール一覧を表示する
3. ユーザーが申請したい権限・ロールを選択する
4. ユーザーが申請理由と業務上の必要性を入力する
5. ユーザーが希望する有効期間を設定する
6. システムが申請内容の妥当性を検証する
7. ユーザーが申請内容を確認し送信する
8. システムが承認者を自動特定する
9. システムが申請を登録し承認者に通知を送信する
10. システムが申請者に受付完了通知を送信する

## 代替フロー

### 代替フロー1: 緊急権限申請
- 3a. 緊急業務のための権限申請の場合
  - 3a1. ユーザーが緊急申請フラグを設定する
  - 3a2. システムが緊急申請の理由入力を要求する
  - 3a3. ユーザーが緊急事由と期限を詳細入力する
  - 3a4. 基本フロー4に進む

### 代替フロー2: 一時的権限申請
- 5a. プロジェクトや特定業務のための一時権限の場合
  - 5a1. ユーザーが一時権限として申請する
  - 5a2. システムが最大期間制限を表示する
  - 5a3. ユーザーが開始日と終了日を設定する
  - 5a4. 基本フロー6に進む

### 代替フロー3: 代理申請
- 1a. 上司が部下のために権限申請を行う場合
  - 1a1. 上司が代理申請モードを選択する
  - 1a2. システムが代理申請権限を確認する
  - 1a3. 上司が対象ユーザーを選択する
  - 1a4. 基本フロー2に進む

## 例外フロー

### 例外1: 申請権限不適切
- 6a. 申請した権限が申請者の職務に不適切な場合
  - 6a1. システムが不適切権限の警告を表示する
  - 6a2. システムが推奨される権限を提案する
  - 6a3. ユーザーが申請内容を修正する
  - 6a4. 基本フロー6を再実行する

### 例外2: 承認者不在
- 8a. 直属の上司が不在・不明の場合
  - 8a1. システムが代理承認者を検索する
  - 8a2. システムが組織階層から適切な承認者を特定する
  - 8a3. 基本フロー9に進む

### 例外3: 重複申請
- 9a. 同一権限の申請が既に存在する場合
  - 9a1. システムが既存申請を表示する
  - 9a2. ユーザーが既存申請のキャンセル・追加申請を選択する
  - 9a3. 選択に応じて処理を継続またはキャンセル

## 特別要件

### 性能要件
- 申請画面表示: 3秒以内
- 権限検索・フィルタリング: 2秒以内
- 申請内容検証: 5秒以内
- 申請登録・通知送信: 3秒以内

### セキュリティ要件
- 申請内容の暗号化保存
- 申請者の認証確認
- 申請操作の監査ログ記録
- 機密権限申請の特別保護

### 可用性要件
- 24時間365日の申請受付
- 99.9%以上のシステム稼働率

## 非機能要件

### 使いやすさ
- 直感的な権限選択インターフェース
- 申請理由の入力ガイダンス
- 申請状況のリアルタイム表示
- モバイル対応の申請フォーム

### 拡張性
- 新しい権限タイプへの対応
- カスタム承認フローの設定
- 大規模組織での申請管理

## ビジネスルール

### 申請対象権限の制限
- **職務関連性**: 申請者の職務に関連する権限のみ申請可能
- **階層制限**: 現在の役職レベルを超える権限は特別承認が必要
- **期間制限**: 一時権限は最大30日、長期権限は年次見直し必須
- **重複制限**: 同一権限の重複申請は原則禁止

### 申請理由の必須要件
- **業務上の必要性**: 具体的な業務内容と権限の関連性
- **使用頻度**: 権限を使用する頻度と期間
- **代替手段**: 他の方法では業務遂行が困難な理由
- **情報セキュリティ**: 機密情報アクセスの正当性

### 緊急申請の条件
- **緊急事由**: 業務継続に重大な影響がある場合のみ
- **期間限定**: 緊急権限は最大72時間、本申請が必要
- **事後承認**: 24時間以内の正式申請が必須
- **監査強化**: 緊急権限の使用状況を厳格に監査

## 関連ユースケース

- **前提**: UC-SEC-001 (ユーザーを認証する) - 申請者の認証確認
- **後続**: UC-SEC-037 (権限を承認する) - 申請内容の承認プロセス
- **関連**: UC-SEC-038 (権限を付与する) - 承認後の権限付与実行
- **包含**: UC-SEC-039 (権限を剥奪する) - 期限切れや変更時の権限取り消し

## 実装ノート

### データ要件
- 申請基本情報（申請ID、申請者、申請日時、状態）
- 申請内容（権限・ロール、期間、理由、緊急フラグ）
- 承認情報（承認者、承認ルート、期限）
- 履歴情報（状態変更履歴、コメント）

### 技術的考慮事項
- 申請フォームの動的生成
- 権限マスタとの連携
- 組織階層からの承認者自動特定
- 通知システムとの連携

### UI/UX要件
- ステップバイステップの申請ウィザード
- 権限説明の詳細表示機能
- 申請進捗の可視化
- 下書き保存・途中保存機能

### データ整合性
- 申請内容の妥当性チェック
- 重複申請の防止
- 申請状態の整合性管理
- 承認者変更時の処理

### 通知機能
- 申請受付の即座通知
- 承認者への申請通知
- 申請状況変更の通知
- 期限切れ前の事前通知

### 監査要件
- 全申請操作の詳細ログ
- 申請内容の変更履歴
- 申請理由の正当性記録
- コンプライアンス要件への対応

### モバイル対応
- レスポンシブデザインでの申請フォーム
- タッチ操作に最適化されたUI
- オフライン下書き保存機能
- プッシュ通知による状況更新

### 国際化対応
- 多言語での申請フォーム表示
- 地域別の承認ルール対応
- タイムゾーンを考慮した期間設定