# ユースケース: 権限付与完了を通知する

## 基本情報
- **ユースケースID**: UC-PERM-05
- **アクター**: 権限管理システム、申請者
- **概要**: 権限申請が承認され権限付与が完了した際に、申請者に成功通知と利用ガイダンスを提供し、権限の適切な利用開始を支援する

## 事前条件
- 権限申請が承認されている（PermissionRequest.status = "approved"）
- 権限付与処理が完了している（UserPermission.status = "active"）
- 申請者の連絡先情報が利用可能である
- 通知システムが利用可能である
- 権限利用ガイダンスが準備されている

## 事後条件
### 成功時
- 付与完了通知が申請者に配信されている
- 権限利用方法が明確に伝達されている
- セキュリティガイドラインが提供されている
- 通知配信ログが記録されている（NotificationLog.status = "sent"）
- 申請者が権限を適切に利用可能な状態になっている

### 失敗時
- 通知配信エラーが記録されている
- 代替通知手段が実行されている
- 管理者に配信失敗が通知されている
- 申請者への別途連絡手段が準備されている

## 基本フロー
1. **システムが付与完了情報を整理する**
   - 付与された権限内容・有効期限の整理
   - 利用可能機能・アクセス範囲の明確化
   - セキュリティ要件・利用制限の確認

2. **システムが通知内容を生成する**
   - → UC-NOTIFY-01: 権限付与通知を配信する
   - 付与権限の分かりやすい説明作成
   - 利用方法・手順の詳細ガイド生成

3. **システムが申請者に通知を配信する**
   - 優先通知手段（メール・チャット）での配信
   - 付与権限・利用方法の詳細提供
   - セキュリティガイドライン・注意事項の案内

4. **システムが利用開始支援を提供する**
   - 権限確認ページへの直接リンク提供
   - 利用方法のステップバイステップガイド
   - サポート窓口・問い合わせ先の提供

5. **システムが通知完了を確認する**
   - → UC-PERM-05: 付与完了通知ログを記録する
   - 申請者の通知受信確認
   - 権限利用開始状況の追跡開始

## 代替フロー
### 代替フロー1: 条件付き権限付与の通知
- 3a. 条件付きで権限が付与された場合
  - 3a1. 付与条件・制限事項の詳細説明
  - 3a2. 条件遵守の重要性・監視体制の説明
  - 3a3. 条件違反時の対応・権限停止手続きの案内
  - 3a4. 基本フロー4（利用開始支援）に進む

### 代替フロー2: 一時的権限付与の通知
- 1a. 期間限定の権限付与の場合
  - 1a1. 有効期限・自動失効日時の明示
  - 1a2. 期限延長申請の手続き・タイミング案内
  - 1a3. 期限切れ前リマインダー通知の設定
  - 1a4. 基本フロー2（通知内容生成）に戻る

## 例外フロー
### 例外1: 通知配信失敗
- *a. メール・チャット通知が失敗した場合
  - *a1. → UC-NOTIFY-01: 通知配信エラーを記録する
  - *a2. 代替通知手段（SMS・電話・郵送）の実行
  - *a3. 申請者の上司・関係者への間接通知
  - *a4. 管理者への配信失敗エスカレーション

### 例外2: 権限付与情報不整合
- *b. 付与された権限に不整合がある場合
  - *b1. 権限データベースの整合性確認・修正
  - *b2. システム管理者への緊急通知
  - *b3. 申請者への一時的通知保留・状況説明
  - *b4. 整合性確認後、基本フロー1（情報整理）に復帰

### 例外3: システム障害・ネットワーク障害
- *c. 通知システム障害が発生した場合
  - *c1. 障害検知・ログ記録・監視アラート送信
  - *c2. オフライン通知キューへの保存
  - *c3. 復旧後の自動通知配信・遅延説明
  - *c4. 緊急時手動通知手続きの実行

## 特別要件
- **性能**: 付与完了通知配信3秒以内、利用ガイド生成2秒以内
- **可用性**: 通知システム稼働率99.8%以上
- **セキュリティ**: 付与権限情報の適切な管理、プライバシー保護
- **精度**: 権限内容の正確な伝達、利用ガイドの実用性100%
- **ユーザビリティ**: 分かりやすい権限説明、明確な利用手順

## 関連ユースケース
- **包含**: UC-NOTIFY-01（通知配信）、UC-PERM-05（ログ記録）
- **前提**: UC-PERM-04（承認処理）での承認判断必須
- **後続**: 権限利用開始、定期的な利用状況確認

---
*このユースケースは パラソル設計v2.0仕様 に基づいて作成されました*
