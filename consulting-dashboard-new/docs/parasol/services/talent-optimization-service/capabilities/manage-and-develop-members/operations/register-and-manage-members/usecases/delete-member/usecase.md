# ユースケース: メンバーアカウントを削除する

## 基本情報
- **ユースケースID**: UC-TALENT-04
- **アクター**: リソースマネージャー、HR管理者、システム管理者、コンプライアンス担当者
- **概要**: 退職や異動等によりメンバーアカウントを安全に削除し、データ保護とコンプライアンス要件を満たしながら組織データベースを適切に維持する

## 事前条件
- 削除対象メンバーが特定されている（Member.id 確認済み）
- 削除権限が確認されている（高権限操作）
- 削除理由と承認が記録されている
- データ保持ポリシーが確認されている
- 関連データの取り扱い方針が決定されている

## 事後条件
### 成功時
- メンバーアカウントが削除されている（Member.status = "deleted" または論理削除）
- 関連アクセス権限が無効化されている
- 必要データがアーカイブされている
- 法的要件に基づくデータ削除が実行されている
- 削除監査ログが記録されている

### 失敗時
- 削除失敗の詳細理由がログに記録されている
- データ依存関係エラーの詳細が特定されている
- 法的制約や保持要件違反が明確化されている
- 削除可能条件のガイダンスが提供されている

## 基本フロー
1. **アクターがメンバーアカウント削除プロセスを開始する**
   - 削除対象メンバーの確認・削除理由の記録
   - 影響範囲の分析・関係者への通知準備

2. **システムが削除前検証と影響分析を実行する**
   - → UC-AUTH-02: メンバー削除権限を検証する
   - データ依存関係の分析・法的制約の確認
   - アーカイブ要件と削除スコープの決定

3. **システムが段階的なアカウント無効化を実行する**
   - アクセス権限の即座無効化・セッションの強制終了
   - プロジェクト配置からの除外・チーム構成の調整

4. **システムがデータアーカイブと削除を実行する**
   - 法定保持データのアーカイブ・個人情報の安全削除
   - 関連レコードの整合性保持・参照整合性の維持

5. **システムが削除完了と監査記録を完了する**
   - 削除処理の最終確認・アーカイブデータの検証
   - → UC-NOTIFY-01: アカウント削除通知を配信する
   - → UC-AUTH-03: アカウント削除監査ログを記録する

## 代替フロー
### 代替フロー1: 論理削除（ソフトデリート）
- 4a. 完全削除ではなく論理削除が適切な場合
  - 4a1. ステータス変更による論理削除・データ保持
  - 4a2. アクセス制御による非表示化・検索除外
  - 4a3. 基本フロー5（完了・監査記録）に進む

### 代替フロー2: 段階的削除
- 4b. 大量関連データで段階的削除が必要な場合
  - 4b1. 優先度別削除・重要データ先行処理
  - 4b2. バッチ処理・進捗監視・エラー対応
  - 4b3. 基本フロー5に戻る

## 例外フロー
### 例外1: データ依存関係エラー
- *a. 他システムとのデータ依存関係で削除が阻害された場合
  - *a1. → UC-AUTH-03: データ依存関係エラーログを記録する
  - *a2. 依存関係の詳細分析・解決方法の提案
  - *a3. 依存関係解決後、基本フロー4に復帰

### 例外2: 法的制約違反
- *b. 法的要件やコンプライアンス制約に違反する場合
  - *b1. 制約詳細の記録・法務部門への相談
  - *b2. 代替削除方法・保持期間の再確認
  - *b3. 制約クリア後、基本フロー4に復帰

### 例外3: アーカイブ失敗
- *c. 必要データのアーカイブに失敗した場合
  - *c1. アーカイブエラーの詳細記録・原因分析
  - *c2. データ復旧・アーカイブ再実行・整合性確認
  - *c3. アーカイブ完了後、基本フロー4に復帰

## 特別要件
- **性能**: 削除処理30秒以内、アーカイブ処理60秒以内、権限無効化即座
- **可用性**: 削除システム稼働率99.9%以上、緊急削除24時間対応
- **セキュリティ**: 削除データ完全消去、アーカイブ暗号化、アクセス監査、操作権限制御
- **コンプライアンス**: GDPR削除権対応、個人情報保護法準拠、法定保持期間遵守
- **可逆性**: 誤削除対策、アーカイブからの復旧機能、削除取り消し機能（時限付き）

## 関連ユースケース
- **包含**: UC-AUTH-02（権限検証）、UC-AUTH-03（ログ記録）、UC-NOTIFY-01（通知配信）
- **前提**: メンバー登録・アクセス権限設定完了必須
- **後続**: データアーカイブ管理、法定保持期間管理、削除監査レポート

---
*このユースケースは パラソル設計v2.0仕様 に基づいて作成されました*
