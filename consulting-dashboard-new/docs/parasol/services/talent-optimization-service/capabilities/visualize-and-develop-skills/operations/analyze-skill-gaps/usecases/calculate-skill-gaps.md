# ユースケース: ギャップを計算する

## 基本情報
- **ユースケースID**: UC-TAL-009-003
- **アクター**: 人事分析担当者、組織開発担当者、システム
- **概要**: 現状スキルと必要スキル要件を比較分析し、定量的なスキルギャップを算出する

## 事前条件
- 現状スキル調査が完了している
- 必要スキル要件が定義・承認されている
- スキル評価基準が統一されている
- ギャップ計算アルゴリズムが設定されている

## 事後条件
### 成功時
- 全スキル項目のギャップが定量化されている
- 個人別・部門別・組織全体のギャップが算出されている
- ギャップデータが可視化されている
- 分析結果レポートが生成されている

### 失敗時
- 計算途中のデータが一時保存されている
- エラー原因が特定・記録されている
- 関係者に問題状況が通知されている

## 基本フロー
1. 人事分析担当者がギャップ計算の実行を要求する
2. システムが現状スキルデータと必要スキル要件を読み込む
3. システムがデータの整合性とフォーマットを検証する
4. システムがスキル項目別のギャップを定量計算する
5. システムが個人別スキルギャップマトリックスを生成する
6. システムが部門別・職種別の集約ギャップを算出する
7. システムがギャップの重要度・緊急度評価を実行する
8. システムが統計的分析（分散・偏差・相関）を実施する
9. 人事分析担当者が計算結果の妥当性を検証する
10. システムがギャップ分析レポートを確定・保存する

## 代替フロー
### 代替フロー1: 段階的計算実行
- 4a. 計算対象が大規模な場合
  - 4a1. システムが計算負荷を評価する
  - 4a2. システムが段階的計算スケジュールを提案する
  - 4a3. 人事分析担当者が計算順序を承認する
  - 4a4. システムが優先度順に段階計算を実行する
  - 4a5. 基本フロー5に戻る

### 代替フロー2: 重み付け計算
- 4a. スキル重要度に応じた重み付けが必要な場合
  - 4a1. システムが事業戦略に基づく重み係数を適用する
  - 4a2. システムが重み付きギャップ値を算出する
  - 4a3. システムが重み付け前後の比較表を生成する
  - 4a4. 基本フロー5に戻る

### 代替フロー3: シナリオ分析
- 7a. 複数シナリオでのギャップ分析が必要な場合
  - 7a1. 人事分析担当者が分析シナリオを設定する
  - 7a2. システムがシナリオ別の必要スキル水準を適用する
  - 7a3. システムがシナリオ別ギャップを並列計算する
  - 7a4. システムがシナリオ比較レポートを生成する
  - 7a5. 基本フロー8に戻る

## 例外フロー
### 例外1: データ不整合
- 3a. 現状スキルと必要スキルのデータ形式が不一致の場合
  - 3a1. システムが不整合箇所を特定・報告する
  - 3a2. 人事分析担当者がデータ修正方針を決定する
  - 3a3. システムが自動修正可能な項目を処理する
  - 3a4. 手動修正が必要な項目を管理者に通知する
  - 3a5. 修正完了後、基本フロー4に戻る

### 例外2: 計算リソース不足
- 4a. システムリソースが不足してギャップ計算が困難な場合
  - 4a1. システムが計算負荷軽減策を提案する
  - 4a2. 人事分析担当者が計算範囲の縮小を決定する
  - 4a3. システムが優先対象のみの計算を実行する
  - 4a4. 完了後に残り対象の計算を順次実行
  - 4a5. 基本フロー5に戻る

### 例外3: 妥当性検証失敗
- 9a. 計算結果が妥当性基準を満たさない場合
  - 9a1. システムが妥当性問題の詳細を分析する
  - 9a2. 人事分析担当者が再計算の必要性を判断する
  - 9a3. 必要に応じて計算パラメータを調整する
  - 9a4. システムが修正パラメータで再計算を実行
  - 9a5. 基本フロー9に戻る

## 特別要件
### 性能要件
- 1000名規模でのギャップ計算は15分以内で完了する
- リアルタイム計算結果表示は3秒以内で更新する
- 複数シナリオ分析は30分以内で完了する

### 精度要件
- ギャップ計算の誤差は±5%以内に抑制する
- 統計分析の信頼区間は95%以上を保証する
- 重み付け計算の透明性を完全に確保する

### 可用性要件
- ギャップ計算サービスの稼働率99.5%以上
- データバックアップは計算前後で自動実行
- 計算失敗時の自動リトライ機能を実装

## 関連ユースケース
### 包含関係
- スキルデータ整合性チェックを実行する
- ギャップ定量計算を実行する
- 統計分析を実行する
- 妥当性検証を実行する

### 拡張関係
- 優先順位を決定する（次の段階）
- 現状スキルを調査する（前提データ）
- 必要スキルを定義する（前提データ）
- シナリオ分析を実行する（高度な分析）

### 汎化関係
- データ分析を実行する（上位概念）

## ビジネスルール
- ギャップは5段階評価（1:なし～5:重大）で分類する
- 20%以上のギャップは「要対応」として分類する
- 重要度と緊急度のマトリックスで優先度を決定する
- 計算結果は最低3名の専門家による検証が必要

## データ要件
### 入力データ
- 個人別現状スキル評価結果
- 必要スキル要件定義
- スキル重要度係数
- 計算パラメータ設定
- 過去のギャップ計算履歴

### 出力データ
- 個人別スキルギャップマトリックス
- 部門別・職種別ギャップサマリー
- ギャップ重要度ランキング
- 統計分析結果（平均・分散・相関）
- ギャップ推移トレンド

## 計算方式
### 基本ギャップ計算
```
ギャップ値 = |必要スキルレベル - 現状スキルレベル|
ギャップ率 = ギャップ値 / 必要スキルレベル × 100
```

### 重み付きギャップ計算
```
重み付きギャップ = ギャップ値 × 事業重要度係数 × 緊急度係数
```

### 集約ギャップ計算
```
部門ギャップ = Σ(個人ギャップ × 人員比重) / 部門総人数
組織ギャップ = Σ(部門ギャップ × 部門比重) / 総部門数
```

## 成功指標
- 計算完了率：100%
- 計算精度：誤差±5%以内
- 妥当性検証通過率：95%以上
- 計算所要時間：計画時間内完了
- 分析結果活用率：80%以上

## 技術的考慮事項
### アルゴリズム最適化
- 大規模データ処理のための並列計算
- メモリ効率的なデータ構造の採用
- キャッシュ機能による計算高速化

### 拡張性設計
- 新しい計算方式の追加対応
- 外部データソースとの連携
- API経由での計算結果提供